var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function c(t,e,n=e){return t.set(n),e}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function p(){return m(" ")}function h(){return m("")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function $(t){return function(e){return e.preventDefault(),t.call(this,e)}}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function x(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function k(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}}function C(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function _(t,e,n){t.classList[n?"add":"remove"](e)}let I;function O(t){I=t}function D(t){(function(){if(!I)throw new Error("Function called outside component initialization");return I})().$$.on_destroy.push(t)}function S(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t(e)))}const U=[],E=[],M=[],L=[],N=Promise.resolve();let j=!1;function T(t){M.push(t)}function R(t){L.push(t)}let P=!1;const q=new Set;function z(){if(!P){P=!0;do{for(let t=0;t<U.length;t+=1){const e=U[t];O(e),A(e.$$)}for(O(null),U.length=0;E.length;)E.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];q.has(e)||(q.add(e),e())}M.length=0}while(U.length);for(;L.length;)L.pop()();j=!1,P=!1,q.clear()}}function A(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const F=new Set;let H;function J(){H={r:0,c:[],p:H}}function B(){H.r||s(H.c),H=H.p}function G(t,e){t&&t.i&&(F.delete(t),t.i(e))}function W(t,e,n,s){if(t&&t.o){if(F.has(t))return;F.add(t),H.c.push((()=>{F.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function Y(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function K(t){t&&t.c()}function V(t,n,r){const{fragment:l,on_mount:c,on_destroy:u,after_update:a}=t.$$;l&&l.m(n,r),T((()=>{const n=c.map(e).filter(o);u?u.push(...n):s(n),t.$$.on_mount=[]})),a.forEach(T)}function Z(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e){-1===t.$$.dirty[0]&&(U.push(t),j||(j=!0,N.then(z)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,o,r,l,c,u,a=[-1]){const d=I;O(e);const f=o.props||{},m=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let p=!1;if(m.ctx=r?r(e,f,((t,n,...s)=>{const o=s.length?s[0]:n;return m.ctx&&c(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),p&&Q(e,t)),n})):[],m.update(),p=!0,s(m.before_update),m.fragment=!!l&&l(m.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);m.fragment&&m.fragment.l(t),t.forEach(i)}else m.fragment&&m.fragment.c();o.intro&&G(e.$$.fragment),V(e,o.target,o.anchor),z()}O(d)}class tt{$destroy(){Z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let s;const o=[];function l(t){if(r(e,t)&&(e=t,s)){const t=!et.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),et.push(n,e)}if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(r,c=t){const u=[r,c];return o.push(u),1===o.length&&(s=n(l)||t),r(e),()=>{const t=o.indexOf(u);-1!==t&&o.splice(t,1),0===o.length&&(s(),s=null)}}}}function st(t,e){const n=localStorage.getItem(t);let s=e||null;n&&(s=JSON.parse(n));const o=nt(s);return o.subscribe((e=>localStorage.setItem(t,JSON.stringify(e)))),o}const ot=st("config"),rt=st("homework"),lt=st("student"),ct=st("checkpoints",[]),ut=nt([]),at=nt({}),it=nt(""),dt=nt(!1);let ft=[];function mt(){const t=JSON.parse(localStorage.getItem("config")).students.map((t=>t.username)).filter((t=>!ft.includes(t)));if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];lt.set({username:e,commentIds:[]})}else lt.set(null)}function pt(e){let n,o,r,l,c,d,h,$,b,y,x,C,_,I,O,D,S,U,E,M,L,N,j,R,P;return{c(){n=f("label"),o=f("span"),o.textContent="Homework number",r=p(),l=f("input"),c=p(),d=f("label"),h=f("span"),h.textContent="Due date (EOD)",$=p(),b=f("input"),y=p(),x=f("div"),C=m("https://"),_=f("select"),I=f("option"),I.textContent="fall",O=f("option"),O.textContent="spring",D=m("-"),S=f("input"),U=m(".cs.utexas.edu/"),E=f("input"),M=p(),L=f("button"),N=m("Start grading"),v(l,"type","text"),v(l,"placeholder","1"),v(l,"class","short svelte-1re6vz0"),v(b,"type","date"),v(b,"class","date"),I.__value="fall",I.value=I.__value,O.__value="spring",O.value=O.__value,void 0===e[0]&&T((()=>e[8].call(_))),v(S,"type","text"),v(S,"class","short svelte-1re6vz0"),v(E,"type","text"),E.readOnly=!0,v(x,"class","prefix svelte-1re6vz0"),L.disabled=j=!e[3]||!e[4]||!e[2]},m(t,s){a(t,n,s),u(n,o),u(n,r),u(n,l),w(l,e[3]),a(t,c,s),a(t,d,s),u(d,h),u(d,$),u(d,b),w(b,e[4]),a(t,y,s),a(t,x,s),u(x,C),u(x,_),u(_,I),u(_,O),k(_,e[0]),u(x,D),u(x,S),w(S,e[1]),u(x,U),u(x,E),w(E,e[2]),a(t,M,s),a(t,L,s),u(L,N),R||(P=[g(l,"input",e[6]),g(b,"input",e[7]),g(_,"change",e[8]),g(S,"input",e[9]),g(E,"input",e[10]),g(L,"click",e[5])],R=!0)},p(t,[e]){8&e&&l.value!==t[3]&&w(l,t[3]),16&e&&w(b,t[4]),1&e&&k(_,t[0]),2&e&&S.value!==t[1]&&w(S,t[1]),4&e&&E.value!==t[2]&&w(E,t[2]),28&e&&j!==(j=!t[3]||!t[4]||!t[2])&&(L.disabled=j)},i:t,o:t,d(t){t&&i(n),t&&i(c),t&&i(d),t&&i(y),t&&i(x),t&&i(M),t&&i(L),R=!1,s(P)}}}function ht(t,e,n){let s,o,r,u;l(t,rt,(t=>n(12,o=t))),l(t,ut,(t=>n(13,r=t))),l(t,at,(t=>n(14,u=t)));let a="",i="";const d=new Date;let f=d.getMonth()<6?"spring":"fall",m=d.getFullYear(),p="cs329e-bulko";return t.$$.update=()=>{7&t.$$.dirty&&(s=`https://${f}-${m}.cs.utexas.edu/${p}`)},[f,m,p,a,i,function(){c(rt,o={number:parseInt(a),dueDate:i,students:[],possibleComments:[{text:"One day late",points:10},{text:"Two days late",points:20},{text:"No submission",points:100}],prefix:s},o),c(ut,r=[],r),c(at,u={},u),mt()},function(){a=this.value,n(3,a)},function(){i=this.value,n(4,i)},function(){f=C(this),n(0,f)},function(){m=this.value,n(1,m)},function(){p=this.value,n(2,p)}]}rt.subscribe((t=>ft=t&&t.students.map((t=>t.username))));class gt extends tt{constructor(t){super(),X(this,t,ht,pt,r,{})}}var $t=["second","minute","hour","day","week","month","year"];var vt=["秒","分钟","小时","天","周","个月","年"];var bt={},yt=function(t,e){bt[t]=e},wt=[60,60,24,7,365/7/12,12];function xt(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}var kt=function(t,e,n){return function(t,e){for(var n=t<0?1:0,s=t=Math.abs(t),o=0;t>=wt[o]&&o<wt.length;o++)t/=wt[o];return(t=Math.floor(t))>(0==(o*=2)?9:1)&&(o+=1),e(t,o,s)[n].replace("%s",t.toString())}(function(t,e){return(+(e?xt(e):new Date)-+xt(t))/1e3}(t,n&&n.relativeDate),function(t){return bt[t]||bt.en_US}(e))};function Ct(t){return kt(new Date(t))}function _t(t,e){let n=100;for(const s of t)n-=e[s].points;return n}yt("en_US",(function(t,e){if(0===e)return["just now","right now"];var n=$t[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]})),yt("zh_CN",(function(t,e){if(0===e)return["刚刚","片刻后"];var n=vt[~~(e/2)];return[t+" "+n+"前",t+" "+n+"后"]}));const It=document.getElementById("comms");function Ot(t){It.dataset.tellExtension=JSON.stringify(t)}function Dt(t){return t.split("/")[5]}function St(t){const[e,n]=t.split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase())).join(" ").split(";").map((t=>t.trim()));return{first:n,last:e}}function Ut(t){t.target.select()}function Et(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function Mt(t){let e,n,s,o,r,l=t[9].label+"",c=Ct(t[9].lastChange)+"";return{c(){e=f("option"),n=m(l),s=m(", saved "),o=m(c),r=p(),e.__value=t[11],e.value=e.__value},m(t,l){a(t,e,l),u(e,n),u(e,s),u(e,o),u(e,r)},p(t,e){2&e&&l!==(l=t[9].label+"")&&y(n,l),2&e&&c!==(c=Ct(t[9].lastChange)+"")&&y(o,c)},d(t){t&&i(e)}}}function Lt(e){let n,o,r,l,c,u=e[1],m=[];for(let t=0;t<u.length;t+=1)m[t]=Mt(Et(e,u,t));return{c(){n=f("select");for(let t=0;t<m.length;t+=1)m[t].c();o=p(),r=f("button"),r.textContent="Restore from save",void 0===e[0]&&T((()=>e[4].call(n)))},m(t,s){a(t,n,s);for(let t=0;t<m.length;t+=1)m[t].m(n,null);k(n,e[0]),a(t,o,s),a(t,r,s),l||(c=[g(n,"change",e[4]),g(r,"click",e[2])],l=!0)},p(t,[e]){if(2&e){let s;for(u=t[1],s=0;s<u.length;s+=1){const o=Et(t,u,s);m[s]?m[s].p(o,e):(m[s]=Mt(o),m[s].c(),m[s].m(n,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=u.length}1&e&&k(n,t[0])},i:t,o:t,d(t){t&&i(n),d(m,t),t&&i(o),t&&i(r),l=!1,s(c)}}}function Nt(t,e,n){let s,o,r,u,a,i;l(t,ct,(t=>n(3,o=t))),l(t,ut,(t=>n(5,r=t))),l(t,at,(t=>n(6,u=t))),l(t,rt,(t=>n(7,a=t))),l(t,lt,(t=>n(8,i=t)));let d=0;return t.$$.update=()=>{8&t.$$.dirty&&n(1,s=(null==o?void 0:o.sort(((t,e)=>e.lastChange-t.lastChange)))||[])},[d,s,function(){c(ut,r=[],r),c(at,u={},u);const t=o[d];c(rt,a=t.homework,a),c(lt,i=t.currentStudent,i),o.splice(d,1),ct.set(o)},o,function(){d=C(this),n(0,d)}]}class jt extends tt{constructor(t){super(),X(this,t,Nt,Lt,r,{})}}const Tt=document.location.href,Rt=`cd ~/public_html && wget -O gradable.php "${Tt}server/gradable.php" && chmod +x gradable.php`;function Pt(t,e,n,s){var o;const r=null===(o=s.students.find((t=>t.username===e)))||void 0===o?void 0:o.password;if(!r)throw new Error("Unknown student");if("UNKNOWN"===r)throw new Error("Unknown password");const l=new URLSearchParams;return l.append("token",s.token),l.append("lock",t?"yes":"no"),l.append("url",n),l.append("user",e),l.append("pass",r),fetch(s.endpoint,{method:"post",body:l}).then((t=>t.json()))}function qt(t,e,n){const s=t.slice();return s[5]=e[n],s}function zt(t){let e,n,s,o,r,l,c,h,$,b,y,w,x,k,C,_,I,O=t[0],D=[];for(let e=0;e<O.length;e+=1)D[e]=At(qt(t,O,e));return{c(){e=f("table"),n=f("thead"),s=f("tr"),o=f("td"),o.textContent="last",r=p(),l=f("td"),l.textContent="first",c=p(),h=f("td"),h.textContent="username",$=p(),b=f("td"),y=f("label"),w=m("password\n\t\t\t\t\t\t\t"),x=f("input"),k=p(),C=f("tbody");for(let t=0;t<D.length;t+=1)D[t].c();v(x,"type","checkbox"),v(e,"class","svelte-5fmq9n")},m(i,d){a(i,e,d),u(e,n),u(n,s),u(s,o),u(s,r),u(s,l),u(s,c),u(s,h),u(s,$),u(s,b),u(b,y),u(y,w),u(y,x),x.checked=t[1],u(e,k),u(e,C);for(let t=0;t<D.length;t+=1)D[t].m(C,null);_||(I=g(x,"change",t[4]),_=!0)},p(t,e){if(2&e&&(x.checked=t[1]),3&e){let n;for(O=t[0],n=0;n<O.length;n+=1){const s=qt(t,O,n);D[n]?D[n].p(s,e):(D[n]=At(s),D[n].c(),D[n].m(C,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=O.length}},d(t){t&&i(e),d(D,t),_=!1,I()}}}function At(t){let e,n,s,o,r,l,c,d,h,g,$,v,b,w=St(t[5].realname).last+"",x=St(t[5].realname).first+"",k=t[5].username+"",C=(t[1]?t[5].password:"••••••••")+"";return{c(){e=f("tr"),n=f("td"),s=m(w),o=p(),r=f("td"),l=m(x),c=p(),d=f("td"),h=m(k),g=p(),$=f("td"),v=m(C),b=p()},m(t,i){a(t,e,i),u(e,n),u(n,s),u(e,o),u(e,r),u(r,l),u(e,c),u(e,d),u(d,h),u(e,g),u(e,$),u($,v),u(e,b)},p(t,e){1&e&&w!==(w=St(t[5].realname).last+"")&&y(s,w),1&e&&x!==(x=St(t[5].realname).first+"")&&y(l,x),1&e&&k!==(k=t[5].username+"")&&y(h,k),3&e&&C!==(C=(t[1]?t[5].password:"••••••••")+"")&&y(v,C)},d(t){t&&i(e)}}}function Ft(e){let n,s,o,r,l,c,d,h,$,b,x,k,C=e[0].length+"",_=1===e[0].length?"student":"students",I=e[0].length>0&&zt(e);return{c(){n=f("label"),s=f("h2"),o=m(C),r=p(),l=m(_),c=p(),d=f("p"),d.textContent="Each row should have the username and password separated by a tab.",h=p(),$=f("textarea"),b=p(),I&&I.c(),v($,"rows","1"),v($,"class","svelte-5fmq9n")},m(t,i){a(t,n,i),u(n,s),u(s,o),u(s,r),u(s,l),u(n,c),u(n,d),u(n,h),u(n,$),w($,e[2]),u(n,b),I&&I.m(n,null),x||(k=g($,"input",e[3]),x=!0)},p(t,[e]){1&e&&C!==(C=t[0].length+"")&&y(o,C),1&e&&_!==(_=1===t[0].length?"student":"students")&&y(l,_),4&e&&w($,t[2]),t[0].length>0?I?I.p(t,e):(I=zt(t),I.c(),I.m(n,null)):I&&(I.d(1),I=null)},i:t,o:t,d(t){t&&i(n),I&&I.d(),x=!1,k()}}}function Ht(t,e,n){let{students:s=[]}=e,{showPasswords:o=!1}=e,r=function(t){return t.map((t=>`${t.realname}\t${t.username}\t${t.password}`)).join("\n")}(s);return t.$$set=t=>{"students"in t&&n(0,s=t.students),"showPasswords"in t&&n(1,o=t.showPasswords)},t.$$.update=()=>{4&t.$$.dirty&&n(0,s=r.split("\n").filter((t=>!!t)).map((t=>t.split("\t"))).map((([t,e,n])=>({realname:t,username:e,password:n,canvasId:""}))))},[s,o,r,function(){r=this.value,n(2,r)},function(){o=this.checked,n(1,o)}]}class Jt extends tt{constructor(t){super(),X(this,t,Ht,Ft,r,{students:0,showPasswords:1})}}function Bt(t){let e,n,s,o;return s=new jt({}),{c(){e=f("h1"),e.textContent="Load previous session",n=p(),K(s.$$.fragment),v(e,"class","svelte-tylxsl")},m(t,r){a(t,e,r),a(t,n,r),V(s,t,r),o=!0},i(t){o||(G(s.$$.fragment,t),o=!0)},o(t){W(s.$$.fragment,t),o=!1},d(t){t&&i(e),t&&i(n),Z(s,t)}}}function Gt(t){let e,n,o,r,l,c,u,d,h,$,b,w,x,k,C,_,I,O,D,S,U,M,L=t[0].endpoint+"";o=new gt({});let N=null!==t[1]&&t[1].length>0&&Bt();function j(e){t[4].call(null,e)}let T={};return void 0!==t[0].students&&(T.students=t[0].students),w=new Jt({props:T}),E.push((()=>Y(w,"students",j))),{c(){e=f("h1"),e.textContent="Grade new homework",n=p(),K(o.$$.fragment),r=p(),N&&N.c(),l=p(),c=f("h1"),c.textContent="Configuration",u=p(),d=f("h2"),d.textContent="UT CS server endpoint",h=p(),$=m(L),b=p(),K(w.$$.fragment),k=p(),C=f("h2"),C.textContent="Reset",_=p(),I=f("button"),I.textContent="Delete local config and set up again",O=p(),D=f("button"),D.textContent="Reset server configuration",v(e,"class","svelte-tylxsl"),v(c,"class","svelte-tylxsl")},m(s,i){a(s,e,i),a(s,n,i),V(o,s,i),a(s,r,i),N&&N.m(s,i),a(s,l,i),a(s,c,i),a(s,u,i),a(s,d,i),a(s,h,i),a(s,$,i),a(s,b,i),V(w,s,i),a(s,k,i),a(s,C,i),a(s,_,i),a(s,I,i),a(s,O,i),a(s,D,i),S=!0,U||(M=[g(I,"click",t[3]),g(D,"click",t[2])],U=!0)},p(t,[e]){null!==t[1]&&t[1].length>0?N?2&e&&G(N,1):(N=Bt(),N.c(),G(N,1),N.m(l.parentNode,l)):N&&(J(),W(N,1,1,(()=>{N=null})),B()),(!S||1&e)&&L!==(L=t[0].endpoint+"")&&y($,L);const n={};!x&&1&e&&(x=!0,n.students=t[0].students,R((()=>x=!1))),w.$set(n)},i(t){S||(G(o.$$.fragment,t),G(N),G(w.$$.fragment,t),S=!0)},o(t){W(o.$$.fragment,t),W(N),W(w.$$.fragment,t),S=!1},d(t){t&&i(e),t&&i(n),Z(o,t),t&&i(r),N&&N.d(t),t&&i(l),t&&i(c),t&&i(u),t&&i(d),t&&i(h),t&&i($),t&&i(b),Z(w,t),t&&i(k),t&&i(C),t&&i(_),t&&i(I),t&&i(O),t&&i(D),U=!1,s(M)}}}function Wt(t,e,n){let s,o;return l(t,ot,(t=>n(0,s=t))),l(t,ct,(t=>n(1,o=t))),[s,o,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("remove","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(s).then((({success:t})=>{t?alert("Server reset, you still need to delete gradable.php"):alert("Failed, could not reset")}))},function(){confirm("You are about to DELETE EVERYTHING, including your authentication token and "+o.length+" checkpoints. Make sure to delete the server config if you do not have a backup of the token. Are you sure you want to continue?")&&(localStorage.clear(),window.location=window.location)},function(t){s.students=t,ot.set(s)}]}class Yt extends tt{constructor(t){super(),X(this,t,Wt,Gt,r,{})}}function Kt(t){let e,n,o,r,l,c,d,h,$,b,y,x,k,C,_,I,O,D,S,U,M,L,N,j,T,P,q,z,A,F,H,J,B;function Q(e){t[8].call(null,e)}let X={showPasswords:!0};return void 0!==t[2]&&(X.students=t[2]),T=new Jt({props:X}),E.push((()=>Y(T,"students",Q))),{c(){e=f("h1"),e.textContent="Setup",n=p(),o=f("ol"),r=f("li"),l=m("Enter your UT CS username:\n\t\t"),c=f("input"),d=p(),h=f("li"),$=m("Log in to your UT CS account and download the phpseclib library:\n\t\t"),b=f("input"),y=p(),x=f("li"),k=m("Then install the server integration script:\n\t\t"),C=f("input"),_=p(),I=f("li"),O=m("Go to "),D=f("a"),S=m("this link"),U=m(", copy the token,\n\t\tand paste it here:\n\t\t"),M=f("input"),L=p(),N=f("li"),N.textContent="Paste your list of students separated by linebreaks below.",j=p(),K(T.$$.fragment),q=p(),z=f("button"),A=m("Save and continue"),v(c,"type","text"),b.readOnly=!0,v(b,"type","text"),b.value=t[5],C.readOnly=!0,v(C,"type","text"),C.value=Rt,v(D,"href",t[3]),v(D,"target","_blank"),v(M,"type","text"),z.disabled=F=!t[1]||!t[0]||!t[2]},m(s,i){a(s,e,i),a(s,n,i),a(s,o,i),u(o,r),u(r,l),u(r,c),w(c,t[1]),u(o,d),u(o,h),u(h,$),u(h,b),u(o,y),u(o,x),u(x,k),u(x,C),u(o,_),u(o,I),u(I,O),u(I,D),u(D,S),u(I,U),u(I,M),w(M,t[0]),u(o,L),u(o,N),a(s,j,i),V(T,s,i),a(s,q,i),a(s,z,i),u(z,A),H=!0,J||(B=[g(c,"input",t[6]),g(b,"click",Ut),g(b,"focus",Ut),g(C,"click",Ut),g(C,"focus",Ut),g(M,"input",t[7]),g(z,"click",t[4])],J=!0)},p(t,[e]){2&e&&c.value!==t[1]&&w(c,t[1]),(!H||8&e)&&v(D,"href",t[3]),1&e&&M.value!==t[0]&&w(M,t[0]);const n={};!P&&4&e&&(P=!0,n.students=t[2],R((()=>P=!1))),T.$set(n),(!H||7&e&&F!==(F=!t[1]||!t[0]||!t[2]))&&(z.disabled=F)},i(t){H||(G(T.$$.fragment,t),H=!0)},o(t){W(T.$$.fragment,t),H=!1},d(t){t&&i(e),t&&i(n),t&&i(o),t&&i(j),Z(T,t),t&&i(q),t&&i(z),J=!1,s(B)}}}function Vt(t,e,n){let s,o,r;l(t,ot,(t=>n(10,r=t)));let u="",a="",i=[];const d="wget https://github.com/phpseclib/phpseclib/archive/2.0.30.zip\nunzip 2.0.30.zip\nmv phpseclib-2.0.30/phpseclib phpseclib\nrm -rf phpseclib-2.0.30\nrm 2.0.30.zip".split("\n").join(" && ");return t.$$.update=()=>{2&t.$$.dirty&&n(3,s=`https://www.cs.utexas.edu/~${a}/gradable.php`),13&t.$$.dirty&&(o={token:u,endpoint:s,students:i})},[u,a,i,s,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("ping","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(o).then((t=>{t.success?c(ot,r=o,r):alert("Invalid token")})).catch((()=>{alert("Could not connect to server")}))},d,function(){a=this.value,n(1,a)},function(){u=this.value,n(0,u)},function(t){i=t,n(2,i)}]}class Zt extends tt{constructor(t){super(),X(this,t,Vt,Kt,r,{})}}function Qt(t,e,n){const s=t.slice();return s[10]=e[n],s[12]=n,s}function Xt(e){let n;return{c(){n=f("i"),n.textContent="none"},m(t,e){a(t,n,e)},p:t,d(t){t&&i(n)}}}function te(t){let e,n,o,r;return{c(){e=f("textarea"),e.readOnly=!0,e.value=n=t[4](t[10].commentIds,"\n"),v(e,"class","svelte-gmr12x")},m(t,n){a(t,e,n),o||(r=[g(e,"click",Ut),g(e,"focus",Ut)],o=!0)},p(t,s){2&s&&n!==(n=t[4](t[10].commentIds,"\n"))&&(e.value=n)},d(t){t&&i(e),o=!1,s(r)}}}function ee(t){let e,n,o,r,l,c,d,h,$,b,w,x,k,C,_,I,O,D,S=St(t[10].realname).last+"",U=St(t[10].realname).first+"";function E(t,e){return t[10].commentIds.length>0?te:Xt}let M=E(t),L=M(t);function N(){return t[6](t[12])}return{c(){e=f("tr"),n=f("td"),o=m(S),r=m(",\n\t\t\t\t\t"),l=m(U),c=p(),d=f("td"),h=f("input"),b=m("%"),w=p(),x=f("td"),L.c(),k=p(),C=f("td"),_=f("button"),_.textContent="regrade",I=p(),h.readOnly=!0,v(h,"class","percentage svelte-gmr12x"),v(h,"type","text"),h.value=$=_t(t[10].commentIds,t[0].possibleComments)},m(t,s){a(t,e,s),u(e,n),u(n,o),u(n,r),u(n,l),u(e,c),u(e,d),u(d,h),u(d,b),u(e,w),u(e,x),L.m(x,null),u(e,k),u(e,C),u(C,_),u(e,I),O||(D=[g(h,"click",Ut),g(h,"focus",Ut),g(_,"click",N)],O=!0)},p(e,n){t=e,2&n&&S!==(S=St(t[10].realname).last+"")&&y(o,S),2&n&&U!==(U=St(t[10].realname).first+"")&&y(l,U),3&n&&$!==($=_t(t[10].commentIds,t[0].possibleComments))&&h.value!==$&&(h.value=$),M===(M=E(t))&&L?L.p(t,n):(L.d(1),L=M(t),L&&(L.c(),L.m(x,null)))},d(t){t&&i(e),L.d(),O=!1,s(D)}}}function ne(e){let n,s,o,r,l,c,m,h,$=e[1],b=[];for(let t=0;t<$.length;t+=1)b[t]=ee(Qt(e,$,t));return{c(){n=f("table"),s=f("thead"),s.innerHTML='<tr><td>name</td> \n\t\t\t<td>grade</td> \n\t\t\t<td width="99%">comments</td> \n\t\t\t<td>actions</td></tr>',o=p(),r=f("tbody");for(let t=0;t<b.length;t+=1)b[t].c();l=p(),c=f("button"),c.textContent="Export and continue",v(n,"class","svelte-gmr12x")},m(t,i){a(t,n,i),u(n,s),u(n,o),u(n,r);for(let t=0;t<b.length;t+=1)b[t].m(r,null);a(t,l,i),a(t,c,i),m||(h=g(c,"click",e[2]),m=!0)},p(t,[e]){if(27&e){let n;for($=t[1],n=0;n<$.length;n+=1){const s=Qt(t,$,n);b[n]?b[n].p(s,e):(b[n]=ee(s),b[n].c(),b[n].m(r,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}},i:t,o:t,d(t){t&&i(n),d(b,t),t&&i(l),t&&i(c),m=!1,h()}}}function se(t,e,n){let s,o,r,u,a;function i(t){c(lt,a=o.students[t],a),o.students.splice(t,1),rt.set(o)}function d(t,e){return t.map((t=>o.possibleComments[t])).map((({points:t,text:e})=>`-${t}: ${e}`)).join(e)}l(t,rt,(t=>n(0,o=t))),l(t,ot,(t=>n(5,r=t))),l(t,ct,(t=>n(7,u=t))),l(t,lt,(t=>n(8,a=t)));return t.$$.update=()=>{33&t.$$.dirty&&n(1,s=o?r.students.map((t=>Object.assign({realname:t.realname},(null==o?void 0:o.students.find((e=>e.username===t.username)))||{}))):[])},[o,s,function(){c(ct,u=[...u,{label:"HW "+o.number,lastChange:(new Date).getTime(),homework:o,currentStudent:null}],u);let t="name\tscore\tcomments\n";s.forEach((e=>{t+=e.username,t+="\t",t+=_t(e.commentIds,null==o?void 0:o.possibleComments),t+="\t",t+=d(e.commentIds,"; "),t+="\n"}));const e=document.createElement("a");e.setAttribute("href","data:text/tab-separated-values;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",`HW${o.number}export-${(new Date).getTime()/1e3|0}.csv`),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),c(rt,o=null,o)},i,d,r,t=>{i(t)}]}class oe extends tt{constructor(t){super(),X(this,t,se,ne,r,{})}}function re(e){let n,o,r,l,c,d,h,$,b,w,x,k,C,_,I,O,D,S,U,E;return{c(){n=f("div"),o=f("div"),r=f("a"),l=m(e[3]),c=f("span"),c.textContent="ignore",d=p(),h=f("button"),$=m("Unlock"),b=p(),w=f("button"),x=m("Lock"),k=p(),C=f("button"),C.textContent="Clear cookies",_=p(),I=f("button"),I.textContent="Refresh",O=p(),D=f("iframe"),v(c,"class","svelte-1ks2w4f"),v(r,"href",e[3]),v(r,"class","location svelte-1ks2w4f"),v(r,"target","_blank"),h.disabled=e[2],v(h,"class","svelte-1ks2w4f"),w.disabled=e[2],v(w,"class","svelte-1ks2w4f"),v(C,"class","svelte-1ks2w4f"),v(I,"class","svelte-1ks2w4f"),v(o,"class","top svelte-1ks2w4f"),D.src!==(S=e[1])&&v(D,"src",S),v(D,"frameborder","0"),v(D,"title","Embedded website to grade"),v(D,"class","svelte-1ks2w4f"),v(n,"class","browser svelte-1ks2w4f")},m(t,s){a(t,n,s),u(n,o),u(o,r),u(r,l),u(r,c),u(o,d),u(o,h),u(h,$),u(o,b),u(o,w),u(w,x),u(o,k),u(o,C),u(o,_),u(o,I),u(n,O),u(n,D),e[8](D),U||(E=[g(h,"click",e[6]),g(w,"click",e[7]),g(C,"click",e[5]),g(I,"click",e[4])],U=!0)},p(t,[e]){8&e&&y(l,t[3]),8&e&&v(r,"href",t[3]),4&e&&(h.disabled=t[2]),4&e&&(w.disabled=t[2]),2&e&&D.src!==(S=t[1])&&v(D,"src",S)},i:t,o:t,d(t){t&&i(n),e[8](null),U=!1,s(E)}}}function le(t,e,n){let s,o,r;l(t,it,(t=>n(3,s=t))),l(t,lt,(t=>n(9,o=t))),l(t,ot,(t=>n(10,r=t)));let{embeddedUrl:c="about:blank"}=e,{iframeRef:u}=e,a=!1;function i(t){t.success?(Ot({type:"refresh-page"}),n(2,a=!1)):d("Failed. "+t.result)}function d(t){alert(t),n(2,a=!1)}return t.$$set=t=>{"embeddedUrl"in t&&n(1,c=t.embeddedUrl),"iframeRef"in t&&n(0,u=t.iframeRef)},[u,c,a,s,function(){Ot({type:"refresh-page"})},function(){Ot({type:"clear-cookies",value:s})},function(){n(2,a=!0),function(t,e,n){return Pt(!1,e,t,n)}(s,o.username,r).then(i).catch(d)},function(){n(2,a=!0),function(t,e,n){return Pt(!0,e,t,n)}(s,o.username,r).then(i).catch(d)},function(t){E[t?"unshift":"push"]((()=>{u=t,n(0,u)}))}]}class ce extends tt{constructor(t){super(),X(this,t,le,re,r,{embeddedUrl:1,iframeRef:0})}}function ue(e){let n,o,r,l,c,d;return{c(){n=f("div"),o=f("div"),o.textContent="-",r=p(),l=f("input"),v(o,"class","minus svelte-mu2102"),v(l,"type","number"),v(l,"class","points svelte-mu2102"),v(l,"placeholder","5"),v(n,"class","join svelte-mu2102")},m(t,s){a(t,n,s),u(n,o),u(n,r),u(n,l),w(l,e[0]),c||(d=[g(l,"input",e[4]),g(l,"keyup",$(e[1])),g(l,"blur",e[2]),g(l,"change",e[3])],c=!0)},p(t,[e]){1&e&&b(l.value)!==t[0]&&w(l,t[0])},i:t,o:t,d(t){t&&i(n),c=!1,s(d)}}}function ae(t,e,n){let{value:s}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value)},[s,function(e){S(t,e)},function(e){S(t,e)},function(e){S(t,e)},function(){s=b(this.value),n(0,s)}]}class ie extends tt{constructor(t){super(),X(this,t,ae,ue,r,{value:0})}}function de(t){let e,n,o,r,l,c,d,m,h,$,b,y,x;function k(e){t[7].call(null,e)}let C={};return void 0!==t[0].points&&(C.value=t[0].points),c=new ie({props:C}),E.push((()=>Y(c,"value",k))),c.$on("change",t[4]),{c(){e=f("tr"),n=f("td"),o=f("input"),r=p(),l=f("td"),K(c.$$.fragment),m=p(),h=f("td"),$=f("input"),v(o,"type","text"),v(o,"placeholder","Missing name"),v(o,"class","svelte-1te1hhk"),v(n,"class","comment svelte-1te1hhk"),v($,"type","checkbox"),$.checked=t[2],v($,"class","svelte-1te1hhk"),v(h,"class","toggle svelte-1te1hhk"),v(e,"class","svelte-1te1hhk"),_(e,"inactive",!t[2])},m(s,i){a(s,e,i),u(e,n),u(n,o),w(o,t[0].text),u(e,r),u(e,l),V(c,l,null),u(e,m),u(e,h),u(h,$),b=!0,y||(x=[g(o,"input",t[6]),g(o,"change",t[4]),g($,"change",t[8]),g(h,"click",t[9])],y=!0)},p(t,[n]){1&n&&o.value!==t[0].text&&w(o,t[0].text);const s={};!d&&1&n&&(d=!0,s.value=t[0].points,R((()=>d=!1))),c.$set(s),(!b||4&n)&&($.checked=t[2]),4&n&&_(e,"inactive",!t[2])},i(t){b||(G(c.$$.fragment,t),b=!0)},o(t){W(c.$$.fragment,t),b=!1},d(t){t&&i(e),Z(c),y=!1,s(x)}}}function fe(t,e,n){let s,o,r;l(t,lt,(t=>n(5,o=t))),l(t,rt,(t=>n(10,r=t)));let{comment:u}=e,{commentId:a}=e;function i(t,e){t?o.commentIds.includes(e)||c(lt,o.commentIds=[...o.commentIds,e],o):c(lt,o.commentIds=o.commentIds.filter((t=>t!==e)),o)}return t.$$set=t=>{"comment"in t&&n(0,u=t.comment),"commentId"in t&&n(1,a=t.commentId)},t.$$.update=()=>{34&t.$$.dirty&&n(2,s=o.commentIds.includes(a))},[u,a,s,i,function(){c(rt,r.possibleComments[a]=u,r)},o,function(){u.text=this.value,n(0,u)},function(t){u.points=t,n(0,u)},t=>i(t.target.checked,a),()=>i(!s,a)]}class me extends tt{constructor(t){super(),X(this,t,fe,de,r,{comment:0,commentId:1})}}function pe(t,e,n){const s=t.slice();return s[8]=e[n],s[10]=n,s}function he(t){let e,n;return e=new me({props:{comment:t[8],commentId:t[10]}}),{c(){K(e.$$.fragment)},m(t,s){V(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.comment=t[8]),e.$set(s)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function ge(t){let e,n,o,r,l,c,m,h,b,y,x,k,C,_,I,O,D=t[2].possibleComments,S=[];for(let e=0;e<D.length;e+=1)S[e]=he(pe(t,D,e));const U=t=>W(S[t],1,1,(()=>{S[t]=null}));function M(e){t[6].call(null,e)}let L={};return void 0!==t[0]&&(L.value=t[0]),h=new ie({props:L}),E.push((()=>Y(h,"value",M))),h.$on("keyup",t[3]),h.$on("blur",t[4]),{c(){e=f("table");for(let t=0;t<S.length;t+=1)S[t].c();n=p(),o=f("tr"),r=f("td"),l=f("input"),c=p(),m=f("td"),K(h.$$.fragment),y=p(),x=f("td"),k=p(),C=f("small"),C.textContent="Use the checkboxes to the right to mark off points. To add a new penalty,\n\tenter a comment and the number of points to remove. Changing text or points\n\twill update for all students.",v(l,"type","text"),v(l,"placeholder","Missing name"),v(l,"class","svelte-1at0h8t"),v(r,"class","comment svelte-1at0h8t"),v(e,"class","svelte-1at0h8t"),v(C,"class","svelte-1at0h8t")},m(s,i){a(s,e,i);for(let t=0;t<S.length;t+=1)S[t].m(e,null);u(e,n),u(e,o),u(o,r),u(r,l),w(l,t[1]),u(o,c),u(o,m),V(h,m,null),u(o,y),u(o,x),a(s,k,i),a(s,C,i),_=!0,I||(O=[g(l,"input",t[5]),g(l,"keyup",$(t[3])),g(l,"blur",t[4])],I=!0)},p(t,[s]){if(4&s){let o;for(D=t[2].possibleComments,o=0;o<D.length;o+=1){const r=pe(t,D,o);S[o]?(S[o].p(r,s),G(S[o],1)):(S[o]=he(r),S[o].c(),G(S[o],1),S[o].m(e,n))}for(J(),o=D.length;o<S.length;o+=1)U(o);B()}2&s&&l.value!==t[1]&&w(l,t[1]);const o={};!b&&1&s&&(b=!0,o.value=t[0],R((()=>b=!1))),h.$set(o)},i(t){if(!_){for(let t=0;t<D.length;t+=1)G(S[t]);G(h.$$.fragment,t),_=!0}},o(t){S=S.filter(Boolean);for(let t=0;t<S.length;t+=1)W(S[t]);W(h.$$.fragment,t),_=!1},d(t){t&&i(e),d(S,t),Z(h),t&&i(k),t&&i(C),I=!1,s(O)}}}function $e(t,e,n){let s,o;l(t,rt,(t=>n(2,s=t))),l(t,lt,(t=>n(7,o=t)));let r="",u="";function a(){if(r&&u){let t=s.possibleComments.map((t=>t.text)).indexOf(u);-1===t?(t=s.possibleComments.length,c(rt,s.possibleComments=[...s.possibleComments,{text:u,points:parseInt(r,10)}],s)):c(rt,s.possibleComments[t].points=parseInt(r,10),s),o.commentIds.includes(t)||c(lt,o.commentIds=[...o.commentIds,t],o),n(0,r=n(1,u=""))}}return[r,u,s,function(t){"Enter"==t.code&&a()},a,function(){u=this.value,n(1,u)},function(t){r=t,n(0,r)}]}class ve extends tt{constructor(t){super(),X(this,t,$e,ge,r,{})}}function be(t,e,n){const s=t.slice();return s[8]=e[n],s}function ye(t){let e;return{c(){e=f("tr"),e.innerHTML="<i>No requests logged</i>"},m(t,n){a(t,e,n)},d(t){t&&i(e)}}}function we(e){let n;return{c(){n=f("td"),n.innerHTML="<i>unknown</i>"},m(t,e){a(t,n,e)},p:t,d(t){t&&i(n)}}}function xe(t){let e,n,s,o=new Date(t[8].lastModified).toLocaleString()+"",r=t[8].daysLate>0&&ke(t);return{c(){e=f("td"),r&&r.c(),n=p(),s=m(o)},m(t,o){a(t,e,o),r&&r.m(e,null),u(e,n),u(e,s)},p(t,l){t[8].daysLate>0?r?r.p(t,l):(r=ke(t),r.c(),r.m(e,n)):r&&(r.d(1),r=null),2&l&&o!==(o=new Date(t[8].lastModified).toLocaleString()+"")&&y(s,o)},d(t){t&&i(e),r&&r.d()}}}function ke(t){let e,n,s=t[8].daysLate+"";return{c(){e=f("div"),n=m(s),v(e,"class","latebadge svelte-1w8y9g0")},m(t,s){a(t,e,s),u(e,n)},p(t,e){2&e&&s!==(s=t[8].daysLate+"")&&y(n,s)},d(t){t&&i(e)}}}function Ce(t){let e,n,s,o,r,l,c,d,h,g,$,b=t[8].statusCode+"",w=t[8].displayUrl+"";function x(t,e){return t[8].lastModified?xe:we}let k=x(t),C=k(t);return{c(){e=f("tr"),n=f("td"),s=m(b),o=p(),C.c(),r=p(),l=f("td"),c=f("a"),d=m(w),$=p(),v(c,"href",h=t[8].url),v(c,"target","_blank"),v(l,"title",g=t[8].url)},m(t,i){a(t,e,i),u(e,n),u(n,s),u(e,o),C.m(e,null),u(e,r),u(e,l),u(l,c),u(c,d),u(e,$)},p(t,n){2&n&&b!==(b=t[8].statusCode+"")&&y(s,b),k===(k=x(t))&&C?C.p(t,n):(C.d(1),C=k(t),C&&(C.c(),C.m(e,r))),2&n&&w!==(w=t[8].displayUrl+"")&&y(d,w),2&n&&h!==(h=t[8].url)&&v(c,"href",h),2&n&&g!==(g=t[8].url)&&v(l,"title",g)},d(t){t&&i(e),C.d()}}}function _e(e){let n,s,o,r,l,c,h,b,w,x,k,C,I,O,D,S,U=1===e[0]?"day":"days",E=e[1],M=[];for(let t=0;t<E.length;t+=1)M[t]=Ce(be(e,E,t));let L=null;return E.length||(L=ye()),{c(){n=f("div"),s=f("div"),o=m("Most recent change made "),r=m(e[0]),l=p(),c=m(U),h=m(" late."),b=p(),w=f("a"),w.textContent="Clear",x=p(),k=f("div"),C=f("table");for(let t=0;t<M.length;t+=1)M[t].c();L&&L.c(),I=p(),O=f("div"),v(s,"class","svelte-1w8y9g0"),v(w,"href","#clear"),v(w,"class","svelte-1w8y9g0"),v(n,"class","summary svelte-1w8y9g0"),_(n,"late",e[0]>0),v(C,"class","svelte-1w8y9g0"),v(O,"class","fade svelte-1w8y9g0"),v(k,"class","wrap svelte-1w8y9g0")},m(t,i){a(t,n,i),u(n,s),u(s,o),u(s,r),u(s,l),u(s,c),u(s,h),u(n,b),u(n,w),a(t,x,i),a(t,k,i),u(k,C);for(let t=0;t<M.length;t+=1)M[t].m(C,null);L&&L.m(C,null),u(k,I),u(k,O),D||(S=g(w,"click",$(e[2])),D=!0)},p(t,[e]){if(1&e&&y(r,t[0]),1&e&&U!==(U=1===t[0]?"day":"days")&&y(c,U),1&e&&_(n,"late",t[0]>0),2&e){let n;for(E=t[1],n=0;n<E.length;n+=1){const s=be(t,E,n);M[n]?M[n].p(s,e):(M[n]=Ce(s),M[n].c(),M[n].m(C,null))}for(;n<M.length;n+=1)M[n].d(1);M.length=E.length,E.length?L&&(L.d(1),L=null):L||(L=ye(),L.c(),L.m(C,null))}},i:t,o:t,d(t){t&&i(n),t&&i(x),t&&i(k),d(M,t),L&&L.d(),D=!1,S()}}}function Ie(t,e){const n=(e-new Date(t).getTime())/1e3,s=-Math.floor(Math.min(0,n/60/60/24));return s>0?s:0}function Oe(t,e,n){let s,o,r,u,a,i;l(t,rt,(t=>n(4,r=t))),l(t,ut,(t=>n(5,u=t))),l(t,at,(t=>n(6,a=t))),l(t,lt,(t=>n(7,i=t)));let d=0;return t.$$.update=()=>{if(16&t.$$.dirty&&n(3,s=new Date(r.dueDate+" 23:59:59").getTime()),232&t.$$.dirty&&n(1,o=u.map((t=>{return Object.assign(Object.assign({},t),{lastModified:(e=a,n=t.url,e[n=n.split("?")[0]]||e[n+"index.html"]||e[n+"index.htm"]||e[n+"index.php"]),displayUrl:t.url.split(i.username)[1]||t.url});var e,n})).map((t=>Object.assign(Object.assign({},t),{daysLate:Ie(t.lastModified,s)})))),11&t.$$.dirty){const t=o.filter((t=>!!t.lastModified)).map((t=>Ie(t.lastModified,s)));n(0,d=Math.max(...t)),n(0,d=isFinite(d)?d:0)}},[d,o,function(){c(ut,u=[],u)},s,r,u,a,i]}class De extends tt{constructor(t){super(),X(this,t,Oe,_e,r,{})}}function Se(t,e,n){const s=t.slice();return s[6]=e[n],s}function Ue(t){let e,n,s,o=_t(Le(t[6],t[1]).commentIds,t[1].possibleComments)+"";return{c(){e=m("("),n=m(o),s=m("%)")},m(t,o){a(t,e,o),a(t,n,o),a(t,s,o)},p(t,e){6&e&&o!==(o=_t(Le(t[6],t[1]).commentIds,t[1].possibleComments)+"")&&y(n,o)},d(t){t&&i(e),t&&i(n),t&&i(s)}}}function Ee(t){let e,n,s,o,r,l,c,d,h,g=St(t[6].realname).last+"",$=St(t[6].realname).first+"",v=t[6].username+"",b=Le(t[6],t[1]),w=b&&Ue(t);return{c(){e=f("option"),n=m(g),s=m(",\n\t\t\t\t"),o=m($),r=m("\n\t\t\t\t("),l=m(v),c=m(")\n\t\t\t\t"),w&&w.c(),d=p(),e.__value=h=t[6].username,e.value=e.__value},m(t,i){a(t,e,i),u(e,n),u(e,s),u(e,o),u(e,r),u(e,l),u(e,c),w&&w.m(e,null),u(e,d)},p(t,s){4&s&&g!==(g=St(t[6].realname).last+"")&&y(n,g),4&s&&$!==($=St(t[6].realname).first+"")&&y(o,$),4&s&&v!==(v=t[6].username+"")&&y(l,v),6&s&&(b=Le(t[6],t[1])),b?w?w.p(t,s):(w=Ue(t),w.c(),w.m(e,d)):w&&(w.d(1),w=null),4&s&&h!==(h=t[6].username)&&(e.__value=h,e.value=e.__value)},d(t){t&&i(e),w&&w.d()}}}function Me(e){let n,o,r,l,c,m,h=e[2].students,$=[];for(let t=0;t<h.length;t+=1)$[t]=Ee(Se(e,h,t));return{c(){n=f("div"),o=f("select");for(let t=0;t<$.length;t+=1)$[t].c();r=p(),l=f("button"),l.textContent="Discard current and jump",v(o,"class","svelte-2269uq"),void 0===e[0]&&T((()=>e[4].call(o))),v(n,"class","svelte-2269uq")},m(t,s){a(t,n,s),u(n,o);for(let t=0;t<$.length;t+=1)$[t].m(o,null);k(o,e[0]),u(n,r),u(n,l),c||(m=[g(o,"change",e[4]),g(l,"click",e[3])],c=!0)},p(t,[e]){if(6&e){let n;for(h=t[2].students,n=0;n<h.length;n+=1){const s=Se(t,h,n);$[n]?$[n].p(s,e):($[n]=Ee(s),$[n].c(),$[n].m(o,null))}for(;n<$.length;n+=1)$[n].d(1);$.length=h.length}5&e&&k(o,t[0])},i:t,o:t,d(t){t&&i(n),d($,t),c=!1,s(m)}}}function Le(t,e){return e.students.find((e=>e.username===t.username))}function Ne(t,e,n){let s,o,r;l(t,lt,(t=>n(5,s=t))),l(t,rt,(t=>n(1,o=t))),l(t,ot,(t=>n(2,r=t)));let u=s.username;return[u,o,r,function(){const t=Le(u,o);t?(c(lt,s=t,s),c(rt,o.students=o.students.filter((t=>t.username!==u)),o)):c(lt,s={username:u,commentIds:[]},s)},function(){u=C(this),n(0,u)}]}class je extends tt{constructor(t){super(),X(this,t,Ne,Me,r,{})}}function Te(t){let e,n,s;return{c(){e=m("Mark as "),n=m(t[3]),s=m("% and continue")},m(t,o){a(t,e,o),a(t,n,o),a(t,s,o)},p(t,e){8&e&&y(n,t[3])},d(t){t&&i(e),t&&i(n),t&&i(s)}}}function Re(e){let n;return{c(){n=m("Mark as perfect and continue")},m(t,e){a(t,n,e)},p:t,d(t){t&&i(n)}}}function Pe(t){let e,n,o,r,l,c,d,h,$,b,k,C,_,I,O,D,S,U,M,L,N,j,T,P,q,z,A,F,H,J,B,Q,X,tt,et,nt,st,ot,rt,lt,ct=t[1].number+"",ut=t[0].username+"";function at(t,e){return 100===t[3]?Re:Te}P=new ve({});let it=at(t),dt=it(t);function ft(e){t[12].call(null,e)}F=new je({}),J=new De({});let mt={embeddedUrl:t[4]};return void 0!==t[2]&&(mt.iframeRef=t[2]),X=new ce({props:mt}),E.push((()=>Y(X,"iframeRef",ft))),{c(){e=f("div"),n=f("div"),o=f("h1"),r=m("Grading homework "),l=m(ct),c=p(),d=f("div"),h=f("div"),$=m("Due "),b=f("input"),k=p(),C=f("button"),C.textContent="Discard all progress",_=p(),I=f("h2"),O=f("div"),D=f("code"),S=m(ut),U=m("\n\t\t\t\t("),M=m(t[3]),L=m("%)"),N=p(),j=f("button"),j.textContent="Reset and regrade",T=p(),K(P.$$.fragment),q=p(),z=f("button"),dt.c(),A=p(),K(F.$$.fragment),H=p(),K(J.$$.fragment),B=p(),Q=f("div"),K(X.$$.fragment),et=p(),nt=f("div"),st=f("div"),v(o,"class","svelte-1r850lh"),v(b,"type","date"),v(h,"class","svelte-1r850lh"),v(d,"class","split svelte-1r850lh"),v(O,"class","svelte-1r850lh"),v(I,"class","split svelte-1r850lh"),v(z,"class","next svelte-1r850lh"),v(n,"class","sidebar svelte-1r850lh"),v(Q,"class","browser svelte-1r850lh"),v(e,"class","wrapper svelte-1r850lh"),x(st,"width",100*t[5]+"%"),v(st,"class","svelte-1r850lh"),v(nt,"class","progress svelte-1r850lh")},m(s,i){a(s,e,i),u(e,n),u(n,o),u(o,r),u(o,l),u(n,c),u(n,d),u(d,h),u(h,$),u(h,b),w(b,t[1].dueDate),u(d,k),u(d,C),u(n,_),u(n,I),u(I,O),u(O,D),u(D,S),u(O,U),u(O,M),u(O,L),u(I,N),u(I,j),u(n,T),V(P,n,null),u(n,q),u(n,z),dt.m(z,null),u(n,A),V(F,n,null),u(n,H),V(J,n,null),u(e,B),u(e,Q),V(X,Q,null),a(s,et,i),a(s,nt,i),u(nt,st),ot=!0,rt||(lt=[g(b,"input",t[11]),g(C,"click",t[8]),g(j,"click",t[7]),g(z,"click",t[6])],rt=!0)},p(t,[e]){(!ot||2&e)&&ct!==(ct=t[1].number+"")&&y(l,ct),2&e&&w(b,t[1].dueDate),(!ot||1&e)&&ut!==(ut=t[0].username+"")&&y(S,ut),(!ot||8&e)&&y(M,t[3]),it===(it=at(t))&&dt?dt.p(t,e):(dt.d(1),dt=it(t),dt&&(dt.c(),dt.m(z,null)));const n={};16&e&&(n.embeddedUrl=t[4]),!tt&&4&e&&(tt=!0,n.iframeRef=t[2],R((()=>tt=!1))),X.$set(n),(!ot||32&e)&&x(st,"width",100*t[5]+"%")},i(t){ot||(G(P.$$.fragment,t),G(F.$$.fragment,t),G(J.$$.fragment,t),G(X.$$.fragment,t),ot=!0)},o(t){W(P.$$.fragment,t),W(F.$$.fragment,t),W(J.$$.fragment,t),W(X.$$.fragment,t),ot=!1},d(t){t&&i(e),Z(P),dt.d(),Z(F),Z(J),Z(X),t&&i(et),t&&i(nt),rt=!1,s(lt)}}}function qe(t,e,n){let s,o,r,u,a,i,d,f,m;l(t,lt,(t=>n(0,u=t))),l(t,rt,(t=>n(1,a=t))),l(t,ot,(t=>n(10,i=t))),l(t,ut,(t=>n(13,d=t))),l(t,at,(t=>n(14,f=t))),l(t,it,(t=>n(15,m=t)));let p,h=u.username;return t.$$.update=()=>{3&t.$$.dirty&&n(3,s=_t(u.commentIds,a.possibleComments)),3&t.$$.dirty&&n(4,o=`${a.prefix}/${u.username}/`),1026&t.$$.dirty&&n(5,r=a.students.length/(i.students.length+1)),513&t.$$.dirty&&h!==u.username&&(n(9,h=u.username),c(ut,d=[],d),c(at,f={},f))},[u,a,p,s,o,r,function(){Ot({type:"clear-cookies"}),c(rt,a.students=[...a.students,u],a),mt()},function(){Ot({type:"clear-cookies",value:m}),c(rt,a.students=a.students.filter((t=>t.username!==u.username)),a),c(lt,u.commentIds=[],u),c(ut,d=[],d),n(2,p.src=o,p)},function(){c(rt,a=null,a),c(lt,u=null,u)},h,i,function(){a.dueDate=this.value,rt.set(a)},function(t){p=t,n(2,p)}]}class ze extends tt{constructor(t){super(),X(this,t,qe,Pe,r,{})}}function Ae(t,e,n){let s,o,r,u,a;l(t,dt,(t=>n(0,s=t))),l(t,ut,(t=>n(1,o=t))),l(t,it,(t=>n(2,r=t))),l(t,at,(t=>n(3,u=t))),l(t,ot,(t=>n(4,a=t)));const i=document.getElementById("comms"),d=new MutationObserver((t=>{function e(e){return!!t.find((t=>t.attributeName==="data-"+e))}if(e("deactivated"))c(dt,s=!1,s);else if(e("activated"))c(dt,s=!0,s);else if(e("newest-request")){const t=JSON.parse(i.dataset.newestRequest);c(ut,o=[t,...o],o)}else if(e("embedded-url")){const t=r;if(c(it,r=JSON.parse(i.dataset.embeddedUrl),r),Dt(t)!==Dt(r)){const t=r.substring(0,r.lastIndexOf("/"));c(at,u={},u),function(t,e,n){const s=new URLSearchParams;return s.append("token",n.token),s.append("ls","yes"),s.append("url",t),fetch(n.endpoint,{method:"post",body:s}).then((t=>t.json())).then((t=>t.result.split("\n").map((t=>t.split(" "))).map((([t,n])=>({name:e+n.replace("./","/"),time:new Date(1e3*parseFloat(t))})))))}(r,t,a).then((t=>{t.forEach((({name:t,time:e})=>{c(at,u[t]=e,u)})),at.set(u)})).catch((t=>{}))}}}));return d.observe(i,{attributes:!0}),D((()=>{d.disconnect()})),[]}class Fe extends tt{constructor(t){super(),X(this,t,Ae,null,r,{})}}function He(e){let n,s,o,r,l,c,u,d;return{c(){n=f("h1"),n.textContent="Install extension",s=m("\n\nInstall the companion browser extension for\n"),o=f("a"),o.textContent="Firefox",r=m("\nor\n"),l=f("a"),l.textContent="Chrome",c=m("\nand\n\n"),u=f("a"),u.textContent="refresh",d=m("."),v(o,"href","https://github.com/jaflo/gradable/releases/latest/download/firefox-extension.xpi"),v(l,"href","https://chrome.google.com/webstore/detail/njijmdbjijgeodnhcnkknkeopbhfgpbg"),v(l,"target","_blank"),v(u,"href","")},m(t,e){a(t,n,e),a(t,s,e),a(t,o,e),a(t,r,e),a(t,l,e),a(t,c,e),a(t,u,e),a(t,d,e)},p:t,i:t,o:t,d(t){t&&i(n),t&&i(s),t&&i(o),t&&i(r),t&&i(l),t&&i(c),t&&i(u),t&&i(d)}}}class Je extends tt{constructor(t){super(),X(this,t,null,He,r,{})}}function Be(e){let n;return{c(){n=m("Checking for plugin...")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n)}}}function Ge(e){let n,s;return n=new Je({}),{c(){K(n.$$.fragment)},m(t,e){V(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){Z(n,t)}}}function We(t){let e,n,s,o;const r=[Ve,Ke,Ye],l=[];function c(t,e){return null===t[2]?0:t[6]?1:2}return e=c(t),n=l[e]=r[e](t),{c(){n.c(),s=h()},m(t,n){l[e].m(t,n),a(t,s,n),o=!0},p(t,o){let u=e;e=c(t),e===u?l[e].p(t,o):(J(),W(l[u],1,1,(()=>{l[u]=null})),B(),n=l[e],n?n.p(t,o):(n=l[e]=r[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){l[e].d(t),t&&i(s)}}}function Ye(e){let n,s,o;return{c(){n=m("Plugin disconnected, did you open this website in another tab? Try\n\t\t"),s=f("a"),s.textContent="refreshing",o=m(" to retry."),v(s,"href","")},m(t,e){a(t,n,e),a(t,s,e),a(t,o,e)},p:t,i:t,o:t,d(t){t&&i(n),t&&i(s),t&&i(o)}}}function Ke(t){let e,n,s,o;const r=[Xe,Qe,Ze],l=[];function c(t,e){return t[5]===t[0].Pending?0:t[5]===t[0].UpToDate?1:2}return e=c(t),n=l[e]=r[e](t),{c(){n.c(),s=h()},m(t,n){l[e].m(t,n),a(t,s,n),o=!0},p(t,o){let u=e;e=c(t),e===u?l[e].p(t,o):(J(),W(l[u],1,1,(()=>{l[u]=null})),B(),n=l[e],n?n.p(t,o):(n=l[e]=r[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){l[e].d(t),t&&i(s)}}}function Ve(e){let n,s;return n=new Zt({}),{c(){K(n.$$.fragment)},m(t,e){V(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){Z(n,t)}}}function Ze(e){let n,o,r,l;return{c(){n=m("Looks like your server script is out of date. Please run this\n\t\t\tcommand again:\n\t\t\t"),o=f("input"),o.readOnly=!0,v(o,"type","text"),o.value=Rt},m(t,e){a(t,n,e),a(t,o,e),r||(l=[g(o,"click",Ut),g(o,"focus",Ut)],r=!0)},p:t,i:t,o:t,d(t){t&&i(n),t&&i(o),r=!1,s(l)}}}function Qe(t){let e,n,s,o;const r=[en,tn],l=[];function c(t,e){return null!==t[1]?0:1}return e=c(t),n=l[e]=r[e](t),{c(){n.c(),s=h()},m(t,n){l[e].m(t,n),a(t,s,n),o=!0},p(t,o){let u=e;e=c(t),e===u?l[e].p(t,o):(J(),W(l[u],1,1,(()=>{l[u]=null})),B(),n=l[e],n?n.p(t,o):(n=l[e]=r[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){l[e].d(t),t&&i(s)}}}function Xe(e){let n;return{c(){n=m("Checking server version...")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n)}}}function tn(e){let n,s;return n=new Yt({}),{c(){K(n.$$.fragment)},m(t,e){V(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){Z(n,t)}}}function en(t){let e,n,s,o;const r=[sn,nn],l=[];function c(t,e){return null!==t[7]?0:1}return e=c(t),n=l[e]=r[e](t),{c(){n.c(),s=h()},m(t,n){l[e].m(t,n),a(t,s,n),o=!0},p(t,o){let u=e;e=c(t),e!==u&&(J(),W(l[u],1,1,(()=>{l[u]=null})),B(),n=l[e],n||(n=l[e]=r[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){l[e].d(t),t&&i(s)}}}function nn(t){let e,n;return e=new oe({}),{c(){K(e.$$.fragment)},m(t,s){V(e,t,s),n=!0},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function sn(t){let e,n;return e=new ze({}),{c(){K(e.$$.fragment)},m(t,s){V(e,t,s),n=!0},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function on(t){let e,n,s,o,r;const l=[We,Ge,Be],c=[];function u(t,e){return t[3]?0:t[4]?1:2}return e=u(t),n=c[e]=l[e](t),o=new Fe({}),{c(){n.c(),s=p(),K(o.$$.fragment)},m(t,n){c[e].m(t,n),a(t,s,n),V(o,t,n),r=!0},p(t,[o]){let r=e;e=u(t),e===r?c[e].p(t,o):(J(),W(c[r],1,1,(()=>{c[r]=null})),B(),n=c[e],n?n.p(t,o):(n=c[e]=l[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){r||(G(n),G(o.$$.fragment,t),r=!0)},o(t){W(n),W(o.$$.fragment,t),r=!1},d(t){c[e].d(t),t&&i(s),Z(o,t)}}}const rn="gradable-plugin-present";function ln(t,e,n){let s,o,r,c;l(t,rt,(t=>n(1,s=t))),l(t,ot,(t=>n(2,o=t))),l(t,dt,(t=>n(6,r=t))),l(t,lt,(t=>n(7,c=t)));let u=document.body.classList.contains(rn),a=!1;function i(){d(),Ot({type:"register-active"})}function d(){s&&Ot({type:"set-homework-number",value:s.number})}var f;setTimeout((()=>n(4,a=!0)),400),new MutationObserver(((t,e)=>{t.find((t=>"class"===t.attributeName))&&document.body.classList.contains(rn)&&(n(3,u=!0),e.disconnect(),i())})).observe(document.body,{attributes:!0}),u&&i(),function(t){t[t.Pending=0]="Pending",t[t.OutOfDate=1]="OutOfDate",t[t.UpToDate=2]="UpToDate"}(f||(f={}));let m=f.Pending,p="";return t.$$.update=()=>{2&t.$$.dirty&&s&&s.number&&d(),261&t.$$.dirty&&o&&o.endpoint+o.token!==p&&(n(8,p=o.endpoint+o.token),function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("version","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json())).then((t=>{if(t.success)return!(t.version<2);throw new Error("Failed connection to server script.")}))}(o).then((t=>n(5,m=t?f.UpToDate:f.OutOfDate))).catch((t=>n(5,m=f.OutOfDate))))},[f,s,o,u,a,m,r,c,p]}return new class extends tt{constructor(t){super(),X(this,t,ln,on,r,{})}}({target:document.body})}();
