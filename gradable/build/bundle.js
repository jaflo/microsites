var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function u(t,e,n=e){return t.set(n),e}function c(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function p(){return m(" ")}function h(){return m("")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function $(t){return function(e){return e.preventDefault(),t.call(this,e)}}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function w(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function k(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}}function C(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function _(t,e,n){t.classList[n?"add":"remove"](e)}let I;function S(t){I=t}function M(t){(function(){if(!I)throw new Error("Function called outside component initialization");return I})().$$.on_destroy.push(t)}function D(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t(e)))}const E=[],L=[],U=[],O=[],N=Promise.resolve();let j=!1;function T(t){U.push(t)}function R(t){O.push(t)}let H=!1;const P=new Set;function q(){if(!H){H=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];S(e),A(e.$$)}for(S(null),E.length=0;L.length;)L.pop()();for(let t=0;t<U.length;t+=1){const e=U[t];P.has(e)||(P.add(e),e())}U.length=0}while(E.length);for(;O.length;)O.pop()();j=!1,H=!1,P.clear()}}function A(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const F=new Set;let J;function z(){J={r:0,c:[],p:J}}function B(){J.r||s(J.c),J=J.p}function G(t,e){t&&t.i&&(F.delete(t),t.i(e))}function W(t,e,n,s){if(t&&t.o){if(F.has(t))return;F.add(t),J.c.push((()=>{F.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function Y(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function V(t){t&&t.c()}function Z(t,n,l){const{fragment:r,on_mount:u,on_destroy:c,after_update:i}=t.$$;r&&r.m(n,l),T((()=>{const n=u.map(e).filter(o);c?c.push(...n):s(n),t.$$.on_mount=[]})),i.forEach(T)}function K(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e){-1===t.$$.dirty[0]&&(E.push(t),j||(j=!0,N.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,o,l,r,u,c,i=[-1]){const d=I;S(e);const f=o.props||{},m=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:i,skip_bound:!1};let p=!1;if(m.ctx=l?l(e,f,((t,n,...s)=>{const o=s.length?s[0]:n;return m.ctx&&u(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),p&&Q(e,t)),n})):[],m.update(),p=!0,s(m.before_update),m.fragment=!!r&&r(m.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);m.fragment&&m.fragment.l(t),t.forEach(a)}else m.fragment&&m.fragment.c();o.intro&&G(e.$$.fragment),Z(e,o.target,o.anchor),q()}S(d)}class tt{$destroy(){K(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let s;const o=[];function r(t){if(l(e,t)&&(e=t,s)){const t=!et.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),et.push(n,e)}if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,u=t){const c=[l,u];return o.push(c),1===o.length&&(s=n(r)||t),l(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(s(),s=null)}}}}function st(t,e){const n=localStorage.getItem(t);let s=e||null;n&&(s=JSON.parse(n));const o=nt(s);return o.subscribe((e=>localStorage.setItem(t,JSON.stringify(e)))),o}const ot=st("config"),lt=st("homework"),rt=st("student"),ut=st("checkpoints",[]),ct=nt([]),it=nt({}),at=nt(""),dt=nt(!1);let ft=[];function mt(){const t=JSON.parse(localStorage.getItem("config")).students.map((t=>t.username)).filter((t=>!ft.includes(t)));if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];rt.set({username:e,commentIds:[]})}else rt.set(null)}function pt(e){let n,o,l,r,u,d,h,$,b,y,w,C,_,I,S,M,D,E,L,U,O,N,j,R,H;return{c(){n=f("label"),o=f("span"),o.textContent="Homework number",l=p(),r=f("input"),u=p(),d=f("label"),h=f("span"),h.textContent="Due date (EOD)",$=p(),b=f("input"),y=p(),w=f("div"),C=m("https://"),_=f("select"),I=f("option"),I.textContent="fall",S=f("option"),S.textContent="spring",M=m("-"),D=f("input"),E=m(".cs.utexas.edu/"),L=f("input"),U=p(),O=f("button"),N=m("Start grading"),v(r,"type","text"),v(r,"placeholder","1"),v(r,"class","short svelte-1re6vz0"),v(b,"type","date"),v(b,"class","date"),I.__value="fall",I.value=I.__value,S.__value="spring",S.value=S.__value,void 0===e[0]&&T((()=>e[8].call(_))),v(D,"type","text"),v(D,"class","short svelte-1re6vz0"),v(L,"type","text"),v(w,"class","prefix svelte-1re6vz0"),O.disabled=j=!e[3]||!e[4]||!e[2]},m(t,s){i(t,n,s),c(n,o),c(n,l),c(n,r),x(r,e[3]),i(t,u,s),i(t,d,s),c(d,h),c(d,$),c(d,b),x(b,e[4]),i(t,y,s),i(t,w,s),c(w,C),c(w,_),c(_,I),c(_,S),k(_,e[0]),c(w,M),c(w,D),x(D,e[1]),c(w,E),c(w,L),x(L,e[2]),i(t,U,s),i(t,O,s),c(O,N),R||(H=[g(r,"input",e[6]),g(b,"input",e[7]),g(_,"change",e[8]),g(D,"input",e[9]),g(L,"input",e[10]),g(O,"click",e[5])],R=!0)},p(t,[e]){8&e&&r.value!==t[3]&&x(r,t[3]),16&e&&x(b,t[4]),1&e&&k(_,t[0]),2&e&&D.value!==t[1]&&x(D,t[1]),4&e&&L.value!==t[2]&&x(L,t[2]),28&e&&j!==(j=!t[3]||!t[4]||!t[2])&&(O.disabled=j)},i:t,o:t,d(t){t&&a(n),t&&a(u),t&&a(d),t&&a(y),t&&a(w),t&&a(U),t&&a(O),R=!1,s(H)}}}function ht(t,e,n){let s,o,l,c;r(t,lt,(t=>n(12,o=t))),r(t,ct,(t=>n(13,l=t))),r(t,it,(t=>n(14,c=t)));let i="",a="";const d=new Date;let f=d.getMonth()<6?"spring":"fall",m=d.getFullYear(),p="cs329e-bulko";return t.$$.update=()=>{7&t.$$.dirty&&(s=`https://${f}-${m}.cs.utexas.edu/${p}`)},[f,m,p,i,a,function(){u(lt,o={number:parseInt(i),dueDate:a,students:[],possibleComments:[{text:"One day late",points:10},{text:"Two days late",points:20},{text:"No submission",points:100}],prefix:s},o),u(ct,l=[],l),u(it,c={},c),mt()},function(){i=this.value,n(3,i)},function(){a=this.value,n(4,a)},function(){f=C(this),n(0,f)},function(){m=this.value,n(1,m)},function(){p=this.value,n(2,p)}]}lt.subscribe((t=>ft=t&&t.students.map((t=>t.username))));class gt extends tt{constructor(t){super(),X(this,t,ht,pt,l,{})}}var $t=["second","minute","hour","day","week","month","year"];var vt=["秒","分钟","小时","天","周","个月","年"];var bt={},yt=function(t,e){bt[t]=e},xt=[60,60,24,7,365/7/12,12];function wt(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}var kt=function(t,e,n){return function(t,e){for(var n=t<0?1:0,s=t=Math.abs(t),o=0;t>=xt[o]&&o<xt.length;o++)t/=xt[o];return(t=Math.floor(t))>(0==(o*=2)?9:1)&&(o+=1),e(t,o,s)[n].replace("%s",t.toString())}(function(t,e){return(+(e?wt(e):new Date)-+wt(t))/1e3}(t,n&&n.relativeDate),function(t){return bt[t]||bt.en_US}(e))};function Ct(t){return kt(new Date(t))}function _t(t,e){let n=100;for(const s of t)n-=e[s].points;return n}yt("en_US",(function(t,e){if(0===e)return["just now","right now"];var n=$t[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]})),yt("zh_CN",(function(t,e){if(0===e)return["刚刚","片刻后"];var n=vt[~~(e/2)];return[t+" "+n+"前",t+" "+n+"后"]}));const It=document.getElementById("comms");function St(t){It.dataset.tellExtension=JSON.stringify(t)}function Mt(t){return t.split("/")[5]}function Dt(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function Et(t){let e,n,s,o,l,r=t[9].label+"",u=Ct(t[9].lastChange)+"";return{c(){e=f("option"),n=m(r),s=m(", saved "),o=m(u),l=p(),e.__value=t[11],e.value=e.__value},m(t,r){i(t,e,r),c(e,n),c(e,s),c(e,o),c(e,l)},p(t,e){2&e&&r!==(r=t[9].label+"")&&y(n,r),2&e&&u!==(u=Ct(t[9].lastChange)+"")&&y(o,u)},d(t){t&&a(e)}}}function Lt(e){let n,o,l,r,u,c=e[1],m=[];for(let t=0;t<c.length;t+=1)m[t]=Et(Dt(e,c,t));return{c(){n=f("select");for(let t=0;t<m.length;t+=1)m[t].c();o=p(),l=f("button"),l.textContent="Restore from save",void 0===e[0]&&T((()=>e[4].call(n)))},m(t,s){i(t,n,s);for(let t=0;t<m.length;t+=1)m[t].m(n,null);k(n,e[0]),i(t,o,s),i(t,l,s),r||(u=[g(n,"change",e[4]),g(l,"click",e[2])],r=!0)},p(t,[e]){if(2&e){let s;for(c=t[1],s=0;s<c.length;s+=1){const o=Dt(t,c,s);m[s]?m[s].p(o,e):(m[s]=Et(o),m[s].c(),m[s].m(n,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=c.length}1&e&&k(n,t[0])},i:t,o:t,d(t){t&&a(n),d(m,t),t&&a(o),t&&a(l),r=!1,s(u)}}}function Ut(t,e,n){let s,o,l,c,i,a;r(t,ut,(t=>n(3,o=t))),r(t,ct,(t=>n(5,l=t))),r(t,it,(t=>n(6,c=t))),r(t,lt,(t=>n(7,i=t))),r(t,rt,(t=>n(8,a=t)));let d=0;return t.$$.update=()=>{8&t.$$.dirty&&n(1,s=(null==o?void 0:o.sort(((t,e)=>e.lastChange-t.lastChange)))||[])},[d,s,function(){u(ct,l=[],l),u(it,c={},c);const t=o[d];u(lt,i=t.homework,i),u(rt,a=t.currentStudent,a),o.splice(d,1),ut.set(o)},o,function(){d=C(this),n(0,d)}]}class Ot extends tt{constructor(t){super(),X(this,t,Ut,Lt,l,{})}}function Nt(t,e,n,s){var o;const l=null===(o=s.students.find((t=>t.username===e)))||void 0===o?void 0:o.password;if(!l)throw new Error("Unknown student");const r=new URLSearchParams;return r.append("token",s.token),r.append("lock",t?"yes":"no"),r.append("url",n),r.append("user",e),r.append("pass",l),fetch(s.endpoint,{method:"post",body:r}).then((t=>t.json()))}function jt(t,e,n){const s=t.slice();return s[3]=e[n],s}function Tt(t){let e,n,s,o,l=t[0],r=[];for(let e=0;e<l.length;e+=1)r[e]=Rt(jt(t,l,e));return{c(){e=f("table"),n=f("thead"),n.innerHTML="<tr><td>username</td> \n\t\t\t\t\t<td>password</td></tr>",s=p(),o=f("tbody");for(let t=0;t<r.length;t+=1)r[t].c();v(e,"class","svelte-1m4fcs3")},m(t,l){i(t,e,l),c(e,n),c(e,s),c(e,o);for(let t=0;t<r.length;t+=1)r[t].m(o,null)},p(t,e){if(1&e){let n;for(l=t[0],n=0;n<l.length;n+=1){const s=jt(t,l,n);r[n]?r[n].p(s,e):(r[n]=Rt(s),r[n].c(),r[n].m(o,null))}for(;n<r.length;n+=1)r[n].d(1);r.length=l.length}},d(t){t&&a(e),d(r,t)}}}function Rt(t){let e,n,s,o,l,r,u,d=t[3].username+"",h=t[3].password+"";return{c(){e=f("tr"),n=f("td"),s=m(d),o=p(),l=f("td"),r=m(h),u=p()},m(t,a){i(t,e,a),c(e,n),c(n,s),c(e,o),c(e,l),c(l,r),c(e,u)},p(t,e){1&e&&d!==(d=t[3].username+"")&&y(s,d),1&e&&h!==(h=t[3].password+"")&&y(r,h)},d(t){t&&a(e)}}}function Ht(e){let n,s,o,l,r,u,d,h,$,v,b,w,k=e[0].length+"",C=1===e[0].length?"student":"students",_=e[0].length>0&&Tt(e);return{c(){n=f("label"),s=f("h2"),o=m(k),l=p(),r=m(C),u=p(),d=f("p"),d.textContent="Each row should have the username and password separated by a tab.",h=p(),$=f("textarea"),v=p(),_&&_.c()},m(t,a){i(t,n,a),c(n,s),c(s,o),c(s,l),c(s,r),c(n,u),c(n,d),c(n,h),c(n,$),x($,e[1]),c(n,v),_&&_.m(n,null),b||(w=g($,"input",e[2]),b=!0)},p(t,[e]){1&e&&k!==(k=t[0].length+"")&&y(o,k),1&e&&C!==(C=1===t[0].length?"student":"students")&&y(r,C),2&e&&x($,t[1]),t[0].length>0?_?_.p(t,e):(_=Tt(t),_.c(),_.m(n,null)):_&&(_.d(1),_=null)},i:t,o:t,d(t){t&&a(n),_&&_.d(),b=!1,w()}}}function Pt(t,e,n){let{students:s=[]}=e,o=function(t){return t.map((t=>`${t.username}\t${t.password}`)).join("\n")}(s);return t.$$set=t=>{"students"in t&&n(0,s=t.students)},t.$$.update=()=>{2&t.$$.dirty&&n(0,s=o.split("\n").filter((t=>!!t)).map((t=>t.split("\t"))).map((([t,e])=>({username:t,password:e,canvasId:""}))))},[s,o,function(){o=this.value,n(1,o)}]}class qt extends tt{constructor(t){super(),X(this,t,Pt,Ht,l,{students:0})}}function At(t){let e,n,s,o;return s=new Ot({}),{c(){e=f("h1"),e.textContent="Load previous session",n=p(),V(s.$$.fragment),v(e,"class","svelte-tylxsl")},m(t,l){i(t,e,l),i(t,n,l),Z(s,t,l),o=!0},i(t){o||(G(s.$$.fragment,t),o=!0)},o(t){W(s.$$.fragment,t),o=!1},d(t){t&&a(e),t&&a(n),K(s,t)}}}function Ft(t){let e,n,o,l,r,u,c,d,h,$,b,x,w,k,C,_,I,S,M,D,E,U,O=t[0].endpoint+"";o=new gt({});let N=null!==t[1]&&t[1].length>0&&At();function j(e){t[4].call(null,e)}let T={};return void 0!==t[0].students&&(T.students=t[0].students),x=new qt({props:T}),L.push((()=>Y(x,"students",j))),{c(){e=f("h1"),e.textContent="Grade new homework",n=p(),V(o.$$.fragment),l=p(),N&&N.c(),r=p(),u=f("h1"),u.textContent="Configuration",c=p(),d=f("h2"),d.textContent="UT CS server endpoint",h=p(),$=m(O),b=p(),V(x.$$.fragment),k=p(),C=f("h2"),C.textContent="Reset",_=p(),I=f("button"),I.textContent="Delete local config and set up again",S=p(),M=f("button"),M.textContent="Reset server configuration",v(e,"class","svelte-tylxsl"),v(u,"class","svelte-tylxsl")},m(s,a){i(s,e,a),i(s,n,a),Z(o,s,a),i(s,l,a),N&&N.m(s,a),i(s,r,a),i(s,u,a),i(s,c,a),i(s,d,a),i(s,h,a),i(s,$,a),i(s,b,a),Z(x,s,a),i(s,k,a),i(s,C,a),i(s,_,a),i(s,I,a),i(s,S,a),i(s,M,a),D=!0,E||(U=[g(I,"click",t[3]),g(M,"click",t[2])],E=!0)},p(t,[e]){null!==t[1]&&t[1].length>0?N?2&e&&G(N,1):(N=At(),N.c(),G(N,1),N.m(r.parentNode,r)):N&&(z(),W(N,1,1,(()=>{N=null})),B()),(!D||1&e)&&O!==(O=t[0].endpoint+"")&&y($,O);const n={};!w&&1&e&&(w=!0,n.students=t[0].students,R((()=>w=!1))),x.$set(n)},i(t){D||(G(o.$$.fragment,t),G(N),G(x.$$.fragment,t),D=!0)},o(t){W(o.$$.fragment,t),W(N),W(x.$$.fragment,t),D=!1},d(t){t&&a(e),t&&a(n),K(o,t),t&&a(l),N&&N.d(t),t&&a(r),t&&a(u),t&&a(c),t&&a(d),t&&a(h),t&&a($),t&&a(b),K(x,t),t&&a(k),t&&a(C),t&&a(_),t&&a(I),t&&a(S),t&&a(M),E=!1,s(U)}}}function Jt(t,e,n){let s,o;return r(t,ot,(t=>n(0,s=t))),r(t,ut,(t=>n(1,o=t))),[s,o,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("remove","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(s).then((({success:t})=>{t?alert("Server reset, you still need to delete gradable.php"):alert("Failed, could not reset")}))},function(){confirm(`You are about to DELETE EVERYTHING, including your authentication token and ${o.length} checkpoints. Are you sure?`)&&(localStorage.clear(),window.location=window.location)},function(t){s.students=t,ot.set(s)}]}class zt extends tt{constructor(t){super(),X(this,t,Jt,Ft,l,{})}}function Bt(t){let e,n,o,l,r,u,d,h,$,b,y,w,k,C,_,I,S,M,D,E,U,O,N,j,T,H,P,q,A;function F(e){t[8].call(null,e)}let J={};return void 0!==t[2]&&(J.students=t[2]),U=new qt({props:J}),L.push((()=>Y(U,"students",F))),{c(){e=f("h1"),e.textContent="Setup",n=p(),o=f("ul"),l=f("li"),r=m("What is your UT CS username?\n\t\t"),u=f("input"),d=p(),h=f("li"),$=m("Log in to your UT CS account and run\n\t\t"),b=f("input"),y=p(),w=f("li"),k=m("Go to "),C=f("a"),_=m("this link"),I=m(", copy the token,\n\t\tand paste it here:\n\t\t"),S=f("input"),M=p(),D=f("li"),D.textContent="Paste your list of students separated by linebreaks below.",E=p(),V(U.$$.fragment),N=p(),j=f("button"),T=m("Save and continue"),v(u,"type","text"),v(b,"type","text"),b.value=`cd ~/public_html && wget -O ${Gt} "${t[4]}server/${Gt}" && chmod +x ${Gt}`,v(C,"href",t[3]),v(C,"target","_blank"),v(S,"type","text"),j.disabled=H=!t[1]||!t[0]||!t[2]},m(s,a){i(s,e,a),i(s,n,a),i(s,o,a),c(o,l),c(l,r),c(l,u),x(u,t[1]),c(o,d),c(o,h),c(h,$),c(h,b),c(o,y),c(o,w),c(w,k),c(w,C),c(C,_),c(w,I),c(w,S),x(S,t[0]),c(o,M),c(o,D),i(s,E,a),Z(U,s,a),i(s,N,a),i(s,j,a),c(j,T),P=!0,q||(A=[g(u,"input",t[6]),g(b,"click",Wt),g(b,"focus",Wt),g(S,"input",t[7]),g(j,"click",t[5])],q=!0)},p(t,[e]){2&e&&u.value!==t[1]&&x(u,t[1]),(!P||8&e)&&v(C,"href",t[3]),1&e&&S.value!==t[0]&&x(S,t[0]);const n={};!O&&4&e&&(O=!0,n.students=t[2],R((()=>O=!1))),U.$set(n),(!P||7&e&&H!==(H=!t[1]||!t[0]||!t[2]))&&(j.disabled=H)},i(t){P||(G(U.$$.fragment,t),P=!0)},o(t){W(U.$$.fragment,t),P=!1},d(t){t&&a(e),t&&a(n),t&&a(o),t&&a(E),K(U,t),t&&a(N),t&&a(j),q=!1,s(A)}}}const Gt="gradable.php";function Wt(t){t.target.select()}function Yt(t,e,n){let s,o,l;r(t,ot,(t=>n(10,l=t)));let c="",i="",a=[];const d=document.location.href;return t.$$.update=()=>{2&t.$$.dirty&&n(3,s=`https://www.cs.utexas.edu/~${i}/${Gt}`),13&t.$$.dirty&&(o={token:c,endpoint:s,students:a})},[c,i,a,s,d,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("ping","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(o).then((t=>{t.success?u(ot,l=o,l):alert("Invalid token")})).catch((()=>{alert("Could not connect to server")}))},function(){i=this.value,n(1,i)},function(){c=this.value,n(0,c)},function(t){a=t,n(2,a)}]}class Vt extends tt{constructor(t){super(),X(this,t,Yt,Bt,l,{})}}function Zt(t,e,n){const s=t.slice();return s[10]=e[n],s[12]=n,s}function Kt(e){let n;return{c(){n=f("i"),n.textContent="none"},m(t,e){i(t,n,e)},p:t,d(t){t&&a(n)}}}function Qt(t){let e,n,o,l;return{c(){e=f("textarea"),e.readOnly=!0,e.value=n=t[4](t[10].commentIds,"\n"),v(e,"class","svelte-gmr12x")},m(t,n){i(t,e,n),o||(l=[g(e,"click",ee),g(e,"focus",ee)],o=!0)},p(t,s){2&s&&n!==(n=t[4](t[10].commentIds,"\n"))&&(e.value=n)},d(t){t&&a(e),o=!1,s(l)}}}function Xt(t){let e,n,o,l,r,u,d,h,$,b,x,w,k,C,_,I,S=t[10].username+"";function M(t,e){return t[10].commentIds.length>0?Qt:Kt}let D=M(t),E=D(t);function L(){return t[6](t[12])}return{c(){e=f("tr"),n=f("td"),o=m(S),l=p(),r=f("td"),u=f("input"),h=m("%"),$=p(),b=f("td"),E.c(),x=p(),w=f("td"),k=f("button"),k.textContent="regrade",C=p(),u.readOnly=!0,v(u,"class","percentage svelte-gmr12x"),v(u,"type","text"),u.value=d=_t(t[10].commentIds,t[0].possibleComments)},m(t,s){i(t,e,s),c(e,n),c(n,o),c(e,l),c(e,r),c(r,u),c(r,h),c(e,$),c(e,b),E.m(b,null),c(e,x),c(e,w),c(w,k),c(e,C),_||(I=[g(u,"click",ee),g(u,"focus",ee),g(k,"click",L)],_=!0)},p(e,n){t=e,2&n&&S!==(S=t[10].username+"")&&y(o,S),3&n&&d!==(d=_t(t[10].commentIds,t[0].possibleComments))&&u.value!==d&&(u.value=d),D===(D=M(t))&&E?E.p(t,n):(E.d(1),E=D(t),E&&(E.c(),E.m(b,null)))},d(t){t&&a(e),E.d(),_=!1,s(I)}}}function te(e){let n,s,o,l,r,u,m,h,$=e[1],b=[];for(let t=0;t<$.length;t+=1)b[t]=Xt(Zt(e,$,t));return{c(){n=f("table"),s=f("thead"),s.innerHTML='<tr><td>id</td> \n\t\t\t<td>grade</td> \n\t\t\t<td width="99%">comments</td> \n\t\t\t<td>actions</td></tr>',o=p(),l=f("tbody");for(let t=0;t<b.length;t+=1)b[t].c();r=p(),u=f("button"),u.textContent="Export and continue",v(n,"class","svelte-gmr12x")},m(t,a){i(t,n,a),c(n,s),c(n,o),c(n,l);for(let t=0;t<b.length;t+=1)b[t].m(l,null);i(t,r,a),i(t,u,a),m||(h=g(u,"click",e[2]),m=!0)},p(t,[e]){if(27&e){let n;for($=t[1],n=0;n<$.length;n+=1){const s=Zt(t,$,n);b[n]?b[n].p(s,e):(b[n]=Xt(s),b[n].c(),b[n].m(l,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}},i:t,o:t,d(t){t&&a(n),d(b,t),t&&a(r),t&&a(u),m=!1,h()}}}function ee(t){t.target.select()}function ne(t,e,n){let s,o,l,c,i;function a(t){u(rt,i=o.students[t],i),o.students.splice(t,1),lt.set(o)}function d(t,e){return t.map((t=>o.possibleComments[t])).map((({points:t,text:e})=>`-${t}: ${e}`)).join(e)}r(t,lt,(t=>n(0,o=t))),r(t,ot,(t=>n(5,l=t))),r(t,ut,(t=>n(7,c=t))),r(t,rt,(t=>n(8,i=t)));return t.$$.update=()=>{33&t.$$.dirty&&n(1,s=o?l.students.map((t=>(null==o?void 0:o.students.find((e=>e.username===t.username)))||{})):[])},[o,s,function(){u(ut,c=[...c,{label:"HW "+o.number,lastChange:(new Date).getTime(),homework:o,currentStudent:null}],c);let t="name\tscore\tcomments\n";s.forEach((e=>{t+=e.username,t+="\t",t+=_t(e.commentIds,null==o?void 0:o.possibleComments),t+="\t",t+=d(e.commentIds,"; "),t+="\n"}));const e=document.createElement("a");e.setAttribute("href","data:text/tab-separated-values;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",`HW${o.number}export-${(new Date).getTime()/1e3|0}.csv`),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),u(lt,o=null,o)},a,d,l,t=>{a(t)}]}class se extends tt{constructor(t){super(),X(this,t,ne,te,l,{})}}function oe(e){let n,o,l,r,u,d,h,$,b,x,w,k,C,_,I,S,M,D,E,L,U,O,N,j,T=(Mt(e[2])||"")+"",R=(Mt(e[2])||"")+"";return{c(){n=f("div"),o=f("div"),l=f("div"),r=m(e[2]),u=f("span"),u.textContent="ignore",d=p(),h=f("button"),$=m("Unlock "),b=m(T),w=p(),k=f("button"),C=m("Lock "),_=m(R),S=p(),M=f("button"),M.textContent="Clear cookies",D=p(),E=f("button"),E.textContent="Refresh",L=p(),U=f("iframe"),v(u,"class","svelte-1ks2w4f"),v(l,"class","location svelte-1ks2w4f"),h.disabled=x=!Mt(e[2]),v(h,"class","svelte-1ks2w4f"),k.disabled=I=!Mt(e[2]),v(k,"class","svelte-1ks2w4f"),v(M,"class","svelte-1ks2w4f"),v(E,"class","svelte-1ks2w4f"),v(o,"class","top svelte-1ks2w4f"),U.src!==(O=e[1])&&v(U,"src",O),v(U,"frameborder","0"),v(U,"title","Embedded website to grade"),v(U,"class","svelte-1ks2w4f"),v(n,"class","browser svelte-1ks2w4f")},m(t,s){i(t,n,s),c(n,o),c(o,l),c(l,r),c(l,u),c(o,d),c(o,h),c(h,$),c(h,b),c(o,w),c(o,k),c(k,C),c(k,_),c(o,S),c(o,M),c(o,D),c(o,E),c(n,L),c(n,U),e[7](U),N||(j=[g(h,"click",e[5]),g(k,"click",e[6]),g(M,"click",e[4]),g(E,"click",e[3])],N=!0)},p(t,[e]){4&e&&y(r,t[2]),4&e&&T!==(T=(Mt(t[2])||"")+"")&&y(b,T),4&e&&x!==(x=!Mt(t[2]))&&(h.disabled=x),4&e&&R!==(R=(Mt(t[2])||"")+"")&&y(_,R),4&e&&I!==(I=!Mt(t[2]))&&(k.disabled=I),2&e&&U.src!==(O=t[1])&&v(U,"src",O)},i:t,o:t,d(t){t&&a(n),e[7](null),N=!1,s(j)}}}function le(t,e,n){let s,o,l;r(t,at,(t=>n(2,s=t))),r(t,rt,(t=>n(8,o=t))),r(t,ot,(t=>n(9,l=t)));let{embeddedUrl:u="about:blank"}=e,{iframeRef:c}=e;return t.$$set=t=>{"embeddedUrl"in t&&n(1,u=t.embeddedUrl),"iframeRef"in t&&n(0,c=t.iframeRef)},[c,u,s,function(){St({type:"refresh-page"})},function(){St({type:"clear-cookies",value:s})},function(){!function(t,e,n){Nt(!1,e,t,n)}(s,o.username,l)},function(){!function(t,e,n){Nt(!0,e,t,n)}(s,o.username,l)},function(t){L[t?"unshift":"push"]((()=>{c=t,n(0,c)}))}]}class re extends tt{constructor(t){super(),X(this,t,le,oe,l,{embeddedUrl:1,iframeRef:0})}}function ue(e){let n,o,l,r,u,d;return{c(){n=f("div"),o=f("div"),o.textContent="-",l=p(),r=f("input"),v(o,"class","minus svelte-mu2102"),v(r,"type","number"),v(r,"class","points svelte-mu2102"),v(r,"placeholder","5"),v(n,"class","join svelte-mu2102")},m(t,s){i(t,n,s),c(n,o),c(n,l),c(n,r),x(r,e[0]),u||(d=[g(r,"input",e[4]),g(r,"keyup",$(e[1])),g(r,"blur",e[2]),g(r,"change",e[3])],u=!0)},p(t,[e]){1&e&&b(r.value)!==t[0]&&x(r,t[0])},i:t,o:t,d(t){t&&a(n),u=!1,s(d)}}}function ce(t,e,n){let{value:s}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value)},[s,function(e){D(t,e)},function(e){D(t,e)},function(e){D(t,e)},function(){s=b(this.value),n(0,s)}]}class ie extends tt{constructor(t){super(),X(this,t,ce,ue,l,{value:0})}}function ae(t){let e,n,o,l,r,u,d,m,h,$,b,y,w;function k(e){t[7].call(null,e)}let C={};return void 0!==t[0].points&&(C.value=t[0].points),u=new ie({props:C}),L.push((()=>Y(u,"value",k))),u.$on("change",t[4]),{c(){e=f("tr"),n=f("td"),o=f("input"),l=p(),r=f("td"),V(u.$$.fragment),m=p(),h=f("td"),$=f("input"),v(o,"type","text"),v(o,"placeholder","Missing name"),v(o,"class","svelte-1te1hhk"),v(n,"class","comment svelte-1te1hhk"),v($,"type","checkbox"),$.checked=t[2],v($,"class","svelte-1te1hhk"),v(h,"class","toggle svelte-1te1hhk"),v(e,"class","svelte-1te1hhk"),_(e,"inactive",!t[2])},m(s,a){i(s,e,a),c(e,n),c(n,o),x(o,t[0].text),c(e,l),c(e,r),Z(u,r,null),c(e,m),c(e,h),c(h,$),b=!0,y||(w=[g(o,"input",t[6]),g(o,"change",t[4]),g($,"change",t[8]),g(h,"click",t[9])],y=!0)},p(t,[n]){1&n&&o.value!==t[0].text&&x(o,t[0].text);const s={};!d&&1&n&&(d=!0,s.value=t[0].points,R((()=>d=!1))),u.$set(s),(!b||4&n)&&($.checked=t[2]),4&n&&_(e,"inactive",!t[2])},i(t){b||(G(u.$$.fragment,t),b=!0)},o(t){W(u.$$.fragment,t),b=!1},d(t){t&&a(e),K(u),y=!1,s(w)}}}function de(t,e,n){let s,o,l;r(t,rt,(t=>n(5,o=t))),r(t,lt,(t=>n(10,l=t)));let{comment:c}=e,{commentId:i}=e;function a(t,e){t?o.commentIds.includes(e)||u(rt,o.commentIds=[...o.commentIds,e],o):u(rt,o.commentIds=o.commentIds.filter((t=>t!==e)),o)}return t.$$set=t=>{"comment"in t&&n(0,c=t.comment),"commentId"in t&&n(1,i=t.commentId)},t.$$.update=()=>{34&t.$$.dirty&&n(2,s=o.commentIds.includes(i))},[c,i,s,a,function(){u(lt,l.possibleComments[i]=c,l)},o,function(){c.text=this.value,n(0,c)},function(t){c.points=t,n(0,c)},t=>a(t.target.checked,i),()=>a(!s,i)]}class fe extends tt{constructor(t){super(),X(this,t,de,ae,l,{comment:0,commentId:1})}}function me(t,e,n){const s=t.slice();return s[8]=e[n],s[10]=n,s}function pe(t){let e,n;return e=new fe({props:{comment:t[8],commentId:t[10]}}),{c(){V(e.$$.fragment)},m(t,s){Z(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.comment=t[8]),e.$set(s)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function he(t){let e,n,o,l,r,u,m,h,b,y,w,k,C,_,I,S,M=t[2].possibleComments,D=[];for(let e=0;e<M.length;e+=1)D[e]=pe(me(t,M,e));const E=t=>W(D[t],1,1,(()=>{D[t]=null}));function U(e){t[6].call(null,e)}let O={};return void 0!==t[0]&&(O.value=t[0]),h=new ie({props:O}),L.push((()=>Y(h,"value",U))),h.$on("keyup",t[3]),h.$on("blur",t[4]),{c(){e=f("table");for(let t=0;t<D.length;t+=1)D[t].c();n=p(),o=f("tr"),l=f("td"),r=f("input"),u=p(),m=f("td"),V(h.$$.fragment),y=p(),w=f("td"),k=p(),C=f("small"),C.textContent="Use the checkboxes to the right to mark off points. To add a new penalty,\n\tenter a comment and the number of points to remove. Changing text or points\n\twill update for all students.",v(r,"type","text"),v(r,"placeholder","Missing name"),v(r,"class","svelte-1at0h8t"),v(l,"class","comment svelte-1at0h8t"),v(e,"class","svelte-1at0h8t"),v(C,"class","svelte-1at0h8t")},m(s,a){i(s,e,a);for(let t=0;t<D.length;t+=1)D[t].m(e,null);c(e,n),c(e,o),c(o,l),c(l,r),x(r,t[1]),c(o,u),c(o,m),Z(h,m,null),c(o,y),c(o,w),i(s,k,a),i(s,C,a),_=!0,I||(S=[g(r,"input",t[5]),g(r,"keyup",$(t[3])),g(r,"blur",t[4])],I=!0)},p(t,[s]){if(4&s){let o;for(M=t[2].possibleComments,o=0;o<M.length;o+=1){const l=me(t,M,o);D[o]?(D[o].p(l,s),G(D[o],1)):(D[o]=pe(l),D[o].c(),G(D[o],1),D[o].m(e,n))}for(z(),o=M.length;o<D.length;o+=1)E(o);B()}2&s&&r.value!==t[1]&&x(r,t[1]);const o={};!b&&1&s&&(b=!0,o.value=t[0],R((()=>b=!1))),h.$set(o)},i(t){if(!_){for(let t=0;t<M.length;t+=1)G(D[t]);G(h.$$.fragment,t),_=!0}},o(t){D=D.filter(Boolean);for(let t=0;t<D.length;t+=1)W(D[t]);W(h.$$.fragment,t),_=!1},d(t){t&&a(e),d(D,t),K(h),t&&a(k),t&&a(C),I=!1,s(S)}}}function ge(t,e,n){let s,o;r(t,lt,(t=>n(2,s=t))),r(t,rt,(t=>n(7,o=t)));let l="",c="";function i(){if(l&&c){let t=s.possibleComments.map((t=>t.text)).indexOf(c);-1===t?(t=s.possibleComments.length,u(lt,s.possibleComments=[...s.possibleComments,{text:c,points:parseInt(l,10)}],s)):u(lt,s.possibleComments[t].points=parseInt(l,10),s),o.commentIds.includes(t)||u(rt,o.commentIds=[...o.commentIds,t],o),n(0,l=n(1,c=""))}}return[l,c,s,function(t){"Enter"==t.code&&i()},i,function(){c=this.value,n(1,c)},function(t){l=t,n(0,l)}]}class $e extends tt{constructor(t){super(),X(this,t,ge,he,l,{})}}function ve(t,e,n){const s=t.slice();return s[8]=e[n],s}function be(t){let e;return{c(){e=f("tr"),e.innerHTML="<i>No requests logged</i>"},m(t,n){i(t,e,n)},d(t){t&&a(e)}}}function ye(e){let n;return{c(){n=f("td"),n.innerHTML="<i>unknown</i>"},m(t,e){i(t,n,e)},p:t,d(t){t&&a(n)}}}function xe(t){let e,n,s,o=new Date(t[8].lastModified).toLocaleString()+"",l=t[8].daysLate>0&&we(t);return{c(){e=f("td"),l&&l.c(),n=p(),s=m(o)},m(t,o){i(t,e,o),l&&l.m(e,null),c(e,n),c(e,s)},p(t,r){t[8].daysLate>0?l?l.p(t,r):(l=we(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),2&r&&o!==(o=new Date(t[8].lastModified).toLocaleString()+"")&&y(s,o)},d(t){t&&a(e),l&&l.d()}}}function we(t){let e,n,s=t[8].daysLate+"";return{c(){e=f("div"),n=m(s),v(e,"class","latebadge svelte-1w8y9g0")},m(t,s){i(t,e,s),c(e,n)},p(t,e){2&e&&s!==(s=t[8].daysLate+"")&&y(n,s)},d(t){t&&a(e)}}}function ke(t){let e,n,s,o,l,r,u,d,h,g,$,b=t[8].statusCode+"",x=t[8].displayUrl+"";function w(t,e){return t[8].lastModified?xe:ye}let k=w(t),C=k(t);return{c(){e=f("tr"),n=f("td"),s=m(b),o=p(),C.c(),l=p(),r=f("td"),u=f("a"),d=m(x),$=p(),v(u,"href",h=t[8].url),v(u,"target","_blank"),v(r,"title",g=t[8].url)},m(t,a){i(t,e,a),c(e,n),c(n,s),c(e,o),C.m(e,null),c(e,l),c(e,r),c(r,u),c(u,d),c(e,$)},p(t,n){2&n&&b!==(b=t[8].statusCode+"")&&y(s,b),k===(k=w(t))&&C?C.p(t,n):(C.d(1),C=k(t),C&&(C.c(),C.m(e,l))),2&n&&x!==(x=t[8].displayUrl+"")&&y(d,x),2&n&&h!==(h=t[8].url)&&v(u,"href",h),2&n&&g!==(g=t[8].url)&&v(r,"title",g)},d(t){t&&a(e),C.d()}}}function Ce(e){let n,s,o,l,r,u,h,b,x,w,k,C,I,S,M,D,E=1===e[0]?"day":"days",L=e[1],U=[];for(let t=0;t<L.length;t+=1)U[t]=ke(ve(e,L,t));let O=null;return L.length||(O=be()),{c(){n=f("div"),s=f("div"),o=m("Most recent change made "),l=m(e[0]),r=p(),u=m(E),h=m(" late."),b=p(),x=f("a"),x.textContent="Clear",w=p(),k=f("div"),C=f("table");for(let t=0;t<U.length;t+=1)U[t].c();O&&O.c(),I=p(),S=f("div"),v(s,"class","svelte-1w8y9g0"),v(x,"href","#clear"),v(x,"class","svelte-1w8y9g0"),v(n,"class","summary svelte-1w8y9g0"),_(n,"late",e[0]>0),v(C,"class","svelte-1w8y9g0"),v(S,"class","fade svelte-1w8y9g0"),v(k,"class","wrap svelte-1w8y9g0")},m(t,a){i(t,n,a),c(n,s),c(s,o),c(s,l),c(s,r),c(s,u),c(s,h),c(n,b),c(n,x),i(t,w,a),i(t,k,a),c(k,C);for(let t=0;t<U.length;t+=1)U[t].m(C,null);O&&O.m(C,null),c(k,I),c(k,S),M||(D=g(x,"click",$(e[2])),M=!0)},p(t,[e]){if(1&e&&y(l,t[0]),1&e&&E!==(E=1===t[0]?"day":"days")&&y(u,E),1&e&&_(n,"late",t[0]>0),2&e){let n;for(L=t[1],n=0;n<L.length;n+=1){const s=ve(t,L,n);U[n]?U[n].p(s,e):(U[n]=ke(s),U[n].c(),U[n].m(C,null))}for(;n<U.length;n+=1)U[n].d(1);U.length=L.length,L.length?O&&(O.d(1),O=null):O||(O=be(),O.c(),O.m(C,null))}},i:t,o:t,d(t){t&&a(n),t&&a(w),t&&a(k),d(U,t),O&&O.d(),M=!1,D()}}}function _e(t,e){const n=(e-new Date(t).getTime())/1e3,s=-Math.floor(Math.min(0,n/60/60/24));return s>0?s:0}function Ie(t,e,n){let s,o,l,c,i,a;r(t,lt,(t=>n(4,l=t))),r(t,ct,(t=>n(5,c=t))),r(t,it,(t=>n(6,i=t))),r(t,rt,(t=>n(7,a=t)));let d=0;return t.$$.update=()=>{if(16&t.$$.dirty&&n(3,s=new Date(l.dueDate+" 23:59:59").getTime()),232&t.$$.dirty&&n(1,o=c.map((t=>{return Object.assign(Object.assign({},t),{lastModified:(e=i,n=t.url,e[n=n.split("?")[0]]||e[n+"index.html"]||e[n+"index.htm"]||e[n+"index.php"]),displayUrl:t.url.split(a.username)[1]||t.url});var e,n})).map((t=>Object.assign(Object.assign({},t),{daysLate:_e(t.lastModified,s)})))),11&t.$$.dirty){const t=o.filter((t=>!!t.lastModified)).map((t=>_e(t.lastModified,s)));n(0,d=Math.max(...t)),n(0,d=isFinite(d)?d:0)}},[d,o,function(){u(ct,c=[],c)},s,l,c,i,a]}class Se extends tt{constructor(t){super(),X(this,t,Ie,Ce,l,{})}}function Me(t,e,n){const s=t.slice();return s[6]=e[n],s}function De(t){let e,n,s,o=_t(Ue(t[6],t[1]).commentIds,t[1].possibleComments)+"";return{c(){e=m("("),n=m(o),s=m("%)")},m(t,o){i(t,e,o),i(t,n,o),i(t,s,o)},p(t,e){6&e&&o!==(o=_t(Ue(t[6],t[1]).commentIds,t[1].possibleComments)+"")&&y(n,o)},d(t){t&&a(e),t&&a(n),t&&a(s)}}}function Ee(t){let e,n,s,o,l,r=t[6].username+"",u=Ue(t[6],t[1]),d=u&&De(t);return{c(){e=f("option"),n=m(r),s=p(),d&&d.c(),o=p(),e.__value=l=t[6].username,e.value=e.__value},m(t,l){i(t,e,l),c(e,n),c(e,s),d&&d.m(e,null),c(e,o)},p(t,s){4&s&&r!==(r=t[6].username+"")&&y(n,r),6&s&&(u=Ue(t[6],t[1])),u?d?d.p(t,s):(d=De(t),d.c(),d.m(e,o)):d&&(d.d(1),d=null),4&s&&l!==(l=t[6].username)&&(e.__value=l,e.value=e.__value)},d(t){t&&a(e),d&&d.d()}}}function Le(e){let n,o,l,r,u,m,h=e[2].students,$=[];for(let t=0;t<h.length;t+=1)$[t]=Ee(Me(e,h,t));return{c(){n=f("div"),o=f("select");for(let t=0;t<$.length;t+=1)$[t].c();l=p(),r=f("button"),r.textContent="Discard current and jump",v(o,"class","svelte-2269uq"),void 0===e[0]&&T((()=>e[4].call(o))),v(n,"class","svelte-2269uq")},m(t,s){i(t,n,s),c(n,o);for(let t=0;t<$.length;t+=1)$[t].m(o,null);k(o,e[0]),c(n,l),c(n,r),u||(m=[g(o,"change",e[4]),g(r,"click",e[3])],u=!0)},p(t,[e]){if(6&e){let n;for(h=t[2].students,n=0;n<h.length;n+=1){const s=Me(t,h,n);$[n]?$[n].p(s,e):($[n]=Ee(s),$[n].c(),$[n].m(o,null))}for(;n<$.length;n+=1)$[n].d(1);$.length=h.length}5&e&&k(o,t[0])},i:t,o:t,d(t){t&&a(n),d($,t),u=!1,s(m)}}}function Ue(t,e){return e.students.find((e=>e.username===t.username))}function Oe(t,e,n){let s,o,l;r(t,rt,(t=>n(5,s=t))),r(t,lt,(t=>n(1,o=t))),r(t,ot,(t=>n(2,l=t)));let c=s.username;return[c,o,l,function(){const t=Ue(c,o);t?(u(rt,s=t,s),u(lt,o.students=o.students.filter((t=>t.username!==c)),o)):u(rt,s={username:c,commentIds:[]},s)},function(){c=C(this),n(0,c)}]}class Ne extends tt{constructor(t){super(),X(this,t,Oe,Le,l,{})}}function je(t){let e,n,s;return{c(){e=m("Mark as "),n=m(t[3]),s=m("% and continue")},m(t,o){i(t,e,o),i(t,n,o),i(t,s,o)},p(t,e){8&e&&y(n,t[3])},d(t){t&&a(e),t&&a(n),t&&a(s)}}}function Te(e){let n;return{c(){n=m("Mark as perfect and continue")},m(t,e){i(t,n,e)},p:t,d(t){t&&a(n)}}}function Re(t){let e,n,o,l,r,u,d,h,$,b,k,C,_,I,S,M,D,E,U,O,N,j,T,H,P,q,A,F,J,z,B,Q,X,tt,et,nt,st,ot,lt,rt,ut=t[1].number+"",ct=t[0].username+"";function it(t,e){return 100===t[3]?Te:je}H=new $e({});let at=it(t),dt=at(t);function ft(e){t[12].call(null,e)}F=new Ne({}),z=new Se({});let mt={embeddedUrl:t[4]};return void 0!==t[2]&&(mt.iframeRef=t[2]),X=new re({props:mt}),L.push((()=>Y(X,"iframeRef",ft))),{c(){e=f("div"),n=f("div"),o=f("h1"),l=m("Grading homework "),r=m(ut),u=p(),d=f("div"),h=f("div"),$=m("Due "),b=f("input"),k=p(),C=f("button"),C.textContent="Discard all progress",_=p(),I=f("h2"),S=f("div"),M=f("code"),D=m(ct),E=m("\n\t\t\t\t("),U=m(t[3]),O=m("%)"),N=p(),j=f("button"),j.textContent="Reset and regrade",T=p(),V(H.$$.fragment),P=p(),q=f("button"),dt.c(),A=p(),V(F.$$.fragment),J=p(),V(z.$$.fragment),B=p(),Q=f("div"),V(X.$$.fragment),et=p(),nt=f("div"),st=f("div"),v(o,"class","svelte-1r850lh"),v(b,"type","date"),v(h,"class","svelte-1r850lh"),v(d,"class","split svelte-1r850lh"),v(S,"class","svelte-1r850lh"),v(I,"class","split svelte-1r850lh"),v(q,"class","next svelte-1r850lh"),v(n,"class","sidebar svelte-1r850lh"),v(Q,"class","browser svelte-1r850lh"),v(e,"class","wrapper svelte-1r850lh"),w(st,"width",100*t[5]+"%"),v(st,"class","svelte-1r850lh"),v(nt,"class","progress svelte-1r850lh")},m(s,a){i(s,e,a),c(e,n),c(n,o),c(o,l),c(o,r),c(n,u),c(n,d),c(d,h),c(h,$),c(h,b),x(b,t[1].dueDate),c(d,k),c(d,C),c(n,_),c(n,I),c(I,S),c(S,M),c(M,D),c(S,E),c(S,U),c(S,O),c(I,N),c(I,j),c(n,T),Z(H,n,null),c(n,P),c(n,q),dt.m(q,null),c(n,A),Z(F,n,null),c(n,J),Z(z,n,null),c(e,B),c(e,Q),Z(X,Q,null),i(s,et,a),i(s,nt,a),c(nt,st),ot=!0,lt||(rt=[g(b,"input",t[11]),g(C,"click",t[8]),g(j,"click",t[7]),g(q,"click",t[6])],lt=!0)},p(t,[e]){(!ot||2&e)&&ut!==(ut=t[1].number+"")&&y(r,ut),2&e&&x(b,t[1].dueDate),(!ot||1&e)&&ct!==(ct=t[0].username+"")&&y(D,ct),(!ot||8&e)&&y(U,t[3]),at===(at=it(t))&&dt?dt.p(t,e):(dt.d(1),dt=at(t),dt&&(dt.c(),dt.m(q,null)));const n={};16&e&&(n.embeddedUrl=t[4]),!tt&&4&e&&(tt=!0,n.iframeRef=t[2],R((()=>tt=!1))),X.$set(n),(!ot||32&e)&&w(st,"width",100*t[5]+"%")},i(t){ot||(G(H.$$.fragment,t),G(F.$$.fragment,t),G(z.$$.fragment,t),G(X.$$.fragment,t),ot=!0)},o(t){W(H.$$.fragment,t),W(F.$$.fragment,t),W(z.$$.fragment,t),W(X.$$.fragment,t),ot=!1},d(t){t&&a(e),K(H),dt.d(),K(F),K(z),K(X),t&&a(et),t&&a(nt),lt=!1,s(rt)}}}function He(t,e,n){let s,o,l,c,i,a,d,f,m;r(t,rt,(t=>n(0,c=t))),r(t,lt,(t=>n(1,i=t))),r(t,ot,(t=>n(10,a=t))),r(t,ct,(t=>n(13,d=t))),r(t,it,(t=>n(14,f=t))),r(t,at,(t=>n(15,m=t)));let p,h=c.username;return t.$$.update=()=>{3&t.$$.dirty&&n(3,s=_t(c.commentIds,i.possibleComments)),3&t.$$.dirty&&n(4,o=`${i.prefix}/${c.username}/`),1026&t.$$.dirty&&n(5,l=i.students.length/(a.students.length+1)),513&t.$$.dirty&&h!==c.username&&(n(9,h=c.username),u(ct,d=[],d),u(it,f={},f))},[c,i,p,s,o,l,function(){St({type:"clear-cookies"}),u(lt,i.students=[...i.students,c],i),mt()},function(){St({type:"clear-cookies",value:m}),u(lt,i.students=i.students.filter((t=>t.username!==c.username)),i),u(rt,c.commentIds=[],c),u(ct,d=[],d),n(2,p.src=o,p)},function(){u(lt,i=null,i),u(rt,c=null,c)},h,a,function(){i.dueDate=this.value,lt.set(i)},function(t){p=t,n(2,p)}]}class Pe extends tt{constructor(t){super(),X(this,t,He,Re,l,{})}}function qe(t,e,n){let s,o,l,c,i;r(t,dt,(t=>n(0,s=t))),r(t,ct,(t=>n(1,o=t))),r(t,at,(t=>n(2,l=t))),r(t,it,(t=>n(3,c=t))),r(t,ot,(t=>n(4,i=t)));const a=document.getElementById("comms"),d=new MutationObserver((t=>{function e(e){return!!t.find((t=>t.attributeName==="data-"+e))}if(e("deactivated"))u(dt,s=!1,s);else if(e("activated"))u(dt,s=!0,s);else if(e("newest-request")){const t=JSON.parse(a.dataset.newestRequest);u(ct,o=[t,...o],o)}else if(e("embedded-url")){const t=l;if(u(at,l=JSON.parse(a.dataset.embeddedUrl),l),Mt(t)!==Mt(l)){const t=l.substring(0,l.lastIndexOf("/"));u(it,c={},c),function(t,e,n){const s=new URLSearchParams;return s.append("token",n.token),s.append("ls","yes"),s.append("url",t),fetch(n.endpoint,{method:"post",body:s}).then((t=>t.json())).then((t=>t.result.split("\n").map((t=>t.split(" "))).map((([t,n])=>({name:e+n.replace("./","/"),time:new Date(1e3*parseFloat(t))})))))}(l,t,i).then((t=>{t.forEach((({name:t,time:e})=>{u(it,c[t]=e,c)})),it.set(c)})).catch((t=>{}))}}}));return d.observe(a,{attributes:!0}),M((()=>{d.disconnect()})),[]}class Ae extends tt{constructor(t){super(),X(this,t,qe,null,l,{})}}function Fe(e){let n,s,o,l,r,u,c,d;return{c(){n=f("h1"),n.textContent="Install extension",s=m("\n\nInstall the companion browser extension for\n"),o=f("a"),o.textContent="Firefox",l=m("\nor\n"),r=f("a"),r.textContent="Chrome",u=m("\nand\n\n"),c=f("a"),c.textContent="refresh",d=m("."),v(o,"href","https://github.com/jaflo/gradable/releases/latest/download/firefox-extension.xpi"),v(r,"href","https://chrome.google.com/webstore/detail/njijmdbjijgeodnhcnkknkeopbhfgpbg"),v(r,"target","_blank"),v(c,"href","")},m(t,e){i(t,n,e),i(t,s,e),i(t,o,e),i(t,l,e),i(t,r,e),i(t,u,e),i(t,c,e),i(t,d,e)},p:t,i:t,o:t,d(t){t&&a(n),t&&a(s),t&&a(o),t&&a(l),t&&a(r),t&&a(u),t&&a(c),t&&a(d)}}}class Je extends tt{constructor(t){super(),X(this,t,null,Fe,l,{})}}function ze(e){let n;return{c(){n=m("Checking for plugin...")},m(t,e){i(t,n,e)},p:t,i:t,o:t,d(t){t&&a(n)}}}function Be(e){let n,s;return n=new Je({}),{c(){V(n.$$.fragment)},m(t,e){Z(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){K(n,t)}}}function Ge(t){let e,n,s,o;const l=[Ve,Ye,We],r=[];function u(t,e){return null===t[3]?0:t[4]?1:2}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=h()},m(t,n){r[e].m(t,n),i(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e===c?r[e].p(t,o):(z(),W(r[c],1,1,(()=>{r[c]=null})),B(),n=r[e],n?n.p(t,o):(n=r[e]=l[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){r[e].d(t),t&&a(s)}}}function We(e){let n,s,o;return{c(){n=m("Plugin disconnected, did you open this website in another tab? Try\n\t\t"),s=f("a"),s.textContent="refreshing",o=m(" to retry."),v(s,"href","")},m(t,e){i(t,n,e),i(t,s,e),i(t,o,e)},p:t,i:t,o:t,d(t){t&&a(n),t&&a(s),t&&a(o)}}}function Ye(t){let e,n,s,o;const l=[Ke,Ze],r=[];function u(t,e){return null!==t[0]?0:1}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=h()},m(t,n){r[e].m(t,n),i(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e===c?r[e].p(t,o):(z(),W(r[c],1,1,(()=>{r[c]=null})),B(),n=r[e],n?n.p(t,o):(n=r[e]=l[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){r[e].d(t),t&&a(s)}}}function Ve(e){let n,s;return n=new Vt({}),{c(){V(n.$$.fragment)},m(t,e){Z(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){K(n,t)}}}function Ze(e){let n,s;return n=new zt({}),{c(){V(n.$$.fragment)},m(t,e){Z(n,t,e),s=!0},p:t,i(t){s||(G(n.$$.fragment,t),s=!0)},o(t){W(n.$$.fragment,t),s=!1},d(t){K(n,t)}}}function Ke(t){let e,n,s,o;const l=[Xe,Qe],r=[];function u(t,e){return null!==t[5]?0:1}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=h()},m(t,n){r[e].m(t,n),i(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e!==c&&(z(),W(r[c],1,1,(()=>{r[c]=null})),B(),n=r[e],n||(n=r[e]=l[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){o||(G(n),o=!0)},o(t){W(n),o=!1},d(t){r[e].d(t),t&&a(s)}}}function Qe(t){let e,n;return e=new se({}),{c(){V(e.$$.fragment)},m(t,s){Z(e,t,s),n=!0},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Xe(t){let e,n;return e=new Pe({}),{c(){V(e.$$.fragment)},m(t,s){Z(e,t,s),n=!0},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function tn(t){let e,n,s,o,l;const r=[Ge,Be,ze],u=[];function c(t,e){return t[1]?0:t[2]?1:2}return e=c(t),n=u[e]=r[e](t),o=new Ae({}),{c(){n.c(),s=p(),V(o.$$.fragment)},m(t,n){u[e].m(t,n),i(t,s,n),Z(o,t,n),l=!0},p(t,[o]){let l=e;e=c(t),e===l?u[e].p(t,o):(z(),W(u[l],1,1,(()=>{u[l]=null})),B(),n=u[e],n?n.p(t,o):(n=u[e]=r[e](t),n.c()),G(n,1),n.m(s.parentNode,s))},i(t){l||(G(n),G(o.$$.fragment,t),l=!0)},o(t){W(n),W(o.$$.fragment,t),l=!1},d(t){u[e].d(t),t&&a(s),K(o,t)}}}const en="gradable-plugin-present";function nn(t,e,n){let s,o,l,u;r(t,lt,(t=>n(0,s=t))),r(t,ot,(t=>n(3,o=t))),r(t,dt,(t=>n(4,l=t))),r(t,rt,(t=>n(5,u=t)));let c=document.body.classList.contains(en),i=!1;function a(){d(),St({type:"register-active"})}function d(){s&&St({type:"set-homework-number",value:s.number})}return setTimeout((()=>n(2,i=!0)),400),new MutationObserver(((t,e)=>{t.find((t=>"class"===t.attributeName))&&document.body.classList.contains(en)&&(n(1,c=!0),e.disconnect(),a())})).observe(document.body,{attributes:!0}),c&&a(),t.$$.update=()=>{1&t.$$.dirty&&s&&s.number&&d()},[s,c,i,o,l,u]}return new class extends tt{constructor(t){super(),X(this,t,nn,tn,l,{})}}({target:document.body})}();
