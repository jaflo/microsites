var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function s(){return Object.create(null)}function o(t){t.forEach(n)}function l(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function c(t,e,n=e){return t.set(n),e}const i="undefined"!=typeof window;let a=i?()=>window.performance.now():()=>Date.now(),d=i?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&d(p)}function m(t,e){t.appendChild(e)}function h(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function $(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function v(t){return document.createElement(t)}function b(t){return document.createTextNode(t)}function y(){return b(" ")}function w(){return b("")}function k(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function x(t){return function(e){return e.preventDefault(),t.call(this,e)}}function C(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function _(t){return""===t?null:+t}function S(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e){t.value=null==e?"":e}function I(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function D(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}}function j(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function U(t,e,n){t.classList[n?"add":"remove"](e)}const E=new Set;let P,M=0;function N(t,e,n,s,o,l,r,u=0){const c=16.666/s;let i="{\n";for(let t=0;t<=1;t+=c){const s=e+(n-e)*l(t);i+=100*t+`%{${r(s,1-s)}}\n`}const a=i+`100% {${r(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${u}`,f=t.ownerDocument;E.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(v("style")).sheet),m=f.__svelte_rules||(f.__svelte_rules={});m[d]||(m[d]=!0,p.insertRule(`@keyframes ${d} ${a}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?`${h}, `:""}${d} ${s}ms linear ${o}ms 1 both`,M+=1,d}function L(t,e){const n=(t.style.animation||"").split(", "),s=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-s.length;o&&(t.style.animation=s.join(", "),M-=o,M||d((()=>{M||(E.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),E.clear())})))}function T(t){P=t}function R(t){(function(){if(!P)throw new Error("Function called outside component initialization");return P})().$$.on_destroy.push(t)}function q(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t(e)))}const F=[],A=[],z=[],H=[],Y=Promise.resolve();let G=!1;function J(t){z.push(t)}function W(t){H.push(t)}let B=!1;const K=new Set;function V(){if(!B){B=!0;do{for(let t=0;t<F.length;t+=1){const e=F[t];T(e),Z(e.$$)}for(T(null),F.length=0;A.length;)A.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];K.has(e)||(K.add(e),e())}z.length=0}while(F.length);for(;H.length;)H.pop()();G=!1,B=!1,K.clear()}}function Z(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}let Q;function X(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const tt=new Set;let et;function nt(){et={r:0,c:[],p:et}}function st(){et.r||o(et.c),et=et.p}function ot(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function lt(t,e,n,s){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push((()=>{tt.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}const rt={duration:0};function ut(n,s,r,u){let c=s(n,r),i=u?0:1,m=null,h=null,g=null;function $(){g&&L(n,g)}function v(t,e){const n=t.b-i;return e*=Math.abs(n),{a:i,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(s){const{delay:l=0,duration:r=300,easing:u=e,tick:b=t,css:y}=c||rt,w={start:a()+l,b:s};s||(w.group=et,et.r+=1),m||h?h=w:(y&&($(),g=N(n,i,s,r,l,u,y)),s&&b(0,1),m=v(w,r),J((()=>X(n,s,"start"))),function(t){let e;0===f.size&&d(p),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(h&&t>h.start&&(m=v(h,r),h=null,X(n,m.b,"start"),y&&($(),g=N(n,i,m.b,m.duration,0,u,c.css))),m)if(t>=m.end)b(i=m.b,1-i),X(n,m.b,"end"),h||(m.b?$():--m.group.r||o(m.group.c)),m=null;else if(t>=m.start){const e=t-m.start;i=m.a+m.d*u(e/m.duration),b(i,1-i)}return!(!m&&!h)})))}return{run(t){l(c)?(Q||(Q=Promise.resolve(),Q.then((()=>{Q=null}))),Q).then((()=>{c=c(),b(t)})):b(t)},end(){$(),m=h=null}}}function ct(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function it(t){t&&t.c()}function at(t,e,s){const{fragment:r,on_mount:u,on_destroy:c,after_update:i}=t.$$;r&&r.m(e,s),J((()=>{const e=u.map(n).filter(l);c?c.push(...e):o(e),t.$$.on_mount=[]})),i.forEach(J)}function dt(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ft(t,e){-1===t.$$.dirty[0]&&(F.push(t),G||(G=!0,Y.then(V)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function pt(e,n,l,r,u,c,i=[-1]){const a=P;T(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:u,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:s(),dirty:i,skip_bound:!1};let p=!1;if(f.ctx=l?l(e,d,((t,n,...s)=>{const o=s.length?s[0]:n;return f.ctx&&u(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&ft(e,t)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!r&&r(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();n.intro&&ot(e.$$.fragment),at(e,n.target,n.anchor),V()}T(a)}class mt{$destroy(){dt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ht=[];function gt(e,n=t){let s;const o=[];function l(t){if(r(e,t)&&(e=t,s)){const t=!ht.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),ht.push(n,e)}if(t){for(let t=0;t<ht.length;t+=2)ht[t][0](ht[t+1]);ht.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(r,u=t){const c=[r,u];return o.push(c),1===o.length&&(s=n(l)||t),r(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(s(),s=null)}}}}function $t(t,e){const n=localStorage.getItem(t);let s=e||null;n&&(s=JSON.parse(n));const o=gt(s);return o.subscribe((e=>localStorage.setItem(t,JSON.stringify(e)))),o}const vt=$t("config"),bt=$t("homework"),yt=$t("student"),wt=$t("checkpoints",[]),kt=gt([]),xt=gt({}),Ct=gt(""),_t=gt(!1),St=gt({});let Ot=[],It=0;function Dt(t){const e=JSON.parse(localStorage.getItem("config")).students.map((t=>t.username)).filter((e=>!Ot.includes(e)&&e!==t)),n=e.length;return n>0?e[It%n]:null}function jt(){const t=Dt();t?yt.set({username:t,commentIds:[]}):yt.set(null)}function Ut(e){let n,s,l,r,u,c,i,a,d,f,p,$,w,x,_,S,I,j,U,E,P,M,N,L,T,R,q;return{c(){n=v("label"),s=v("span"),s.textContent="Homework number",l=y(),r=v("input"),u=y(),c=v("label"),i=v("span"),i.textContent="Due date (EOD)",a=y(),d=v("input"),f=y(),p=v("div"),$=b("https://"),w=v("select"),x=v("option"),x.textContent="fall",_=v("option"),_.textContent="spring",S=b("-"),I=v("input"),j=b(".cs.utexas.edu/"),U=v("input"),E=b("\n\nThe recommended workflow is as follows:\n\n"),P=v("ol"),P.innerHTML="<li>Wait for the student&#39;s directory to be unlocked (use the refresh button\n\t\tto check)</li> \n\t<li>Grade the student shown (chosen randomly)</li> \n\t<li>Click the next student button to load the next student randomly\n\t\t<ul><li>This should load faster because gradable already unlocked the\n\t\t\t\tfolder in the background</li> \n\t\t\t<li>Sometimes stuff goes wrong, click the ‚ùå in the top right to see\n\t\t\t\twhat happened</li></ul></li> \n\t<li>Once you are done, you will get a table of students, copy everything\n\t\tinto Canvas</li> \n\t<li>You&#39;re done!</li>",M=y(),N=v("button"),L=b("Start grading"),C(r,"type","text"),C(r,"placeholder","1"),C(r,"class","short svelte-1re6vz0"),C(d,"type","date"),C(d,"class","date"),x.__value="fall",x.value=x.__value,_.__value="spring",_.value=_.__value,void 0===e[0]&&J((()=>e[8].call(w))),C(I,"type","text"),C(I,"class","short svelte-1re6vz0"),C(U,"type","text"),U.readOnly=!0,C(p,"class","prefix svelte-1re6vz0"),N.disabled=T=!e[3]||!e[4]||!e[2]},m(t,o){h(t,n,o),m(n,s),m(n,l),m(n,r),O(r,e[3]),h(t,u,o),h(t,c,o),m(c,i),m(c,a),m(c,d),O(d,e[4]),h(t,f,o),h(t,p,o),m(p,$),m(p,w),m(w,x),m(w,_),D(w,e[0]),m(p,S),m(p,I),O(I,e[1]),m(p,j),m(p,U),O(U,e[2]),h(t,E,o),h(t,P,o),h(t,M,o),h(t,N,o),m(N,L),R||(q=[k(r,"input",e[6]),k(d,"input",e[7]),k(w,"change",e[8]),k(I,"input",e[9]),k(U,"input",e[10]),k(N,"click",e[5])],R=!0)},p(t,[e]){8&e&&r.value!==t[3]&&O(r,t[3]),16&e&&O(d,t[4]),1&e&&D(w,t[0]),2&e&&I.value!==t[1]&&O(I,t[1]),4&e&&U.value!==t[2]&&O(U,t[2]),28&e&&T!==(T=!t[3]||!t[4]||!t[2])&&(N.disabled=T)},i:t,o:t,d(t){t&&g(n),t&&g(u),t&&g(c),t&&g(f),t&&g(p),t&&g(E),t&&g(P),t&&g(M),t&&g(N),R=!1,o(q)}}}function Et(t,e,n){let s,o,l,r;u(t,bt,(t=>n(12,o=t))),u(t,kt,(t=>n(13,l=t))),u(t,xt,(t=>n(14,r=t)));let i="",a="";const d=new Date;let f=d.getMonth()<6?"spring":"fall",p=d.getFullYear(),m="cs329e-bulko";return t.$$.update=()=>{7&t.$$.dirty&&(s=`https://${f}-${p}.cs.utexas.edu/${m}`)},[f,p,m,i,a,function(){c(bt,o={number:parseInt(i),dueDate:a,students:[],possibleComments:[{text:"One day late",points:10},{text:"Two days late",points:20},{text:"No submission",points:100}],prefix:s},o),c(kt,l=[],l),c(xt,r={},r),jt()},function(){i=this.value,n(3,i)},function(){a=this.value,n(4,a)},function(){f=j(this),n(0,f)},function(){p=this.value,n(1,p)},function(){m=this.value,n(2,m)}]}bt.subscribe((t=>{Ot=(null==t?void 0:t.students.map((t=>t.username)))||[],It=function(t){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),(e^e>>>14)>>>0}(null==t?void 0:t.number)}));class Pt extends mt{constructor(t){super(),pt(this,t,Et,Ut,r,{})}}var Mt=["second","minute","hour","day","week","month","year"];var Nt=["Áßí","ÂàÜÈíü","Â∞èÊó∂","Â§©","Âë®","‰∏™Êúà","Âπ¥"];var Lt={},Tt=function(t,e){Lt[t]=e},Rt=[60,60,24,7,365/7/12,12];function qt(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}var Ft=function(t,e,n){return function(t,e){for(var n=t<0?1:0,s=t=Math.abs(t),o=0;t>=Rt[o]&&o<Rt.length;o++)t/=Rt[o];return(t=Math.floor(t))>(0==(o*=2)?9:1)&&(o+=1),e(t,o,s)[n].replace("%s",t.toString())}(function(t,e){return(+(e?qt(e):new Date)-+qt(t))/1e3}(t,n&&n.relativeDate),function(t){return Lt[t]||Lt.en_US}(e))};function At(t){return Ft(new Date(t))}function zt(t,e){let n=100;for(const s of t)n-=e[s].points;return n}Tt("en_US",(function(t,e){if(0===e)return["just now","right now"];var n=Mt[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]})),Tt("zh_CN",(function(t,e){if(0===e)return["ÂàöÂàö","ÁâáÂàªÂêé"];var n=Nt[~~(e/2)];return[t+" "+n+"Ââç",t+" "+n+"Âêé"]}));const Ht=document.getElementById("comms");function Yt(t){Ht.dataset.tellExtension=JSON.stringify(t)}function Gt(t){return t.split("/")[5]}function Jt(t){const[e,n]=t.split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase())).join(" ").split(";").map((t=>t.trim()));return{first:n,last:e}}function Wt(t){t.target.select()}function Bt(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function Kt(t){let e,n,s,o,l,r=t[9].label+"",u=At(t[9].lastChange)+"";return{c(){e=v("option"),n=b(r),s=b(", saved "),o=b(u),l=y(),e.__value=t[11],e.value=e.__value},m(t,r){h(t,e,r),m(e,n),m(e,s),m(e,o),m(e,l)},p(t,e){2&e&&r!==(r=t[9].label+"")&&S(n,r),2&e&&u!==(u=At(t[9].lastChange)+"")&&S(o,u)},d(t){t&&g(e)}}}function Vt(e){let n,s,l,r,u,c=e[1],i=[];for(let t=0;t<c.length;t+=1)i[t]=Kt(Bt(e,c,t));return{c(){n=v("select");for(let t=0;t<i.length;t+=1)i[t].c();s=y(),l=v("button"),l.textContent="Restore from save",void 0===e[0]&&J((()=>e[4].call(n)))},m(t,o){h(t,n,o);for(let t=0;t<i.length;t+=1)i[t].m(n,null);D(n,e[0]),h(t,s,o),h(t,l,o),r||(u=[k(n,"change",e[4]),k(l,"click",e[2])],r=!0)},p(t,[e]){if(2&e){let s;for(c=t[1],s=0;s<c.length;s+=1){const o=Bt(t,c,s);i[s]?i[s].p(o,e):(i[s]=Kt(o),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=c.length}1&e&&D(n,t[0])},i:t,o:t,d(t){t&&g(n),$(i,t),t&&g(s),t&&g(l),r=!1,o(u)}}}function Zt(t,e,n){let s,o,l,r,i,a;u(t,wt,(t=>n(3,o=t))),u(t,kt,(t=>n(5,l=t))),u(t,xt,(t=>n(6,r=t))),u(t,bt,(t=>n(7,i=t))),u(t,yt,(t=>n(8,a=t)));let d=0;return t.$$.update=()=>{8&t.$$.dirty&&n(1,s=(null==o?void 0:o.sort(((t,e)=>e.lastChange-t.lastChange)))||[])},[d,s,function(){c(kt,l=[],l),c(xt,r={},r);const t=o[d];c(bt,i=t.homework,i),c(yt,a=t.currentStudent,a),o.splice(d,1),wt.set(o)},o,function(){d=j(this),n(0,d)}]}class Qt extends mt{constructor(t){super(),pt(this,t,Zt,Vt,r,{})}}const Xt=document.location.href,te=`cd ~/public_html && wget -O gradable.php "${Xt}server/gradable.php" && chmod 755 gradable.php`;function ee(t,e,n){return se(!0,e,t,n)}function ne(t,e,n){return se(!1,e,t,n)}function se(t,e,n,s){var o;const l=null===(o=s.students.find((t=>t.username===e)))||void 0===o?void 0:o.password;if(!l)throw new Error("Unknown student");if("UNKNOWN"===l)throw new Error("Unknown password");const r=new URLSearchParams;return r.append("token",s.token),r.append("lock",t?"yes":"no"),r.append("url",n),r.append("user",e),r.append("pass",l),fetch(s.endpoint,{method:"post",body:r}).then((t=>t.json()))}function oe(t,e,n){const s=t.slice();return s[5]=e[n],s}function le(t){let e,n,s,o,l,r,u,c,i,a,d,f,p,w,x,_,S,O=t[0],I=[];for(let e=0;e<O.length;e+=1)I[e]=re(oe(t,O,e));return{c(){e=v("table"),n=v("thead"),s=v("tr"),o=v("td"),o.textContent="last",l=y(),r=v("td"),r.textContent="first",u=y(),c=v("td"),c.textContent="username",i=y(),a=v("td"),d=v("label"),f=b("password\n\t\t\t\t\t\t\t"),p=v("input"),w=y(),x=v("tbody");for(let t=0;t<I.length;t+=1)I[t].c();C(p,"type","checkbox"),C(e,"class","svelte-5fmq9n")},m(g,$){h(g,e,$),m(e,n),m(n,s),m(s,o),m(s,l),m(s,r),m(s,u),m(s,c),m(s,i),m(s,a),m(a,d),m(d,f),m(d,p),p.checked=t[1],m(e,w),m(e,x);for(let t=0;t<I.length;t+=1)I[t].m(x,null);_||(S=k(p,"change",t[4]),_=!0)},p(t,e){if(2&e&&(p.checked=t[1]),3&e){let n;for(O=t[0],n=0;n<O.length;n+=1){const s=oe(t,O,n);I[n]?I[n].p(s,e):(I[n]=re(s),I[n].c(),I[n].m(x,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=O.length}},d(t){t&&g(e),$(I,t),_=!1,S()}}}function re(t){let e,n,s,o,l,r,u,c,i,a,d,f,p,$=Jt(t[5].realname).last+"",w=Jt(t[5].realname).first+"",k=t[5].username+"",x=(t[1]?t[5].password:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢")+"";return{c(){e=v("tr"),n=v("td"),s=b($),o=y(),l=v("td"),r=b(w),u=y(),c=v("td"),i=b(k),a=y(),d=v("td"),f=b(x),p=y()},m(t,g){h(t,e,g),m(e,n),m(n,s),m(e,o),m(e,l),m(l,r),m(e,u),m(e,c),m(c,i),m(e,a),m(e,d),m(d,f),m(e,p)},p(t,e){1&e&&$!==($=Jt(t[5].realname).last+"")&&S(s,$),1&e&&w!==(w=Jt(t[5].realname).first+"")&&S(r,w),1&e&&k!==(k=t[5].username+"")&&S(i,k),3&e&&x!==(x=(t[1]?t[5].password:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢")+"")&&S(f,x)},d(t){t&&g(e)}}}function ue(e){let n,s,o,l,r,u,c,i,a,d,f,p,$=e[0].length+"",w=1===e[0].length?"student":"students",x=e[0].length>0&&le(e);return{c(){n=v("label"),s=v("h2"),o=b($),l=y(),r=b(w),u=y(),c=v("p"),c.textContent="Each row should have the name, username, and password separated by a\n\t\ttab.",i=y(),a=v("textarea"),d=y(),x&&x.c(),C(a,"rows","1"),C(a,"class","svelte-5fmq9n")},m(t,g){h(t,n,g),m(n,s),m(s,o),m(s,l),m(s,r),m(n,u),m(n,c),m(n,i),m(n,a),O(a,e[2]),m(n,d),x&&x.m(n,null),f||(p=k(a,"input",e[3]),f=!0)},p(t,[e]){1&e&&$!==($=t[0].length+"")&&S(o,$),1&e&&w!==(w=1===t[0].length?"student":"students")&&S(r,w),4&e&&O(a,t[2]),t[0].length>0?x?x.p(t,e):(x=le(t),x.c(),x.m(n,null)):x&&(x.d(1),x=null)},i:t,o:t,d(t){t&&g(n),x&&x.d(),f=!1,p()}}}function ce(t,e,n){let{students:s=[]}=e,{showPasswords:o=!1}=e,l=function(t){return t.map((t=>`${t.realname}\t${t.username}\t${t.password}`)).join("\n")}(s);return t.$$set=t=>{"students"in t&&n(0,s=t.students),"showPasswords"in t&&n(1,o=t.showPasswords)},t.$$.update=()=>{4&t.$$.dirty&&n(0,s=l.split("\n").filter((t=>!!t)).map((t=>t.split("\t"))).map((([t,e,n])=>({realname:t,username:e,password:n,canvasId:""}))))},[s,o,l,function(){l=this.value,n(2,l)},function(){o=this.checked,n(1,o)}]}class ie extends mt{constructor(t){super(),pt(this,t,ce,ue,r,{students:0,showPasswords:1})}}function ae(t){confirm("You are about to DELETE EVERYTHING, including your authentication token and "+t+" checkpoints. Make sure to delete the server config if you do not have a backup of the token. Are you sure you want to continue?")&&(localStorage.clear(),window.location=window.location)}function de(t){let e,n,s,o;return s=new Qt({}),{c(){e=v("h1"),e.textContent="Load previous session",n=y(),it(s.$$.fragment),C(e,"class","svelte-tylxsl")},m(t,l){h(t,e,l),h(t,n,l),at(s,t,l),o=!0},i(t){o||(ot(s.$$.fragment,t),o=!0)},o(t){lt(s.$$.fragment,t),o=!1},d(t){t&&g(e),t&&g(n),dt(s,t)}}}function fe(t){let e,n,s,l,r,u,c,i,a,d,f,p,m,$,w,x,_,O,I,D,j,U,E=t[0].endpoint+"";s=new Pt({});let P=null!==t[1]&&t[1].length>0&&de();function M(e){t[4].call(null,e)}let N={};return void 0!==t[0].students&&(N.students=t[0].students),p=new ie({props:N}),A.push((()=>ct(p,"students",M))),{c(){e=v("h1"),e.textContent="Grade new homework",n=y(),it(s.$$.fragment),l=y(),P&&P.c(),r=y(),u=v("h1"),u.textContent="Configuration",c=y(),i=v("h2"),i.textContent="UT CS server endpoint",a=y(),d=b(E),f=y(),it(p.$$.fragment),$=y(),w=v("h2"),w.textContent="Reset",x=y(),_=v("button"),_.textContent="Delete local config and set up again",O=y(),I=v("button"),I.textContent="Reset server configuration",C(e,"class","svelte-tylxsl"),C(u,"class","svelte-tylxsl")},m(o,m){h(o,e,m),h(o,n,m),at(s,o,m),h(o,l,m),P&&P.m(o,m),h(o,r,m),h(o,u,m),h(o,c,m),h(o,i,m),h(o,a,m),h(o,d,m),h(o,f,m),at(p,o,m),h(o,$,m),h(o,w,m),h(o,x,m),h(o,_,m),h(o,O,m),h(o,I,m),D=!0,j||(U=[k(_,"click",t[3]),k(I,"click",t[2])],j=!0)},p(t,[e]){null!==t[1]&&t[1].length>0?P?2&e&&ot(P,1):(P=de(),P.c(),ot(P,1),P.m(r.parentNode,r)):P&&(nt(),lt(P,1,1,(()=>{P=null})),st()),(!D||1&e)&&E!==(E=t[0].endpoint+"")&&S(d,E);const n={};!m&&1&e&&(m=!0,n.students=t[0].students,W((()=>m=!1))),p.$set(n)},i(t){D||(ot(s.$$.fragment,t),ot(P),ot(p.$$.fragment,t),D=!0)},o(t){lt(s.$$.fragment,t),lt(P),lt(p.$$.fragment,t),D=!1},d(t){t&&g(e),t&&g(n),dt(s,t),t&&g(l),P&&P.d(t),t&&g(r),t&&g(u),t&&g(c),t&&g(i),t&&g(a),t&&g(d),t&&g(f),dt(p,t),t&&g($),t&&g(w),t&&g(x),t&&g(_),t&&g(O),t&&g(I),j=!1,o(U)}}}function pe(t,e,n){let s,o;return u(t,vt,(t=>n(0,s=t))),u(t,wt,(t=>n(1,o=t))),[s,o,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("remove","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(s).then((({success:t})=>{t?alert("Server reset, you still need to delete gradable.php"):alert("Failed, could not reset")}))},function(){ae(o.length)},function(t){s.students=t,vt.set(s)}]}class me extends mt{constructor(t){super(),pt(this,t,pe,fe,r,{})}}function he(t){let e,n,s,l,r,u,c,i,a,d,f,p,$,w,x,_,S,I,D,j,U,E,P,M,N,L,T,R,q,F,z,H,Y,G,J,B,K,V,Z,Q;function X(e){t[9].call(null,e)}let tt={showPasswords:!0};return void 0!==t[2]&&(tt.students=t[2]),H=new ie({props:tt}),A.push((()=>ct(H,"students",X))),{c(){e=v("h1"),e.textContent="Setup",n=y(),s=v("ol"),l=v("li"),r=b("Enter your UT CS username:\n\t\t"),u=v("input"),c=y(),i=v("li"),a=b("Log in to your UT CS account and download the phpseclib library:\n\t\t"),d=v("input"),f=y(),p=v("li"),$=b("Then install the server integration script:\n\t\t"),w=v("input"),x=y(),_=v("li"),S=b("Go to "),I=v("a"),D=b("this link"),j=b(", copy the token,\n\t\tand paste it here:\n\t\t"),U=v("input"),E=y(),P=v("ul"),M=v("li"),M.textContent="Getting errors? Make sure you have phpseclib installed and\n\t\t\t\tpermissions correctly set up.",N=y(),L=v("li"),T=b("Need to reset your token? Run this and then go to step 3 again:\n\t\t\t\t"),R=v("input"),q=y(),F=v("li"),F.textContent="Paste your list of students separated by linebreaks below.",z=y(),it(H.$$.fragment),G=y(),J=v("button"),B=b("Save and continue"),C(u,"type","text"),d.readOnly=!0,C(d,"type","text"),d.value=t[6],w.readOnly=!0,C(w,"type","text"),w.value=te,C(I,"href",t[3]),C(I,"target","_blank"),C(U,"type","text"),R.readOnly=!0,C(R,"type","text"),R.value=t[4],J.disabled=K=!t[1]||!t[0]||!t[2]},m(o,g){h(o,e,g),h(o,n,g),h(o,s,g),m(s,l),m(l,r),m(l,u),O(u,t[1]),m(s,c),m(s,i),m(i,a),m(i,d),m(s,f),m(s,p),m(p,$),m(p,w),m(s,x),m(s,_),m(_,S),m(_,I),m(I,D),m(_,j),m(_,U),O(U,t[0]),m(_,E),m(_,P),m(P,M),m(P,N),m(P,L),m(L,T),m(L,R),m(s,q),m(s,F),h(o,z,g),at(H,o,g),h(o,G,g),h(o,J,g),m(J,B),V=!0,Z||(Q=[k(u,"input",t[7]),k(d,"click",Wt),k(d,"focus",Wt),k(w,"click",Wt),k(w,"focus",Wt),k(U,"input",t[8]),k(R,"click",Wt),k(R,"focus",Wt),k(J,"click",t[5])],Z=!0)},p(t,[e]){2&e&&u.value!==t[1]&&O(u,t[1]),(!V||8&e)&&C(I,"href",t[3]),1&e&&U.value!==t[0]&&O(U,t[0]),(!V||16&e&&R.value!==t[4])&&(R.value=t[4]);const n={};!Y&&4&e&&(Y=!0,n.students=t[2],W((()=>Y=!1))),H.$set(n),(!V||7&e&&K!==(K=!t[1]||!t[0]||!t[2]))&&(J.disabled=K)},i(t){V||(ot(H.$$.fragment,t),V=!0)},o(t){lt(H.$$.fragment,t),V=!1},d(t){t&&g(e),t&&g(n),t&&g(s),t&&g(z),dt(H,t),t&&g(G),t&&g(J),Z=!1,o(Q)}}}function ge(t,e,n){let s,o,l,r;u(t,vt,(t=>n(11,r=t)));let i="",a="",d=[];const f="cd ~/public_html\nwget https://github.com/phpseclib/phpseclib/archive/2.0.30.zip\nunzip 2.0.30.zip\nmv phpseclib-2.0.30/phpseclib phpseclib\nrm -rf phpseclib-2.0.30\nrm 2.0.30.zip\nchmod -R 755 phpseclib".split("\n").join(" && ");return t.$$.update=()=>{2&t.$$.dirty&&n(3,s=`https://www.cs.utexas.edu/~${a}/gradable.php`),13&t.$$.dirty&&(o={token:i,endpoint:s,students:d}),2&t.$$.dirty&&n(4,l=`cd ~/public_html\nwget -O gradable-reset.php "${Xt}server/gradable-reset.php"\nchmod 755 gradable-reset.php\ncurl https://www.cs.utexas.edu/~${a}/gradable-reset.php\nrm gradable-reset.php`.split("\n").join(" && "))},[i,a,d,s,l,function(){(function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("ping","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json()))})(o).then((t=>{t.success?c(vt,r=o,r):alert("Invalid token")})).catch((()=>{alert("Could not connect to server")}))},f,function(){a=this.value,n(1,a)},function(){i=this.value,n(0,i)},function(t){d=t,n(2,d)}]}class $e extends mt{constructor(t){super(),pt(this,t,ge,he,r,{})}}function ve(t,e,n){const s=t.slice();return s[11]=e[n],s[13]=n,s}function be(e){let n;return{c(){n=v("i"),n.textContent="none"},m(t,e){h(t,n,e)},p:t,d(t){t&&g(n)}}}function ye(t){let e,n,s,l;return{c(){e=v("textarea"),e.readOnly=!0,e.value=n=t[4](t[11].commentIds,"\n"),C(e,"class","svelte-gmr12x")},m(t,n){h(t,e,n),s||(l=[k(e,"click",Wt),k(e,"focus",Wt)],s=!0)},p(t,s){2&s&&n!==(n=t[4](t[11].commentIds,"\n"))&&(e.value=n)},d(t){t&&g(e),s=!1,o(l)}}}function we(t){let e,n,s,l,r,u,c,i,a,d,f,p,$,w,x,_,O,I,D=Jt(t[11].realname).last+"",j=Jt(t[11].realname).first+"";function U(t,e){return t[11].commentIds.length>0?ye:be}let E=U(t),P=E(t);function M(){return t[6](t[11])}return{c(){e=v("tr"),n=v("td"),s=b(D),l=b(",\n\t\t\t\t\t"),r=b(j),u=y(),c=v("td"),i=v("input"),d=b("%"),f=y(),p=v("td"),P.c(),$=y(),w=v("td"),x=v("button"),x.textContent="regrade",_=y(),i.readOnly=!0,C(i,"class","percentage svelte-gmr12x"),C(i,"type","text"),i.value=a=zt(t[11].commentIds,t[0].possibleComments)},m(t,o){h(t,e,o),m(e,n),m(n,s),m(n,l),m(n,r),m(e,u),m(e,c),m(c,i),m(c,d),m(e,f),m(e,p),P.m(p,null),m(e,$),m(e,w),m(w,x),m(e,_),O||(I=[k(i,"click",Wt),k(i,"focus",Wt),k(x,"click",M)],O=!0)},p(e,n){t=e,2&n&&D!==(D=Jt(t[11].realname).last+"")&&S(s,D),2&n&&j!==(j=Jt(t[11].realname).first+"")&&S(r,j),3&n&&a!==(a=zt(t[11].commentIds,t[0].possibleComments))&&i.value!==a&&(i.value=a),E===(E=U(t))&&P?P.p(t,n):(P.d(1),P=E(t),P&&(P.c(),P.m(p,null)))},d(t){t&&g(e),P.d(),O=!1,o(I)}}}function ke(e){let n,s,o,l,r,u,c,i,a=e[1],d=[];for(let t=0;t<a.length;t+=1)d[t]=we(ve(e,a,t));return{c(){n=v("table"),s=v("thead"),s.innerHTML='<tr><td>name</td> \n\t\t\t<td>grade</td> \n\t\t\t<td width="99%">comments</td> \n\t\t\t<td>actions</td></tr>',o=y(),l=v("tbody");for(let t=0;t<d.length;t+=1)d[t].c();r=y(),u=v("button"),u.textContent="Export and continue",C(n,"class","svelte-gmr12x")},m(t,a){h(t,n,a),m(n,s),m(n,o),m(n,l);for(let t=0;t<d.length;t+=1)d[t].m(l,null);h(t,r,a),h(t,u,a),c||(i=k(u,"click",e[2]),c=!0)},p(t,[e]){if(27&e){let n;for(a=t[1],n=0;n<a.length;n+=1){const s=ve(t,a,n);d[n]?d[n].p(s,e):(d[n]=we(s),d[n].c(),d[n].m(l,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=a.length}},i:t,o:t,d(t){t&&g(n),$(d,t),t&&g(r),t&&g(u),c=!1,i()}}}function xe(t,e,n){let s,o,l,r,i,a;function d(t){c(yt,i=t,i),c(bt,o.students=o.students.filter((e=>e.username!==t.username)),o),c(kt,a=[],a)}function f(t,e){return t.map((t=>o.possibleComments[t])).map((({points:t,text:e})=>100===t?e:0===t?`Note: ${e}`:`-${t}: ${e}`)).join(e)}u(t,bt,(t=>n(0,o=t))),u(t,vt,(t=>n(5,l=t))),u(t,wt,(t=>n(7,r=t))),u(t,yt,(t=>n(8,i=t))),u(t,kt,(t=>n(9,a=t)));return t.$$.update=()=>{33&t.$$.dirty&&n(1,s=o?l.students.map((t=>Object.assign({realname:t.realname},(null==o?void 0:o.students.find((e=>e.username===t.username)))||{}))):[])},[o,s,function(){c(wt,r=[...r,{label:"HW "+o.number,lastChange:(new Date).getTime(),homework:o,currentStudent:null}],r);let t="name\tscore\tcomments\n";s.forEach((e=>{t+=e.username,t+="\t",t+=zt(e.commentIds,null==o?void 0:o.possibleComments),t+="\t",t+=f(e.commentIds,"; "),t+="\n"}));const e=document.createElement("a");e.setAttribute("href","data:text/tab-separated-values;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",`HW${o.number}export-${(new Date).getTime()/1e3|0}.csv`),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),c(bt,o=null,o)},d,f,l,t=>{d(t)}]}class Ce extends mt{constructor(t){super(),pt(this,t,xe,ke,r,{})}}function _e(t,e,n){const s=t.slice();return s[20]=e[n].username,s[21]=e[n].lock,s[22]=e[n].status,s[23]=e[n].details,s[25]=n,s}function Se(t){let e;return{c(){e=b("‚ùå")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Oe(t){let e;return{c(){e=b("‚úîÔ∏è")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Ie(t){let e;return{c(){e=b("‚åõ")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function De(t){let e,n,s,l,r,u,c,i,a,d,f,p,w,x,_=t[2].username+"",O=t[1],I=[];for(let e=0;e<O.length;e+=1)I[e]=Me(_e(t,O,e));return{c(){e=v("div"),n=v("div"),s=v("div"),l=b(_),r=y(),u=v("button"),u.textContent="Unlock",c=y(),i=v("button"),i.textContent="Lock",a=y(),d=v("small"),d.textContent="Locking and unlocking is not instant. You might need to wait a\n\t\t\tminute or two until changes take effect. Use the refresh button to\n\t\t\tcheck.",f=y(),p=v("div");for(let t=0;t<I.length;t+=1)I[t].c();C(n,"class","split actions svelte-11kagjv"),C(p,"class","requests svelte-11kagjv"),C(e,"class","details svelte-11kagjv")},m(o,g){h(o,e,g),m(e,n),m(n,s),m(s,l),m(n,r),m(n,u),m(n,c),m(n,i),m(e,a),m(e,d),m(e,f),m(e,p);for(let t=0;t<I.length;t+=1)I[t].m(p,null);w||(x=[k(u,"click",t[9]),k(i,"click",t[10])],w=!0)},p(t,e){if(4&e&&_!==(_=t[2].username+"")&&S(l,_),3&e){let n;for(O=t[1],n=0;n<O.length;n+=1){const s=_e(t,O,n);I[n]?I[n].p(s,e):(I[n]=Me(s),I[n].c(),I[n].m(p,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=O.length}},d(t){t&&g(e),$(I,t),w=!1,o(x)}}}function je(t){let e;return{c(){e=b("failed")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Ue(t){let e;return{c(){e=b("done")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Ee(t){let e;return{c(){e=b("waiting")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Pe(t){let e,n,s=t[23]+"";return{c(){e=v("pre"),n=b(s),C(e,"class","svelte-11kagjv")},m(t,s){h(t,e,s),m(e,n)},p(t,e){2&e&&s!==(s=t[23]+"")&&S(n,s)},d(t){t&&g(e)}}}function Me(t){let e,n,s,o,l,r,u,c,i,a,d=t[20]+"",f=t[21]?"lock":"unlock";function p(t,e){return t[22]===t[0].Pending?Ee:t[22]===t[0].Success?Ue:t[22]===t[0].Failed?je:void 0}let $=p(t),w=$&&$(t),k=t[22]===t[0].Failed&&Pe(t);return{c(){e=v("div"),n=v("div"),s=v("div"),o=b(d),l=b(" ("),r=b(f),u=b(")"),c=y(),w&&w.c(),i=y(),k&&k.c(),a=y(),C(n,"class","split"),I(e,"opacity",(Ae-t[25])/Ae)},m(t,d){h(t,e,d),m(e,n),m(n,s),m(s,o),m(s,l),m(s,r),m(s,u),m(n,c),w&&w.m(n,null),m(e,i),k&&k.m(e,null),m(e,a)},p(t,s){2&s&&d!==(d=t[20]+"")&&S(o,d),2&s&&f!==(f=t[21]?"lock":"unlock")&&S(r,f),$!==($=p(t))&&(w&&w.d(1),w=$&&$(t),w&&(w.c(),w.m(n,null))),t[22]===t[0].Failed?k?k.p(t,s):(k=Pe(t),k.c(),k.m(e,a)):k&&(k.d(1),k=null)},d(t){t&&g(e),w&&w.d(),k&&k.d()}}}function Ne(t){let e,n,s,o,l,r;function u(t,e){return t[3]?Le:Te}let c=u(t),i=c(t);function a(t,e){return t[3]?Re:qe}let d=a(t),f=d(t);return{c(){e=v("div"),n=v("div"),s=v("h3"),i.c(),o=y(),f.c(),C(n,"class","svelte-11kagjv"),C(e,"class","unloadwarning svelte-11kagjv"),U(e,"pending",!t[3])},m(u,c){h(u,e,c),m(e,n),m(n,s),i.m(s,null),m(n,o),f.m(n,null),l||(r=k(e,"click",t[8],{once:!0}),l=!0)},p(t,o){c!==(c=u(t))&&(i.d(1),i=c(t),i&&(i.c(),i.m(s,null))),d!==(d=a(t))&&(f.d(1),f=d(t),f&&(f.c(),f.m(n,null))),8&o&&U(e,"pending",!t[3])},d(t){t&&g(e),i.d(),f.d(),l=!1,r()}}}function Le(t){let e;return{c(){e=b("You can safely close this tab")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Te(t){let e;return{c(){e=b("One moment...")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Re(t){let e;return{c(){e=b("Cancel and click anywhere to resume grading.")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function qe(t){let e;return{c(){e=b("Since some folders were unlocked to grade, we need to grade them\n\t\t\t\tagain before closing this session. A request has been sent.")},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function Fe(e){let n,s,l,r,u,c;function i(t,e){return t[5]===t[0].Pending?Ie:t[5]===t[0].Success?Oe:t[5]===t[0].Failed?Se:void 0}let a=i(e),d=a&&a(e),f=(e[4]||e[6])&&De(e),p=e[6]&&Ne(e);return{c(){n=v("button"),d&&d.c(),s=y(),f&&f.c(),l=y(),p&&p.c(),r=w(),C(n,"class","entry svelte-11kagjv")},m(t,o){h(t,n,o),d&&d.m(n,null),h(t,s,o),f&&f.m(t,o),h(t,l,o),p&&p.m(t,o),h(t,r,o),u||(c=[k(window,"beforeunload",e[7]),k(n,"click",e[11])],u=!0)},p(t,[e]){a!==(a=i(t))&&(d&&d.d(1),d=a&&a(t),d&&(d.c(),d.m(n,null))),t[4]||t[6]?f?f.p(t,e):(f=De(t),f.c(),f.m(l.parentNode,l)):f&&(f.d(1),f=null),t[6]?p?p.p(t,e):(p=Ne(t),p.c(),p.m(r.parentNode,r)):p&&(p.d(1),p=null)},i:t,o:t,d(t){t&&g(n),d&&d.d(),t&&g(s),f&&f.d(t),t&&g(l),p&&p.d(t),t&&g(r),u=!1,o(c)}}}const Ae=5;function ze(t,e,n){let s,o,l,r;var i;u(t,bt,(t=>n(14,s=t))),u(t,yt,(t=>n(2,o=t))),u(t,vt,(t=>n(15,l=t))),u(t,St,(t=>n(16,r=t))),function(t){t[t.Pending=0]="Pending",t[t.Success=1]="Success",t[t.Failed=2]="Failed"}(i||(i={}));let a=s.prefix,d=[],f=!1,p=!1,m=!1,h=i.Success,g=!1,$=null;function v(){let t=[];$?t.push(b($,!0)):o&&t.push(b(o.username,!1));const e=o&&Dt(o.username);return e&&t.push(b(e,!1)),n(3,f=!1),Promise.all(t)}function b(t,e){const s=`${a}/${t}/`,o={username:t,lock:e,status:i.Pending,details:""};return n(1,d=[o,...d]),new Promise(((u,a)=>{(e?ee:ne)(s,t,l).then((e=>{e.success?(o.status=i.Success,u()):(n(12,m=!0),o.status=i.Failed,o.details=e.result,c(St,r[t]=o.details,r)),n(1,d=d.slice(0,Ae))})).catch((e=>{n(12,m=!0),o.status=i.Failed,o.details=e,n(1,d=d.slice(0,Ae)),c(St,r[t]=o.details,r),a(e)}))}))}return R((()=>{$&&b($,!0)})),t.$$.update=()=>{8196&t.$$.dirty&&$!==o.username&&(v(),n(13,$=o.username)),4099&t.$$.dirty&&(d.find((t=>t.status===i.Pending))?n(5,h=i.Pending):n(5,h=m?i.Failed:i.Success))},[i,d,o,f,p,h,g,function(t){if(!f){t.preventDefault(),t.returnValue="",n(6,g=!0);let e=[];e.push(b(o.username,!0));const s=o&&Dt(o.username);return s&&e.push(b(s,!0)),Promise.all(e).then((()=>{n(3,f=!0)})),"Locking current student's assignment... You can probably close this tab."}},function(){v(),n(6,g=!1)},function(){b(o.username,!1)},function(){b(o.username,!0)},function(){n(4,p=!p),n(12,m=!1)},m,$]}class He extends mt{constructor(t){super(),pt(this,t,ze,Fe,r,{})}}function Ye(e){let n;return{c(){n=v("div"),n.innerHTML='<h3 class="svelte-ly9qxt">Waiting on unlock</h3>\n\t\t\t\tThis shouldn&#39;t take longer than five minutes.',C(n,"class","waiting message svelte-ly9qxt")},m(t,e){h(t,n,e)},p:t,d(t){t&&g(n)}}}function Ge(t){let e,n,s,o="undefined"!==t[4]&&Je(t);return{c(){e=v("div"),n=v("h3"),n.textContent="Failed to load",s=b("\n\t\t\t\tYou might need to manually SSH in to investigate.\n\t\t\t\t"),o&&o.c(),C(n,"class","svelte-ly9qxt"),C(e,"class","message svelte-ly9qxt")},m(t,l){h(t,e,l),m(e,n),m(e,s),o&&o.m(e,null)},p(t,n){"undefined"!==t[4]?o?o.p(t,n):(o=Je(t),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(t){t&&g(e),o&&o.d()}}}function Je(t){let e,n;return{c(){e=v("pre"),n=b(t[4]),C(e,"class","svelte-ly9qxt")},m(t,s){h(t,e,s),m(e,n)},p(t,e){16&e&&S(n,t[4])},d(t){t&&g(e)}}}function We(t){let e,n,s,l,r,u,c,i,a,d,f,p,$,w,x,_,O,I,D;function j(t,e){return void 0!==t[4]?Ge:t[2]?Ye:void 0}c=new He({});let E=j(t),P=E&&E(t);return{c(){e=v("div"),n=v("div"),s=v("a"),l=b(t[3]),r=v("span"),r.textContent="ignore",u=y(),it(c.$$.fragment),i=y(),a=v("button"),a.textContent="Clear cookies",d=y(),f=v("button"),f.textContent="Refresh",p=y(),$=v("div"),P&&P.c(),w=y(),x=v("iframe"),C(r,"class","svelte-ly9qxt"),C(s,"href",t[3]),C(s,"class","location svelte-ly9qxt"),C(s,"target","_blank"),C(n,"class","top svelte-ly9qxt"),x.src!==(_=t[1])&&C(x,"src",_),C(x,"frameborder","0"),C(x,"title","Embedded website to grade"),C(x,"class","svelte-ly9qxt"),U(x,"faded",void 0!==t[4]||t[2]),C($,"class","main svelte-ly9qxt"),C(e,"class","browser svelte-ly9qxt")},m(o,g){h(o,e,g),m(e,n),m(n,s),m(s,l),m(s,r),m(n,u),at(c,n,null),m(n,i),m(n,a),m(n,d),m(n,f),m(e,p),m(e,$),P&&P.m($,null),m($,w),m($,x),t[11](x),O=!0,I||(D=[k(window,"keydown",t[7]),k(a,"click",t[6]),k(f,"click",t[5])],I=!0)},p(t,[e]){(!O||8&e)&&S(l,t[3]),(!O||8&e)&&C(s,"href",t[3]),E===(E=j(t))&&P?P.p(t,e):(P&&P.d(1),P=E&&E(t),P&&(P.c(),P.m($,w))),(!O||2&e&&x.src!==(_=t[1]))&&C(x,"src",_),20&e&&U(x,"faded",void 0!==t[4]||t[2])},i(t){O||(ot(c.$$.fragment,t),O=!0)},o(t){lt(c.$$.fragment,t),O=!1},d(n){n&&g(e),dt(c),P&&P.d(),t[11](null),I=!1,o(D)}}}function Be(t,e,n){let s,o,l,r,c;u(t,Ct,(t=>n(3,o=t))),u(t,kt,(t=>n(8,l=t))),u(t,St,(t=>n(9,r=t))),u(t,yt,(t=>n(10,c=t)));let{embeddedUrl:i="about:blank"}=e,{iframeRef:a}=e;function d(){Yt({type:"refresh-page"})}let f=!0;return t.$$set=t=>{"embeddedUrl"in t&&n(1,i=t.embeddedUrl),"iframeRef"in t&&n(0,a=t.iframeRef)},t.$$.update=()=>{256&t.$$.dirty&&l[0]&&(403===l[0].statusCode?(n(2,f=!0),setTimeout(d,1e3)):n(2,f=!1)),1536&t.$$.dirty&&n(4,s=r[c.username])},[a,i,f,o,s,d,function(){Yt({type:"clear-cookies",value:o})},function(t){82===t.keyCode&&t.ctrlKey&&(d(),t.preventDefault())},l,r,c,function(t){A[t?"unshift":"push"]((()=>{a=t,n(0,a)}))}]}class Ke extends mt{constructor(t){super(),pt(this,t,Be,We,r,{embeddedUrl:1,iframeRef:0})}}function Ve(e){let n,s,l,r,u,c;return{c(){n=v("div"),s=v("div"),s.textContent="-",l=y(),r=v("input"),C(s,"class","minus svelte-mu2102"),C(r,"type","number"),C(r,"class","points svelte-mu2102"),C(r,"placeholder","5"),C(n,"class","join svelte-mu2102")},m(t,o){h(t,n,o),m(n,s),m(n,l),m(n,r),O(r,e[0]),u||(c=[k(r,"input",e[4]),k(r,"keyup",x(e[1])),k(r,"blur",e[2]),k(r,"change",e[3])],u=!0)},p(t,[e]){1&e&&_(r.value)!==t[0]&&O(r,t[0])},i:t,o:t,d(t){t&&g(n),u=!1,o(c)}}}function Ze(t,e,n){let{value:s}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value)},[s,function(e){q(t,e)},function(e){q(t,e)},function(e){q(t,e)},function(){s=_(this.value),n(0,s)}]}class Qe extends mt{constructor(t){super(),pt(this,t,Ze,Ve,r,{value:0})}}function Xe(t){let e,n,s,l,r,u,c,i,a,d,f,p,$;function b(e){t[7].call(null,e)}let w={};return void 0!==t[0].points&&(w.value=t[0].points),u=new Qe({props:w}),A.push((()=>ct(u,"value",b))),u.$on("change",t[4]),{c(){e=v("tr"),n=v("td"),s=v("input"),l=y(),r=v("td"),it(u.$$.fragment),i=y(),a=v("td"),d=v("input"),C(s,"type","text"),C(s,"placeholder","Missing name"),C(s,"class","svelte-1te1hhk"),C(n,"class","comment svelte-1te1hhk"),C(d,"type","checkbox"),d.checked=t[2],C(d,"class","svelte-1te1hhk"),C(a,"class","toggle svelte-1te1hhk"),C(e,"class","svelte-1te1hhk"),U(e,"inactive",!t[2])},m(o,c){h(o,e,c),m(e,n),m(n,s),O(s,t[0].text),m(e,l),m(e,r),at(u,r,null),m(e,i),m(e,a),m(a,d),f=!0,p||($=[k(s,"input",t[6]),k(s,"change",t[4]),k(d,"change",t[8]),k(a,"click",t[9])],p=!0)},p(t,[n]){1&n&&s.value!==t[0].text&&O(s,t[0].text);const o={};!c&&1&n&&(c=!0,o.value=t[0].points,W((()=>c=!1))),u.$set(o),(!f||4&n)&&(d.checked=t[2]),4&n&&U(e,"inactive",!t[2])},i(t){f||(ot(u.$$.fragment,t),f=!0)},o(t){lt(u.$$.fragment,t),f=!1},d(t){t&&g(e),dt(u),p=!1,o($)}}}function tn(t,e,n){let s,o,l;u(t,yt,(t=>n(5,o=t))),u(t,bt,(t=>n(10,l=t)));let{comment:r}=e,{commentId:i}=e;function a(t,e){t?o.commentIds.includes(e)||c(yt,o.commentIds=[...o.commentIds,e],o):c(yt,o.commentIds=o.commentIds.filter((t=>t!==e)),o)}return t.$$set=t=>{"comment"in t&&n(0,r=t.comment),"commentId"in t&&n(1,i=t.commentId)},t.$$.update=()=>{34&t.$$.dirty&&n(2,s=o.commentIds.includes(i))},[r,i,s,a,function(){c(bt,l.possibleComments[i]=r,l)},o,function(){r.text=this.value,n(0,r)},function(t){r.points=t,n(0,r)},t=>a(t.target.checked,i),()=>a(!s,i)]}class en extends mt{constructor(t){super(),pt(this,t,tn,Xe,r,{comment:0,commentId:1})}}function nn(t,e,n){const s=t.slice();return s[8]=e[n],s[10]=n,s}function sn(t){let e,n;return e=new en({props:{comment:t[8],commentId:t[10]}}),{c(){it(e.$$.fragment)},m(t,s){at(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.comment=t[8]),e.$set(s)},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function on(t){let e,n,s,l,r,u,c,i,a,d,f,p,b,w,_,S,I=t[2].possibleComments,D=[];for(let e=0;e<I.length;e+=1)D[e]=sn(nn(t,I,e));const j=t=>lt(D[t],1,1,(()=>{D[t]=null}));function U(e){t[6].call(null,e)}let E={};return void 0!==t[0]&&(E.value=t[0]),i=new Qe({props:E}),A.push((()=>ct(i,"value",U))),i.$on("keyup",t[3]),i.$on("blur",t[4]),{c(){e=v("table");for(let t=0;t<D.length;t+=1)D[t].c();n=y(),s=v("tr"),l=v("td"),r=v("input"),u=y(),c=v("td"),it(i.$$.fragment),d=y(),f=v("td"),p=y(),b=v("small"),b.textContent="Use the checkboxes to the right to mark off points. To add a new penalty,\n\tenter a comment and the number of points to remove. Changing text or points\n\twill update for all students.",C(r,"type","text"),C(r,"placeholder","Missing name"),C(r,"class","svelte-1at0h8t"),C(l,"class","comment svelte-1at0h8t"),C(e,"class","svelte-1at0h8t"),C(b,"class","svelte-1at0h8t")},m(o,a){h(o,e,a);for(let t=0;t<D.length;t+=1)D[t].m(e,null);m(e,n),m(e,s),m(s,l),m(l,r),O(r,t[1]),m(s,u),m(s,c),at(i,c,null),m(s,d),m(s,f),h(o,p,a),h(o,b,a),w=!0,_||(S=[k(r,"input",t[5]),k(r,"keyup",x(t[3])),k(r,"blur",t[4])],_=!0)},p(t,[s]){if(4&s){let o;for(I=t[2].possibleComments,o=0;o<I.length;o+=1){const l=nn(t,I,o);D[o]?(D[o].p(l,s),ot(D[o],1)):(D[o]=sn(l),D[o].c(),ot(D[o],1),D[o].m(e,n))}for(nt(),o=I.length;o<D.length;o+=1)j(o);st()}2&s&&r.value!==t[1]&&O(r,t[1]);const o={};!a&&1&s&&(a=!0,o.value=t[0],W((()=>a=!1))),i.$set(o)},i(t){if(!w){for(let t=0;t<I.length;t+=1)ot(D[t]);ot(i.$$.fragment,t),w=!0}},o(t){D=D.filter(Boolean);for(let t=0;t<D.length;t+=1)lt(D[t]);lt(i.$$.fragment,t),w=!1},d(t){t&&g(e),$(D,t),dt(i),t&&g(p),t&&g(b),_=!1,o(S)}}}function ln(t,e,n){let s,o;u(t,bt,(t=>n(2,s=t))),u(t,yt,(t=>n(7,o=t)));let l="",r="";function i(){if(l&&r){let t=s.possibleComments.map((t=>t.text)).indexOf(r);-1===t?(t=s.possibleComments.length,c(bt,s.possibleComments=[...s.possibleComments,{text:r,points:parseInt(l,10)}],s)):c(bt,s.possibleComments[t].points=parseInt(l,10),s),o.commentIds.includes(t)||c(yt,o.commentIds=[...o.commentIds,t],o),n(0,l=n(1,r=""))}}return[l,r,s,function(t){"Enter"==t.code&&i()},i,function(){r=this.value,n(1,r)},function(t){l=t,n(0,l)}]}class rn extends mt{constructor(t){super(),pt(this,t,ln,on,r,{})}}function un(t){let e,n,s;return{c(){e=b("Mark as "),n=b(t[1]),s=b("% and continue")},m(t,o){h(t,e,o),h(t,n,o),h(t,s,o)},p(t,e){2&e&&S(n,t[1])},d(t){t&&g(e),t&&g(n),t&&g(s)}}}function cn(e){let n;return{c(){n=b("Mark as perfect and continue")},m(t,e){h(t,n,e)},p:t,d(t){t&&g(n)}}}function an(e){let n,s,l,r,u,c,i,a;function d(t,e){return 100===t[1]?cn:un}let f=d(e),p=f(e);return{c(){n=v("div"),s=v("button"),l=b("Previous"),u=y(),c=v("button"),p.c(),C(s,"class","prev"),s.disabled=r=0===e[0].students.length,C(c,"class","next svelte-3mv7lh"),C(n,"class","wrap svelte-3mv7lh")},m(t,o){h(t,n,o),m(n,s),m(s,l),m(n,u),m(n,c),p.m(c,null),i||(a=[k(s,"click",e[2]),k(c,"click",e[3])],i=!0)},p(t,[e]){1&e&&r!==(r=0===t[0].students.length)&&(s.disabled=r),f===(f=d(t))&&p?p.p(t,e):(p.d(1),p=f(t),p&&(p.c(),p.m(c,null)))},i:t,o:t,d(t){t&&g(n),p.d(),i=!1,o(a)}}}function dn(t,e,n){let s,o,l,r;return u(t,yt,(t=>n(4,o=t))),u(t,bt,(t=>n(0,l=t))),u(t,kt,(t=>n(5,r=t))),t.$$.update=()=>{17&t.$$.dirty&&n(1,s=zt(o.commentIds,l.possibleComments))},[l,s,function(){const t=l.students.pop();c(yt,o=t,o),bt.set(l),c(kt,r=[],r)},function(){Yt({type:"clear-cookies"}),c(bt,l.students=[...l.students,o],l),jt()},o]}class fn extends mt{constructor(t){super(),pt(this,t,dn,an,r,{})}}function pn(t,{delay:n=0,duration:s=400,easing:o=e}){const l=+getComputedStyle(t).opacity;return{delay:n,duration:s,easing:o,css:t=>"opacity: "+t*l}}function mn(t){let e,n,s,o;return{c(){e=v("pre"),n=b(t[0]),C(e,"class","content svelte-136m9d3")},m(t,s){h(t,e,s),m(e,n),o=!0},p(t,[e]){(!o||1&e)&&S(n,t[0])},i(t){o||(J((()=>{s||(s=ut(e,pn,{duration:100,delay:300},!0)),s.run(1)})),o=!0)},o(t){s||(s=ut(e,pn,{duration:100,delay:300},!1)),s.run(0),o=!1},d(t){t&&g(e),t&&s&&s.end()}}}function hn(t,e,n){let{content:s=""}=e;return t.$$set=t=>{"content"in t&&n(0,s=t.content)},[s]}class gn extends mt{constructor(t){super(),pt(this,t,hn,mn,r,{content:0})}}function $n(t,e,n){const s=t.slice();return s[16]=e[n],s}function vn(t){let e;return{c(){e=v("tr"),e.innerHTML="<i>No requests logged</i>"},m(t,n){h(t,e,n)},d(t){t&&g(e)}}}function bn(e){let n;return{c(){n=v("td"),n.innerHTML="<i>unknown</i>"},m(t,e){h(t,n,e)},p:t,d(t){t&&g(n)}}}function yn(t){let e,n,s,o=new Date(t[16].lastModified).toLocaleString()+"",l=t[16].daysLate>0&&wn(t);return{c(){e=v("td"),l&&l.c(),n=y(),s=b(o)},m(t,o){h(t,e,o),l&&l.m(e,null),m(e,n),m(e,s)},p(t,r){t[16].daysLate>0?l?l.p(t,r):(l=wn(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),2&r&&o!==(o=new Date(t[16].lastModified).toLocaleString()+"")&&S(s,o)},d(t){t&&g(e),l&&l.d()}}}function wn(t){let e,n,s=t[16].daysLate+"";return{c(){e=v("div"),n=b(s),C(e,"class","latebadge svelte-1w8y9g0")},m(t,s){h(t,e,s),m(e,n)},p(t,e){2&e&&s!==(s=t[16].daysLate+"")&&S(n,s)},d(t){t&&g(e)}}}function kn(t){let e,n,s,l,r,u,c,i,a,d,f,p,$,w=t[16].statusCode+"",x=t[16].displayUrl+"";function _(t,e){return t[16].lastModified?yn:bn}let O=_(t),I=O(t);function D(){return t[11](t[16])}return{c(){e=v("tr"),n=v("td"),s=b(w),l=y(),I.c(),r=y(),u=v("td"),c=v("a"),i=b(x),f=y(),C(c,"href",a=t[16].url),C(c,"target","_blank"),C(u,"title",d=t[16].url)},m(o,a){h(o,e,a),m(e,n),m(n,s),m(e,l),I.m(e,null),m(e,r),m(e,u),m(u,c),m(c,i),m(e,f),p||($=[k(e,"mouseenter",D),k(e,"mouseleave",t[12])],p=!0)},p(n,o){t=n,2&o&&w!==(w=t[16].statusCode+"")&&S(s,w),O===(O=_(t))&&I?I.p(t,o):(I.d(1),I=O(t),I&&(I.c(),I.m(e,r))),2&o&&x!==(x=t[16].displayUrl+"")&&S(i,x),2&o&&a!==(a=t[16].url)&&C(c,"href",a),2&o&&d!==(d=t[16].url)&&C(u,"title",d)},d(t){t&&g(e),I.d(),p=!1,o($)}}}function xn(t){let e,n,s,l,r;return n=new gn({props:{content:t[2]}}),{c(){e=v("div"),it(n.$$.fragment)},m(o,u){h(o,e,u),at(n,e,null),s=!0,l||(r=[k(e,"mouseenter",t[13]),k(e,"mouseleave",t[14])],l=!0)},p(t,e){const s={};4&e&&(s.content=t[2]),n.$set(s)},i(t){s||(ot(n.$$.fragment,t),s=!0)},o(t){lt(n.$$.fragment,t),s=!1},d(t){t&&g(e),dt(n),l=!1,o(r)}}}function Cn(t){let e,n,s,o,l,r,u,c,i,a,d,f,p,_,O,I,D,j,E,P=1===t[0]?"day":"days",M=t[1],N=[];for(let e=0;e<M.length;e+=1)N[e]=kn($n(t,M,e));let L=null;M.length||(L=vn());let T=t[3]&&t[2]&&xn(t);return{c(){e=v("div"),n=v("div"),s=b("Most recent change made "),o=b(t[0]),l=y(),r=b(P),u=b(" late."),c=y(),i=v("a"),i.textContent="Clear",a=y(),d=v("div"),f=v("table");for(let t=0;t<N.length;t+=1)N[t].c();L&&L.c(),p=y(),_=v("div"),O=y(),T&&T.c(),I=w(),C(n,"class","svelte-1w8y9g0"),C(i,"href","#clear"),C(i,"class","svelte-1w8y9g0"),C(e,"class","summary svelte-1w8y9g0"),U(e,"late",t[0]>0),C(f,"class","svelte-1w8y9g0"),C(_,"class","fade svelte-1w8y9g0"),C(d,"class","wrap svelte-1w8y9g0")},m(g,$){h(g,e,$),m(e,n),m(n,s),m(n,o),m(n,l),m(n,r),m(n,u),m(e,c),m(e,i),h(g,a,$),h(g,d,$),m(d,f);for(let t=0;t<N.length;t+=1)N[t].m(f,null);L&&L.m(f,null),m(d,p),m(d,_),h(g,O,$),T&&T.m(g,$),h(g,I,$),D=!0,j||(E=k(i,"click",x(t[4])),j=!0)},p(t,[n]){if((!D||1&n)&&S(o,t[0]),(!D||1&n)&&P!==(P=1===t[0]?"day":"days")&&S(r,P),1&n&&U(e,"late",t[0]>0),42&n){let e;for(M=t[1],e=0;e<M.length;e+=1){const s=$n(t,M,e);N[e]?N[e].p(s,n):(N[e]=kn(s),N[e].c(),N[e].m(f,null))}for(;e<N.length;e+=1)N[e].d(1);N.length=M.length,M.length?L&&(L.d(1),L=null):L||(L=vn(),L.c(),L.m(f,null))}t[3]&&t[2]?T?(T.p(t,n),12&n&&ot(T,1)):(T=xn(t),T.c(),ot(T,1),T.m(I.parentNode,I)):T&&(nt(),lt(T,1,1,(()=>{T=null})),st())},i(t){D||(ot(T),D=!0)},o(t){lt(T),D=!1},d(t){t&&g(e),t&&g(a),t&&g(d),$(N,t),L&&L.d(),t&&g(O),T&&T.d(t),t&&g(I),j=!1,E()}}}function _n(t,e){const n=(e-new Date(t).getTime())/1e3,s=-Math.floor(Math.min(0,n/60/60/24));return s>0?s:0}function Sn(t,e,n){let s,o,l,r,i,a,d;u(t,bt,(t=>n(7,l=t))),u(t,kt,(t=>n(8,r=t))),u(t,xt,(t=>n(9,i=t))),u(t,yt,(t=>n(10,a=t))),u(t,vt,(t=>n(15,d=t)));let f=0;let p="",m=!1;function h(t,e){(function(t,e,n){const s=new URLSearchParams;return s.append("token",n.token),s.append("cat","yes"),s.append("url",t),s.append("file",e),fetch(n.endpoint,{method:"post",body:s}).then((t=>t.json())).then((t=>t.result))})(t,e.split("?")[0],d).then((t=>{n(2,p=t)})),n(3,m=!0)}return t.$$.update=()=>{if(128&t.$$.dirty&&n(6,s=new Date(l.dueDate+" 23:59:59").getTime()),1856&t.$$.dirty&&n(1,o=r.map((t=>{return Object.assign(Object.assign({},t),{lastModified:(e=i,n=t.url,e[n=n.split("?")[0]]||e[n+"index.html"]||e[n+"index.htm"]||e[n+"index.php"]),displayUrl:t.url.split(a.username)[1]||t.url});var e,n})).map((t=>Object.assign(Object.assign({},t),{daysLate:_n(t.lastModified,s)})))),67&t.$$.dirty){const t=o.filter((t=>!!t.lastModified)).map((t=>_n(t.lastModified,s)));n(0,f=Math.max(...t)),n(0,f=isFinite(f)?f:0)}},[f,o,p,m,function(){c(kt,r=[],r)},h,s,l,r,i,a,t=>{h(t.url,t.displayUrl)},()=>{n(3,m=!1)},()=>{n(3,m=!0)},()=>{n(3,m=!1)}]}class On extends mt{constructor(t){super(),pt(this,t,Sn,Cn,r,{})}}function In(t){let e,n,s,l,r,u,c,i,a,d,f,p,$,w,x,_,D,j,U,E,P,M,N,L,T,R,q,F,z,H,Y,G,J,B,K,V,Z,Q,X=t[1].number+"",tt=t[0].username+"";function et(e){t[11].call(null,e)}L=new rn({}),R=new fn({}),F=new On({});let nt={embeddedUrl:t[4]};return void 0!==t[2]&&(nt.iframeRef=t[2]),Y=new Ke({props:nt}),A.push((()=>ct(Y,"iframeRef",et))),{c(){e=v("div"),n=v("div"),s=v("h1"),l=b("Grading homework "),r=b(X),u=y(),c=v("div"),i=v("div"),a=b("Due "),d=v("input"),f=y(),p=v("button"),p.textContent="Discard all progress",$=y(),w=v("h2"),x=v("div"),_=v("code"),D=b(tt),j=b("\n\t\t\t\t("),U=b(t[3]),E=b("%)"),P=y(),M=v("button"),M.textContent="Reset and regrade",N=y(),it(L.$$.fragment),T=y(),it(R.$$.fragment),q=y(),it(F.$$.fragment),z=y(),H=v("div"),it(Y.$$.fragment),J=y(),B=v("div"),K=v("div"),C(s,"class","svelte-1sd7iy0"),C(d,"type","date"),C(c,"class","split"),C(w,"class","split"),C(n,"class","sidebar svelte-1sd7iy0"),C(H,"class","browser svelte-1sd7iy0"),C(e,"class","wrapper svelte-1sd7iy0"),I(K,"width",100*t[5]+"%"),C(K,"class","svelte-1sd7iy0"),C(B,"class","progress svelte-1sd7iy0")},m(o,g){h(o,e,g),m(e,n),m(n,s),m(s,l),m(s,r),m(n,u),m(n,c),m(c,i),m(i,a),m(i,d),O(d,t[1].dueDate),m(c,f),m(c,p),m(n,$),m(n,w),m(w,x),m(x,_),m(_,D),m(x,j),m(x,U),m(x,E),m(w,P),m(w,M),m(n,N),at(L,n,null),m(n,T),at(R,n,null),m(n,q),at(F,n,null),m(e,z),m(e,H),at(Y,H,null),h(o,J,g),h(o,B,g),m(B,K),V=!0,Z||(Q=[k(d,"input",t[10]),k(p,"click",t[7]),k(M,"click",t[6])],Z=!0)},p(t,[e]){(!V||2&e)&&X!==(X=t[1].number+"")&&S(r,X),2&e&&O(d,t[1].dueDate),(!V||1&e)&&tt!==(tt=t[0].username+"")&&S(D,tt),(!V||8&e)&&S(U,t[3]);const n={};16&e&&(n.embeddedUrl=t[4]),!G&&4&e&&(G=!0,n.iframeRef=t[2],W((()=>G=!1))),Y.$set(n),(!V||32&e)&&I(K,"width",100*t[5]+"%")},i(t){V||(ot(L.$$.fragment,t),ot(R.$$.fragment,t),ot(F.$$.fragment,t),ot(Y.$$.fragment,t),V=!0)},o(t){lt(L.$$.fragment,t),lt(R.$$.fragment,t),lt(F.$$.fragment,t),lt(Y.$$.fragment,t),V=!1},d(t){t&&g(e),dt(L),dt(R),dt(F),dt(Y),t&&g(J),t&&g(B),Z=!1,o(Q)}}}function Dn(t,e,n){let s,o,l,r,i,a,d,f,p;u(t,yt,(t=>n(0,r=t))),u(t,bt,(t=>n(1,i=t))),u(t,vt,(t=>n(9,a=t))),u(t,kt,(t=>n(12,d=t))),u(t,xt,(t=>n(13,f=t))),u(t,Ct,(t=>n(14,p=t)));let m,h=r.username;return t.$$.update=()=>{3&t.$$.dirty&&n(3,s=zt(r.commentIds,i.possibleComments)),3&t.$$.dirty&&n(4,o=`${i.prefix}/${r.username}/`),514&t.$$.dirty&&n(5,l=i.students.length/(a.students.length+1)),257&t.$$.dirty&&h!==r.username&&(n(8,h=r.username),c(kt,d=[],d),c(xt,f={},f))},[r,i,m,s,o,l,function(){Yt({type:"clear-cookies",value:p}),c(bt,i.students=i.students.filter((t=>t.username!==r.username)),i),c(yt,r.commentIds=[],r),c(kt,d=[],d),n(2,m.src=o,m)},function(){confirm("Are you sure you want to discard all progress on this homework?")&&(c(bt,i=null,i),c(yt,r=null,r))},h,a,function(){i.dueDate=this.value,bt.set(i)},function(t){m=t,n(2,m)}]}class jn extends mt{constructor(t){super(),pt(this,t,Dn,In,r,{})}}function Un(t,e,n){let s,o,l,r,i;u(t,_t,(t=>n(0,s=t))),u(t,kt,(t=>n(1,o=t))),u(t,Ct,(t=>n(2,l=t))),u(t,xt,(t=>n(3,r=t))),u(t,vt,(t=>n(4,i=t)));const a=document.getElementById("comms"),d=new MutationObserver((t=>{function e(e){return!!t.find((t=>t.attributeName==="data-"+e))}if(e("deactivated"))c(_t,s=!1,s);else if(e("activated"))c(_t,s=!0,s);else if(e("newest-request")){const t=JSON.parse(a.dataset.newestRequest);c(kt,o=[t,...o],o)}else if(e("embedded-url")){const t=l;if(c(Ct,l=JSON.parse(a.dataset.embeddedUrl),l),Gt(t)!==Gt(l)){const t=l.substring(0,l.lastIndexOf("/"));c(xt,r={},r),function(t,e,n){const s=new URLSearchParams;return s.append("token",n.token),s.append("ls","yes"),s.append("url",t),fetch(n.endpoint,{method:"post",body:s}).then((t=>t.json())).then((t=>t.result.split("\n").map((t=>t.split(" "))).map((t=>[t.shift(),t.join(" ")])).map((([t,n])=>({name:e+n.replace("./","/"),time:new Date(1e3*parseFloat(t))})))))}(l,t,i).then((t=>{t.forEach((({name:t,time:e})=>{c(xt,r[encodeURI(t)]=e,r)})),xt.set(r)})).catch((t=>{}))}}}));return d.observe(a,{attributes:!0}),R((()=>{d.disconnect()})),[]}class En extends mt{constructor(t){super(),pt(this,t,Un,null,r,{})}}function Pn(e){let n,s,o,l,r,u,c,i;return{c(){n=v("h1"),n.textContent="Install extension",s=b("\n\nInstall the companion browser extension for\n"),o=v("a"),o.textContent="Firefox",l=b("\nor\n"),r=v("a"),r.textContent="Chrome",u=b("\nand\n\n"),c=v("a"),c.textContent="refresh",i=b("."),C(o,"href","https://github.com/jaflo/gradable/releases/latest/download/firefox-extension.xpi"),C(r,"href","https://chrome.google.com/webstore/detail/njijmdbjijgeodnhcnkknkeopbhfgpbg"),C(r,"target","_blank"),C(c,"href","")},m(t,e){h(t,n,e),h(t,s,e),h(t,o,e),h(t,l,e),h(t,r,e),h(t,u,e),h(t,c,e),h(t,i,e)},p:t,i:t,o:t,d(t){t&&g(n),t&&g(s),t&&g(o),t&&g(l),t&&g(r),t&&g(u),t&&g(c),t&&g(i)}}}class Mn extends mt{constructor(t){super(),pt(this,t,null,Pn,r,{})}}function Nn(e){let n;return{c(){n=b("Checking for plugin...")},m(t,e){h(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}function Ln(e){let n,s;return n=new Mn({}),{c(){it(n.$$.fragment)},m(t,e){at(n,t,e),s=!0},p:t,i(t){s||(ot(n.$$.fragment,t),s=!0)},o(t){lt(n.$$.fragment,t),s=!1},d(t){dt(n,t)}}}function Tn(t){let e,n,s,o;const l=[Fn,qn,Rn],r=[];function u(t,e){return null===t[2]?0:t[8]?1:2}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=w()},m(t,n){r[e].m(t,n),h(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e===c?r[e].p(t,o):(nt(),lt(r[c],1,1,(()=>{r[c]=null})),st(),n=r[e],n?n.p(t,o):(n=r[e]=l[e](t),n.c()),ot(n,1),n.m(s.parentNode,s))},i(t){o||(ot(n),o=!0)},o(t){lt(n),o=!1},d(t){r[e].d(t),t&&g(s)}}}function Rn(e){let n,s,o;return{c(){n=b("Plugin disconnected, did you open this website in another tab? Try\n\t\t"),s=v("a"),s.textContent="refreshing",o=b(" to retry."),C(s,"href","")},m(t,e){h(t,n,e),h(t,s,e),h(t,o,e)},p:t,i:t,o:t,d(t){t&&g(n),t&&g(s),t&&g(o)}}}function qn(t){let e,n,s,o;const l=[Yn,Hn,zn,An],r=[];function u(t,e){return t[5]===t[0].Pending?0:t[5]===t[0].UpToDate?1:t[5]===t[0].OutOfDate?2:3}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=w()},m(t,n){r[e].m(t,n),h(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e===c?r[e].p(t,o):(nt(),lt(r[c],1,1,(()=>{r[c]=null})),st(),n=r[e],n?n.p(t,o):(n=r[e]=l[e](t),n.c()),ot(n,1),n.m(s.parentNode,s))},i(t){o||(ot(n),o=!0)},o(t){lt(n),o=!1},d(t){r[e].d(t),t&&g(s)}}}function Fn(e){let n,s;return n=new $e({}),{c(){it(n.$$.fragment)},m(t,e){at(n,t,e),s=!0},p:t,i(t){s||(ot(n.$$.fragment,t),s=!0)},o(t){lt(n.$$.fragment,t),s=!1},d(t){dt(n,t)}}}function An(e){let n,s,l,r,u,c,i,a;return{c(){n=b("Failed to check server version: "),s=b(e[6]),l=b("\n\t\t\tNeed to reset your token? Run this:\n\t\t\t"),r=v("input"),u=b("\n\t\t\tand\n\t\t\t"),c=v("button"),c.textContent="Delete local config and set up again",r.readOnly=!0,C(r,"type","text"),r.value=e[7]},m(t,o){h(t,n,o),h(t,s,o),h(t,l,o),h(t,r,o),h(t,u,o),h(t,c,o),i||(a=[k(r,"click",Wt),k(r,"focus",Wt),k(c,"click",e[10])],i=!0)},p(t,e){64&e&&S(s,t[6]),128&e&&r.value!==t[7]&&(r.value=t[7])},i:t,o:t,d(t){t&&g(n),t&&g(s),t&&g(l),t&&g(r),t&&g(u),t&&g(c),i=!1,o(a)}}}function zn(e){let n,s,l,r;return{c(){n=b("Looks like your server script is out of date. Please run this\n\t\t\tcommand again:\n\t\t\t"),s=v("input"),s.readOnly=!0,C(s,"type","text"),s.value=te},m(t,e){h(t,n,e),h(t,s,e),l||(r=[k(s,"click",Wt),k(s,"focus",Wt)],l=!0)},p:t,i:t,o:t,d(t){t&&g(n),t&&g(s),l=!1,o(r)}}}function Hn(t){let e,n,s,o;const l=[Jn,Gn],r=[];function u(t,e){return null!==t[1]?0:1}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=w()},m(t,n){r[e].m(t,n),h(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e===c?r[e].p(t,o):(nt(),lt(r[c],1,1,(()=>{r[c]=null})),st(),n=r[e],n?n.p(t,o):(n=r[e]=l[e](t),n.c()),ot(n,1),n.m(s.parentNode,s))},i(t){o||(ot(n),o=!0)},o(t){lt(n),o=!1},d(t){r[e].d(t),t&&g(s)}}}function Yn(e){let n;return{c(){n=b("Checking server version...")},m(t,e){h(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}function Gn(e){let n,s;return n=new me({}),{c(){it(n.$$.fragment)},m(t,e){at(n,t,e),s=!0},p:t,i(t){s||(ot(n.$$.fragment,t),s=!0)},o(t){lt(n.$$.fragment,t),s=!1},d(t){dt(n,t)}}}function Jn(t){let e,n,s,o;const l=[Bn,Wn],r=[];function u(t,e){return null!==t[9]?0:1}return e=u(t),n=r[e]=l[e](t),{c(){n.c(),s=w()},m(t,n){r[e].m(t,n),h(t,s,n),o=!0},p(t,o){let c=e;e=u(t),e!==c&&(nt(),lt(r[c],1,1,(()=>{r[c]=null})),st(),n=r[e],n||(n=r[e]=l[e](t),n.c()),ot(n,1),n.m(s.parentNode,s))},i(t){o||(ot(n),o=!0)},o(t){lt(n),o=!1},d(t){r[e].d(t),t&&g(s)}}}function Wn(t){let e,n;return e=new Ce({}),{c(){it(e.$$.fragment)},m(t,s){at(e,t,s),n=!0},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Bn(t){let e,n;return e=new jn({}),{c(){it(e.$$.fragment)},m(t,s){at(e,t,s),n=!0},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Kn(t){let e,n,s,o,l;const r=[Tn,Ln,Nn],u=[];function c(t,e){return t[3]?0:t[4]?1:2}return e=c(t),n=u[e]=r[e](t),o=new En({}),{c(){n.c(),s=y(),it(o.$$.fragment)},m(t,n){u[e].m(t,n),h(t,s,n),at(o,t,n),l=!0},p(t,[o]){let l=e;e=c(t),e===l?u[e].p(t,o):(nt(),lt(u[l],1,1,(()=>{u[l]=null})),st(),n=u[e],n?n.p(t,o):(n=u[e]=r[e](t),n.c()),ot(n,1),n.m(s.parentNode,s))},i(t){l||(ot(n),ot(o.$$.fragment,t),l=!0)},o(t){lt(n),lt(o.$$.fragment,t),l=!1},d(t){u[e].d(t),t&&g(s),dt(o,t)}}}const Vn="gradable-plugin-present",Zn="gradable-reset.php";function Qn(t,e,n){let s,o,l,r,c,i;u(t,bt,(t=>n(1,o=t))),u(t,vt,(t=>n(2,l=t))),u(t,wt,(t=>n(12,r=t))),u(t,_t,(t=>n(8,c=t))),u(t,yt,(t=>n(9,i=t)));let a=document.body.classList.contains(Vn),d=!1;function f(){p(),Yt({type:"register-active"})}function p(){o&&Yt({type:"set-homework-number",value:o.number})}var m;setTimeout((()=>n(4,d=!0)),400),new MutationObserver(((t,e)=>{t.find((t=>"class"===t.attributeName))&&document.body.classList.contains(Vn)&&(n(3,a=!0),e.disconnect(),f())})).observe(document.body,{attributes:!0}),a&&f(),function(t){t[t.Pending=0]="Pending",t[t.OutOfDate=1]="OutOfDate",t[t.UpToDate=2]="UpToDate",t[t.Failed=3]="Failed"}(m||(m={}));let h=m.Pending,g="",$="";return t.$$.update=()=>{2&t.$$.dirty&&o&&o.number&&p(),4&t.$$.dirty&&n(7,s=l&&`cd ~/public_html\nwget -O gradable-reset.php "${Xt}server/gradable-reset.php"\nchmod 755 gradable-reset.php\ncurl ${l.endpoint.replace("gradable.php",Zn)}\nrm gradable-reset.php`.split("\n").join(" && ")),2053&t.$$.dirty&&l&&l.endpoint+l.token!==$&&(n(11,$=l.endpoint+l.token),function(t){const e=new URLSearchParams;return e.append("token",t.token),e.append("version","yes"),fetch(t.endpoint,{method:"post",body:e}).then((t=>t.json())).then((t=>{if(t.success)return!(t.version<6);throw new Error(t.status||t.message||"Server error")}))}(l).then((t=>n(5,h=t?m.UpToDate:m.OutOfDate))).catch((t=>{n(5,h=m.Failed),n(6,g=t)})))},[m,o,l,a,d,h,g,s,c,i,function(){ae(r.length)},$]}return new class extends mt{constructor(t){super(),pt(this,t,Qn,Kn,r,{})}}({target:document.body})}();
