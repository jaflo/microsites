var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const c="undefined"!=typeof window;let l=c?()=>window.performance.now():()=>Date.now(),u=c?t=>requestAnimationFrame(t):t;const a=new Set;function d(t){a.forEach(e=>{e.c(t)||(a.delete(e),e.f())}),0!==a.size&&u(d)}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function y(){return g(" ")}function v(){return g("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t,e){e=""+e,t.data!==e&&(t.data=e)}function _(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function x(t,e,n){t.classList[n?"add":"remove"](e)}const k=new Set;let j,z=0;function E(t,e,n,o,s,r,i,c=0){const l=16.666/o;let u="{\n";for(let t=0;t<=1;t+=l){const o=e+(n-e)*r(t);u+=100*t+`%{${i(o,1-o)}}\n`}const a=u+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${c}`,f=t.ownerDocument;k.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(h("style")).sheet),m=f.__svelte_rules||(f.__svelte_rules={});m[d]||(m[d]=!0,p.insertRule(`@keyframes ${d} ${a}`,p.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${d} ${o}ms linear ${s}ms 1 both`,z+=1,d}function C(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-o.length;s&&(t.style.animation=o.join(", "),z-=s,z||u(()=>{z||(k.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),k.clear())}))}function S(t){j=t}function N(t){(function(){if(!j)throw new Error("Function called outside component initialization");return j})().$$.on_mount.push(t)}const T=[],O=[],F=[],M=[],P=Promise.resolve();let A=!1;function q(t){F.push(t)}let J=!1;const L=new Set;function R(){if(!J){J=!0;do{for(let t=0;t<T.length;t+=1){const e=T[t];S(e),W(e.$$)}for(T.length=0;O.length;)O.pop()();for(let t=0;t<F.length;t+=1){const e=F[t];L.has(e)||(L.add(e),e())}F.length=0}while(T.length);for(;M.length;)M.pop()();A=!1,J=!1,L.clear()}}function W(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(q)}}let D;function H(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const B=new Set;let G;function I(){G={r:0,c:[],p:G}}function K(){G.r||s(G.c),G=G.p}function Q(t,e){t&&t.i&&(B.delete(t),t.i(e))}function U(t,e,n,o){if(t&&t.o){if(B.has(t))return;B.add(t),G.c.push(()=>{B.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const V={duration:0};function X(n,o,i,c){let f=o(n,i),p=c?0:1,m=null,h=null,g=null;function y(){g&&C(n,g)}function v(t,e){const n=t.b-p;return e*=Math.abs(n),{a:p,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function $(o){const{delay:r=0,duration:i=300,easing:c=e,tick:$=t,css:b}=f||V,w={start:l()+r,b:o};o||(w.group=G,G.r+=1),m?h=w:(b&&(y(),g=E(n,p,o,i,r,c,b)),o&&$(0,1),m=v(w,i),q(()=>H(n,o,"start")),function(t){let e;0===a.size&&u(d),new Promise(n=>{a.add(e={c:t,f:n})})}(t=>{if(h&&t>h.start&&(m=v(h,i),h=null,H(n,m.b,"start"),b&&(y(),g=E(n,p,m.b,m.duration,0,c,f.css))),m)if(t>=m.end)$(p=m.b,1-p),H(n,m.b,"end"),h||(m.b?y():--m.group.r||s(m.group.c)),m=null;else if(t>=m.start){const e=t-m.start;p=m.a+m.d*c(e/m.duration),$(p,1-p)}return!(!m&&!h)}))}return{run(t){r(f)?(D||(D=Promise.resolve(),D.then(()=>{D=null})),D).then(()=>{f=f(),$(t)}):$(t)},end(){y(),m=h=null}}}const Y="undefined"!=typeof window?window:global;function Z(t){t&&t.c()}function tt(t,e,o){const{fragment:i,on_mount:c,on_destroy:l,after_update:u}=t.$$;i&&i.m(e,o),q(()=>{const e=c.map(n).filter(r);l?l.push(...e):s(e),t.$$.on_mount=[]}),u.forEach(q)}function et(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nt(t,e){-1===t.$$.dirty[0]&&(T.push(t),A||(A=!0,P.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ot(e,n,r,i,c,l,u=[-1]){const a=j;S(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:o(),dirty:u};let p=!1;if(f.ctx=r?r(e,d,(t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&c(f.ctx[t],f.ctx[t]=s)&&(f.bound[t]&&f.bound[t](s),p&&nt(e,t)),n}):[],f.update(),p=!0,s(f.before_update),f.fragment=!!i&&i(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&Q(e.$$.fragment),tt(e,n.target,n.anchor),R()}S(a)}class st{$destroy(){et(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function rt(t,{delay:n=0,duration:o=400,easing:s=e}){const r=+getComputedStyle(t).opacity;return{delay:n,duration:o,easing:s,css:t=>`opacity: ${t*r}`}}let it,ct;function lt(t){for(var e=0,n=0;e<t.length;e++)n=Math.imul(31,n)+t.charCodeAt(e)|0;return n}const ut=new WebSocket("wss://hkyr582gyb.execute-api.us-east-1.amazonaws.com/dev");let at=2,dt=[];ut.onopen=function(t){at--,0==at&&dt.forEach(mt)},ut.onerror=function(t){console.error("WebSocket error:",t)};let ft={};function pt(t,e){ft[t]=e}function mt(t,e){(e=e||{}).type=t,at>0?dt.push(e):(e=JSON.stringify(e),e=JSON.stringify({target:it,content:e,signature:lt(it+":"+ct+":"+e)}),ut.send(JSON.stringify({action:"fanout",message:btoa(e)})))}ut.onmessage=function(t){const e=JSON.parse(atob(t.data)),n=lt(it+":"+ct+":"+e.content);if(e.target==it&&e.signature==n){const t=JSON.parse(e.content);console.log(t),t.type in ft&&ft[t.type](t)}};const{isNaN:ht}=Y;function gt(t){let e,n,o,r,i,c,l,u,a,d,v,k,j,z,E,C,S,N,T,O,F,M,P,A,q,J,L,R,W,D=t[4]?"play_arrow":"pause",H=$t(t[1])+"",B=$t(t[2])+"",G=t[7]?"fullscreen_exit":"fullscreen",V=t[0]<1&&yt(t);return{c(){e=h("div"),n=h("div"),n.textContent="paused",o=y(),r=h("div"),i=h("div"),c=y(),l=h("div"),u=h("button"),a=h("i"),d=g(D),k=y(),j=h("button"),j.innerHTML='<i class="material-icons">replay_10</i>',z=y(),E=h("button"),E.innerHTML='<i class="material-icons">sync</i>',C=y(),S=h("div"),N=g(H),T=g("/"),O=g(B),F=y(),V&&V.c(),M=y(),P=h("div"),A=y(),q=h("button"),J=h("i"),L=g(G),b(n,"class","pause svelte-j2zpl7"),_(i,"width",t[1]/t[2]*100+"%"),b(i,"class","svelte-j2zpl7"),b(r,"class","progress svelte-j2zpl7"),b(e,"class","overlay svelte-j2zpl7"),b(a,"class","material-icons"),b(u,"title",v=t[4]?"Play":"Pause"),b(u,"class","main svelte-j2zpl7"),b(j,"title","Jump back 10 seconds"),b(j,"class","svelte-j2zpl7"),b(E,"title","Force sync"),b(E,"class","svelte-j2zpl7"),b(S,"class","duration svelte-j2zpl7"),b(P,"class","spacer svelte-j2zpl7"),b(J,"class","material-icons"),b(q,"title","Fullscreen"),b(q,"class","svelte-j2zpl7"),b(l,"class","controls svelte-j2zpl7"),x(l,"visible",t[8])},m(m,h,g){p(m,e,h),f(e,n),f(e,o),f(e,r),f(r,i),p(m,c,h),p(m,l,h),f(l,u),f(u,a),f(a,d),f(l,k),f(l,j),f(l,z),f(l,E),f(l,C),f(l,S),f(S,N),f(S,T),f(S,O),f(l,F),V&&V.m(l,null),f(l,M),f(l,P),f(l,A),f(l,q),f(q,J),f(J,L),R=!0,g&&s(W),W=[$(e,"click",t[10]),$(u,"click",t[10]),$(j,"click",t[11]),$(E,"click",t[9]),$(q,"click",t[12])]},p(t,e){(!R||6&e)&&_(i,"width",t[1]/t[2]*100+"%"),(!R||16&e)&&D!==(D=t[4]?"play_arrow":"pause")&&w(d,D),(!R||16&e&&v!==(v=t[4]?"Play":"Pause"))&&b(u,"title",v),(!R||2&e)&&H!==(H=$t(t[1])+"")&&w(N,H),(!R||4&e)&&B!==(B=$t(t[2])+"")&&w(O,B),t[0]<1?V?(V.p(t,e),Q(V,1)):(V=yt(t),V.c(),Q(V,1),V.m(l,M)):V&&(I(),U(V,1,1,()=>{V=null}),K()),(!R||128&e)&&G!==(G=t[7]?"fullscreen_exit":"fullscreen")&&w(L,G),256&e&&x(l,"visible",t[8])},i(t){R||(Q(V),R=!0)},o(t){U(V),R=!1},d(t){t&&m(e),t&&m(c),t&&m(l),V&&V.d(),s(W)}}}function yt(t){let e,n,o,s,r,i=(100*t[0]).toFixed(2)+"";return{c(){e=h("div"),n=g(i),o=g("%"),b(e,"class","downloaded svelte-j2zpl7"),b(e,"title","Download progress")},m(t,s){p(t,e,s),f(e,n),f(e,o),r=!0},p(t,e){(!r||1&e)&&i!==(i=(100*t[0]).toFixed(2)+"")&&w(n,i)},i(t){r||(q(()=>{s||(s=X(e,rt,{},!0)),s.run(1)}),r=!0)},o(t){s||(s=X(e,rt,{},!1)),s.run(0),r=!1},d(t){t&&m(e),t&&s&&s.end()}}}function vt(t){let e,n,o,r,i,c,l,a,d=!1,g=!0;function v(){cancelAnimationFrame(o),n.paused||(o=u(v),d=!0),t[18].call(n)}let w=t[3]&&gt(t);return{c(){e=h("div"),n=h("video"),r=y(),i=h("button"),c=y(),w&&w.c(),n.autoplay="true",b(n,"class","svelte-j2zpl7"),void 0===t[2]&&q(()=>t[19].call(n)),b(i,"class","dummy svelte-j2zpl7"),b(e,"class","wrapper svelte-j2zpl7"),x(e,"paused",t[4]),x(e,"hidecursor",!t[8])},m(o,u,d){p(o,e,u),f(e,n),t[21](n),f(e,r),f(e,i),t[22](i),f(e,c),w&&w.m(e,null),t[23](e),l=!0,d&&s(a),a=[$(window,"keydown",t[14]),$(n,"timeupdate",v),$(n,"durationchange",t[19]),$(n,"play",t[20]),$(n,"pause",t[20]),$(e,"mousemove",t[13])]},p(t,[o]){!d&&2&o&&!ht(t[1])&&(n.currentTime=t[1]),d=!1,16&o&&g!==(g=t[4])&&n[g?"pause":"play"](),t[3]?w?(w.p(t,o),Q(w,1)):(w=gt(t),w.c(),Q(w,1),w.m(e,null)):w&&(I(),U(w,1,1,()=>{w=null}),K()),16&o&&x(e,"paused",t[4]),256&o&&x(e,"hidecursor",!t[8])},i(t){l||(Q(w),l=!0)},o(t){U(w),l=!1},d(n){n&&m(e),t[21](null),t[22](null),w&&w.d(),t[23](null),s(a)}}}function $t(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function bt(t,e,n){let o,s,r,i,c,l,{file:u}=e,{progress:a=0}=e,d=!1;function f(){l.focus()}function p(){mt("set paused",{paused:!r.paused}),f()}function m(){n(7,d=document.fullscreenElement),d?document.exitFullscreen():c.requestFullscreen(),f()}N(()=>{u.renderTo(r,(t,e)=>{e.play(),e.controls=!1,mt("sync request"),f()}),r.play(),n(3,r.controls=!1,r)}),pt("sync request",()=>{mt("sync",{paused:r.paused,currentTime:o})}),pt("sync",t=>{r.paused!=t.paused&&(t.paused?r.pause():r.play()),Math.abs(o-t.currentTime)>.5&&n(1,o=t.currentTime)}),pt("set paused",t=>{t.paused?r.pause():r.play()}),pt("jump back",t=>{n(1,o=t.destTime)});let h,g=!0;return t.$set=t=>{"file"in t&&n(15,u=t.file),"progress"in t&&n(0,a=t.progress)},[a,o,s,r,i,c,l,d,g,function(){mt("sync request"),f()},p,function(){mt("jump back",{destTime:Math.max(0,o-10)}),f()},m,function(t){clearTimeout(h),h=setTimeout(()=>n(8,g=!1),2500),n(8,g=!0)},function(t){70==t.keyCode?m():32==t.keyCode&&p()},u,h,f,function(){o=this.currentTime,n(1,o)},function(){s=this.duration,n(2,s)},function(){i=this.paused,n(4,i)},function(t){O[t?"unshift":"push"](()=>{n(3,r=t)})},function(t){O[t?"unshift":"push"](()=>{n(6,l=t)})},function(t){O[t?"unshift":"push"](()=>{n(5,c=t)})}]}class wt extends st{constructor(t){super(),ot(this,t,bt,vt,i,{file:15,progress:0})}}function _t(e){let n;return{c(){n=h("div"),b(n,"class","spinner svelte-5hc1l6")},m(t,e){p(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function xt(t){let e;const n=new wt({props:{file:t[0],progress:t[1]}});return{c(){Z(n.$$.fragment)},m(t,o){tt(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.file=t[0]),2&e&&(o.progress=t[1]),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){U(n.$$.fragment,t),e=!1},d(t){et(n,t)}}}function kt(t){let e,n,o,s;const r=[xt,_t],i=[];function c(t,e){return t[0]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=v()},m(t,n){i[e].m(t,n),p(t,o,n),s=!0},p(t,[s]){let l=e;e=c(t),e===l?i[e].p(t,s):(I(),U(i[l],1,1,()=>{i[l]=null}),K(),n=i[e],n||(n=i[e]=r[e](t),n.c()),Q(n,1),n.m(o.parentNode,o))},i(t){s||(Q(n),s=!0)},o(t){U(n),s=!1},d(t){i[e].d(t),t&&m(o)}}}function jt(t,e,n){const o=new WebTorrent;let s,r=0,i=0,c=0;return o.add(ct,(function(t){function e(){r=t.uploadSpeed,i=t.downloadSpeed,n(1,c=t.progress)}console.log("Client is downloading:",t.infoHash),n(0,s=t.files[0]),t.on("download",e),t.on("upload",e)})),[s,c]}class zt extends st{constructor(t){super(),ot(this,t,jt,kt,i,{})}}function Et(t){let e,n,o,s,r,i,c;let l=function(t,e){return t[2]?St:Ct}(t)(t),u=t[0]&&Nt();return{c(){e=h("h2"),e.textContent="Join Existing",n=y(),o=h("p"),o.textContent="The video is not hosted by us and is shared directly by the participants. Make sure you trust this group.",s=y(),l.c(),r=y(),u&&u.c(),i=v()},m(t,a){p(t,e,a),p(t,n,a),p(t,o,a),p(t,s,a),l.m(t,a),p(t,r,a),u&&u.m(t,a),p(t,i,a),c=!0},p(t,e){l.p(t,e),t[0]?u?Q(u,1):(u=Nt(),u.c(),Q(u,1),u.m(i.parentNode,i)):u&&(I(),U(u,1,1,()=>{u=null}),K())},i(t){c||(Q(u),c=!0)},o(t){U(u),c=!1},d(t){t&&m(e),t&&m(n),t&&m(o),t&&m(s),l.d(t),t&&m(r),u&&u.d(t),t&&m(i)}}}function Ct(t){let e,n,o;return{c(){e=h("button"),n=g("Play video"),b(e,"class","primary"),e.disabled=t[0]},m(s,r,i){p(s,e,r),f(e,n),i&&o(),o=$(e,"click",t[3])},p(t,n){1&n&&(e.disabled=t[0])},d(t){t&&m(e),o()}}}function St(e){let n;return{c(){n=h("p"),n.textContent="Sadly the website does not support Safari. While playback works, syncing does not. Please use Chrome or\n\t\t\tFirefox."},m(t,e){p(t,n,e)},p:t,d(t){t&&m(n)}}}function Nt(t){let e,n,o;const s=new zt({});return{c(){e=h("div"),Z(s.$$.fragment),b(e,"class","cover svelte-6qgdwi")},m(t,n){p(t,e,n),tt(s,e,null),o=!0},i(t){o||(Q(s.$$.fragment,t),q(()=>{n||(n=X(e,rt,{},!0)),n.run(1)}),o=!0)},o(t){U(s.$$.fragment,t),n||(n=X(e,rt,{},!1)),n.run(0),o=!1},d(t){t&&m(e),et(s),t&&n&&n.end()}}}function Tt(t){let e,n,o=t[1]&&Et(t);return{c(){o&&o.c(),e=v()},m(t,s){o&&o.m(t,s),p(t,e,s),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),Q(o,1)):(o=Et(t),o.c(),Q(o,1),o.m(e.parentNode,e)):o&&(I(),U(o,1,1,()=>{o=null}),K())},i(t){n||(Q(o),n=!0)},o(t){U(o),n=!1},d(t){o&&o.d(t),t&&m(e)}}}function Ot(t,e,n){let o,s=!1;const r=window.location.hash,i=navigator.userAgent.toLowerCase(),c=-1!=i.indexOf("safari")&&-1==i.indexOf("chrome");return r&&(o=r.substr(1)),[s,o,c,function(){var t;t=o,[it,ct]=t.split("+"),ct="magnet:?"+atob(ct),at--,0==at&&dt.forEach(mt),n(0,s=!0)}]}return new class extends st{constructor(t){super(),ot(this,t,Ot,Tt,i,{})}}({target:document.querySelector("#join .app")})}();
//# sourceMappingURL=bundle.js.map
