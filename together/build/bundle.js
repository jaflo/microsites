var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const i="undefined"!=typeof window;let u=i?()=>window.performance.now():()=>Date.now(),l=i?t=>requestAnimationFrame(t):t;const a=new Set;function d(t){a.forEach(e=>{e.c(t)||(a.delete(e),e.f())}),0!==a.size&&l(d)}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function g(){return y(" ")}function v(){return y("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t,e){e=""+e,t.data!==e&&(t.data=e)}function w(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function _(t,e,n){t.classList[n?"add":"remove"](e)}function k(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}const E=new Set;let C,S=0;function T(t,e,n,o,s,r,c,i=0){const u=16.666/o;let l="{\n";for(let t=0;t<=1;t+=u){const o=e+(n-e)*r(t);l+=100*t+`%{${c(o,1-o)}}\n`}const a=l+`100% {${c(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${i}`,f=t.ownerDocument;E.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(h("style")).sheet),m=f.__svelte_rules||(f.__svelte_rules={});m[d]||(m[d]=!0,p.insertRule(`@keyframes ${d} ${a}`,p.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${d} ${o}ms linear ${s}ms 1 both`,S+=1,d}function N(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-o.length;s&&(t.style.animation=o.join(", "),S-=s,S||l(()=>{S||(E.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),E.clear())}))}function F(t){C=t}function O(){if(!C)throw new Error("Function called outside component initialization");return C}const q=[],M=[],P=[],A=[],J=Promise.resolve();let j=!1;function L(t){P.push(t)}let z=!1;const R=new Set;function W(){if(!z){z=!0;do{for(let t=0;t<q.length;t+=1){const e=q[t];F(e),D(e.$$)}for(q.length=0;M.length;)M.pop()();for(let t=0;t<P.length;t+=1){const e=P[t];R.has(e)||(R.add(e),e())}P.length=0}while(q.length);for(;A.length;)A.pop()();j=!1,z=!1,R.clear()}}function D(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}let H;function B(t,e,n){t.dispatchEvent(k(`${e?"intro":"outro"}${n}`))}const I=new Set;let Y;function G(){Y={r:0,c:[],p:Y}}function K(){Y.r||s(Y.c),Y=Y.p}function Q(t,e){t&&t.i&&(I.delete(t),t.i(e))}function U(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),Y.c.push(()=>{I.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const V={duration:0};function X(n,o,c,i){let f=o(n,c),p=i?0:1,m=null,h=null,y=null;function g(){y&&N(n,y)}function v(t,e){const n=t.b-p;return e*=Math.abs(n),{a:p,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function $(o){const{delay:r=0,duration:c=300,easing:i=e,tick:$=t,css:b}=f||V,x={start:u()+r,b:o};o||(x.group=Y,Y.r+=1),m?h=x:(b&&(g(),y=T(n,p,o,c,r,i,b)),o&&$(0,1),m=v(x,c),L(()=>B(n,o,"start")),function(t){let e;0===a.size&&l(d),new Promise(n=>{a.add(e={c:t,f:n})})}(t=>{if(h&&t>h.start&&(m=v(h,c),h=null,B(n,m.b,"start"),b&&(g(),y=T(n,p,m.b,m.duration,0,i,f.css))),m)if(t>=m.end)$(p=m.b,1-p),B(n,m.b,"end"),h||(m.b?g():--m.group.r||s(m.group.c)),m=null;else if(t>=m.start){const e=t-m.start;p=m.a+m.d*i(e/m.duration),$(p,1-p)}return!(!m&&!h)}))}return{run(t){r(f)?(H||(H=Promise.resolve(),H.then(()=>{H=null})),H).then(()=>{f=f(),$(t)}):$(t)},end(){g(),m=h=null}}}const Z="undefined"!=typeof window?window:global;function tt(t){t&&t.c()}function et(t,e,o){const{fragment:c,on_mount:i,on_destroy:u,after_update:l}=t.$$;c&&c.m(e,o),L(()=>{const e=i.map(n).filter(r);u?u.push(...e):s(e),t.$$.on_mount=[]}),l.forEach(L)}function nt(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ot(t,e){-1===t.$$.dirty[0]&&(q.push(t),j||(j=!0,J.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function st(e,n,r,c,i,u,l=[-1]){const a=C;F(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:i,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:o(),dirty:l};let p=!1;if(f.ctx=r?r(e,d,(t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&i(f.ctx[t],f.ctx[t]=s)&&(f.bound[t]&&f.bound[t](s),p&&ot(e,t)),n}):[],f.update(),p=!0,s(f.before_update),f.fragment=!!c&&c(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&Q(e.$$.fragment),et(e,n.target,n.anchor),W()}F(a)}class rt{$destroy(){nt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function ct(t,{delay:n=0,duration:o=400,easing:s=e}){const r=+getComputedStyle(t).opacity;return{delay:n,duration:o,easing:s,css:t=>`opacity: ${t*r}`}}let it,ut;function lt(t){for(var e=0,n=0;e<t.length;e++)n=Math.imul(31,n)+t.charCodeAt(e)|0;return n}const at=new WebSocket("wss://hkyr582gyb.execute-api.us-east-1.amazonaws.com/dev");let dt=2,ft=[];at.onopen=function(t){dt--,0==dt&&ft.forEach(ht)},at.onerror=function(t){console.error("WebSocket error:",t)};let pt={};function mt(t,e){pt[t]=e}function ht(t,e){(e=e||{}).type=t,dt>0?ft.push(e):(e=JSON.stringify(e),e=JSON.stringify({target:it,content:e,signature:lt(it+":"+ut+":"+e)}),at.send(JSON.stringify({action:"fanout",message:btoa(e)})))}at.onmessage=function(t){const e=JSON.parse(atob(t.data)),n=lt(it+":"+ut+":"+e.content);if(e.target==it&&e.signature==n){const t=JSON.parse(e.content);t.type in pt&&pt[t.type](t)}};const{isNaN:yt}=Z;function gt(t){let e,n,o,r,c,i,u,l,a,d,v,k,E,C,S,T,N,F,O,q,M,P,A,J,j,L,z,R,W,D,H=t[4]?"play_arrow":"pause",B=xt(t[1])+"",I=xt(t[2])+"",Y=t[7]?"fullscreen_exit":"fullscreen",V=t[8]&&vt(t),X=t[0]<1&&$t(t);return{c(){e=h("div"),n=h("div"),n.textContent="paused",o=g(),r=h("div"),c=h("div"),i=g(),V&&V.c(),u=g(),l=h("div"),a=h("button"),d=h("i"),v=y(H),E=g(),C=h("button"),C.innerHTML='<i class="material-icons">replay_10</i>',S=g(),T=h("button"),T.innerHTML='<i class="material-icons">sync</i>',N=g(),F=h("div"),O=y(B),q=y("/"),M=y(I),P=g(),X&&X.c(),A=g(),J=h("div"),j=g(),L=h("button"),z=h("i"),R=y(Y),b(n,"class","pause svelte-2x2nic"),w(c,"width",t[1]/t[2]*100+"%"),b(c,"class","svelte-2x2nic"),b(r,"class","progress svelte-2x2nic"),b(e,"class","overlay svelte-2x2nic"),b(d,"class","material-icons"),b(a,"title",k=t[4]?"Play":"Pause"),b(a,"class","main svelte-2x2nic"),b(C,"title","Jump back 10 seconds"),b(C,"class","svelte-2x2nic"),b(T,"title","Force sync"),b(T,"class","svelte-2x2nic"),b(F,"class","duration svelte-2x2nic"),b(J,"class","spacer svelte-2x2nic"),b(z,"class","material-icons"),b(L,"title","Fullscreen"),b(L,"class","svelte-2x2nic"),b(l,"class","controls svelte-2x2nic"),_(l,"visible",t[9])},m(m,h,y){p(m,e,h),f(e,n),f(e,o),f(e,r),f(r,c),p(m,i,h),V&&V.m(m,h),p(m,u,h),p(m,l,h),f(l,a),f(a,d),f(d,v),f(l,E),f(l,C),f(l,S),f(l,T),f(l,N),f(l,F),f(F,O),f(F,q),f(F,M),f(l,P),X&&X.m(l,null),f(l,A),f(l,J),f(l,j),f(l,L),f(L,z),f(z,R),W=!0,y&&s(D),D=[$(e,"click",t[11]),$(a,"click",t[11]),$(C,"click",t[12]),$(T,"click",t[10]),$(L,"click",t[13])]},p(t,e){(!W||6&e)&&w(c,"width",t[1]/t[2]*100+"%"),t[8]?V?V.p(t,e):(V=vt(t),V.c(),V.m(u.parentNode,u)):V&&(V.d(1),V=null),(!W||16&e)&&H!==(H=t[4]?"play_arrow":"pause")&&x(v,H),(!W||16&e&&k!==(k=t[4]?"Play":"Pause"))&&b(a,"title",k),(!W||2&e)&&B!==(B=xt(t[1])+"")&&x(O,B),(!W||4&e)&&I!==(I=xt(t[2])+"")&&x(M,I),t[0]<1?X?(X.p(t,e),Q(X,1)):(X=$t(t),X.c(),Q(X,1),X.m(l,A)):X&&(G(),U(X,1,1,()=>{X=null}),K()),(!W||128&e)&&Y!==(Y=t[7]?"fullscreen_exit":"fullscreen")&&x(R,Y),512&e&&_(l,"visible",t[9])},i(t){W||(Q(X),W=!0)},o(t){U(X),W=!1},d(t){t&&m(e),t&&m(i),V&&V.d(t),t&&m(u),t&&m(l),X&&X.d(),s(D)}}}function vt(e){let n,o;return{c(){n=h("div"),n.textContent="Your browser seems to be having issues. Switch to Chrome or Firefox for a better experience.",b(n,"class","syncwarning svelte-2x2nic")},m(t,s,r){p(t,n,s),r&&o(),o=$(n,"click",e[28])},p:t,d(t){t&&m(n),o()}}}function $t(t){let e,n,o,s,r,c=(100*t[0]).toFixed(2)+"";return{c(){e=h("div"),n=y(c),o=y("%"),b(e,"class","downloaded svelte-2x2nic"),b(e,"title","Download progress")},m(t,s){p(t,e,s),f(e,n),f(e,o),r=!0},p(t,e){(!r||1&e)&&c!==(c=(100*t[0]).toFixed(2)+"")&&x(n,c)},i(t){r||(L(()=>{s||(s=X(e,ct,{},!0)),s.run(1)}),r=!0)},o(t){s||(s=X(e,ct,{},!1)),s.run(0),r=!1},d(t){t&&m(e),t&&s&&s.end()}}}function bt(t){let e,n,o,r,c,i,u,a,d=!1,y=!0;function v(){cancelAnimationFrame(o),n.paused||(o=l(v),d=!0),t[23].call(n)}let x=t[3]&&gt(t);return{c(){e=h("div"),n=h("video"),r=g(),c=h("button"),i=g(),x&&x.c(),n.autoplay="true",b(n,"class","svelte-2x2nic"),void 0===t[2]&&L(()=>t[24].call(n)),b(c,"class","dummy svelte-2x2nic"),b(e,"class","wrapper svelte-2x2nic"),_(e,"paused",t[4]),_(e,"hidecursor",!t[9])},m(o,l,d){p(o,e,l),f(e,n),t[26](n),f(e,r),f(e,c),t[27](c),f(e,i),x&&x.m(e,null),t[29](e),u=!0,d&&s(a),a=[$(window,"keydown",t[15]),$(n,"timeupdate",v),$(n,"durationchange",t[24]),$(n,"play",t[25]),$(n,"pause",t[25]),$(e,"mousemove",t[14])]},p(t,[o]){!d&&2&o&&!yt(t[1])&&(n.currentTime=t[1]),d=!1,16&o&&y!==(y=t[4])&&n[y?"pause":"play"](),t[3]?x?(x.p(t,o),Q(x,1)):(x=gt(t),x.c(),Q(x,1),x.m(e,null)):x&&(G(),U(x,1,1,()=>{x=null}),K()),16&o&&_(e,"paused",t[4]),512&o&&_(e,"hidecursor",!t[9])},i(t){u||(Q(x),u=!0)},o(t){U(x),u=!1},d(n){n&&m(e),t[26](null),t[27](null),x&&x.d(),t[29](null),s(a)}}}function xt(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function wt(t,e,n){let{file:o}=e,{progress:s=0}=e;const r=function(){const t=O();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=k(e,n);o.slice().forEach(e=>{e.call(t,s)})}}}();let c,i,u,l,a,d,f=!1,p=!1,m=0,h=0,y=!1;function g(){d.focus()}var v;function $(){ht("sync request"),g()}function b(){ht("set paused",{paused:!u.paused}),g()}function x(){n(7,f=document.fullscreenElement),f?document.exitFullscreen():a.requestFullscreen(),g()}v=()=>{o.renderTo(u,(t,e)=>{e.controls=!1,g(),setInterval(()=>{y||(c<=m?(h++,h>=2&&n(8,y=!0),ht("sync request")):h=0),m=c},1e3),ht("sync request"),setTimeout($,5e3),r("loaded")}),u.play(),n(3,u.controls=!1,u)},O().$$.on_mount.push(v),mt("sync request",()=>{ht("sync",{paused:u.paused,currentTime:c})}),mt("sync",t=>{u.paused!=t.paused&&(t.paused?u.pause():u.play());const e=t.currentTime;e-c<-2?ht("sync request"):Math.abs(c-e)>.2&&n(1,c=e),m=e-1,p=!0}),mt("set paused",t=>{t.paused?u.pause():u.play()}),mt("jump back",t=>{m=t.destTime-1,n(1,c=t.destTime)});let w,_=!0;return t.$set=t=>{"file"in t&&n(16,o=t.file),"progress"in t&&n(0,s=t.progress)},[s,c,i,u,l,a,d,f,y,_,$,b,function(){p&&(ht("jump back",{destTime:Math.max(0,c-10)}),g())},x,function(t){clearTimeout(w),w=setTimeout(()=>n(9,_=!1),2500),n(9,_=!0)},function(t){70==t.keyCode?x():32==t.keyCode&&b()},o,p,m,h,w,r,g,function(){c=this.currentTime,n(1,c)},function(){i=this.duration,n(2,i)},function(){l=this.paused,n(4,l)},function(t){M[t?"unshift":"push"](()=>{n(3,u=t)})},function(t){M[t?"unshift":"push"](()=>{n(6,d=t)})},()=>{n(8,y=!1)},function(t){M[t?"unshift":"push"](()=>{n(5,a=t)})}]}class _t extends rt{constructor(t){super(),st(this,t,wt,bt,c,{file:16,progress:0})}}function kt(e){let n;return{c(){n=h("div"),b(n,"class","spinner svelte-5hc1l6")},m(t,e){p(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function Et(t){let e;const n=new _t({props:{file:t[0],progress:t[1]}});return n.$on("loaded",t[2]),{c(){tt(n.$$.fragment)},m(t,o){et(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.file=t[0]),2&e&&(o.progress=t[1]),n.$set(o)},i(t){e||(Q(n.$$.fragment,t),e=!0)},o(t){U(n.$$.fragment,t),e=!1},d(t){nt(n,t)}}}function Ct(t){let e,n,o,s;const r=[Et,kt],c=[];function i(t,e){return t[0]?0:1}return e=i(t),n=c[e]=r[e](t),{c(){n.c(),o=v()},m(t,n){c[e].m(t,n),p(t,o,n),s=!0},p(t,[s]){let u=e;e=i(t),e===u?c[e].p(t,s):(G(),U(c[u],1,1,()=>{c[u]=null}),K(),n=c[e],n||(n=c[e]=r[e](t),n.c()),Q(n,1),n.m(o.parentNode,o))},i(t){s||(Q(n),s=!0)},o(t){U(n),s=!1},d(t){c[e].d(t),t&&m(o)}}}function St(t,e,n){let o,s,r,c=0,i=0,u=0,l=5e3;return function t(){n(0,o=null),s&&s.destroy(),s=new WebTorrent,s.add(ut,(function(t){function e(){c=t.uploadSpeed,i=t.downloadSpeed,n(1,u=t.progress)}n(0,o=t.files[0]),t.on("download",e),t.on("upload",e)})),r=setTimeout(t,l),l+=2e3}(),[o,u,function(){clearTimeout(r)}]}class Tt extends rt{constructor(t){super(),st(this,t,St,Ct,c,{})}}function Nt(t){let e,n,o,s,r,c,i,u,l,a,d,x,w,_=t[3]&&function(t){let e;return{c(){e=h("p"),e.textContent="Sadly the website does not support well in Safari. While playback works, syncing does not. Please use Chrome\n\t\t\tor Firefox for a better experience."},m(t,n){p(t,e,n)},d(t){t&&m(e)}}}(),k=t[0]&&Ft();return{c(){e=h("h2"),e.textContent="Join Existing",n=g(),o=h("p"),o.textContent="The video is not hosted by us and is shared directly by the participants. Make sure you trust this group.",s=g(),_&&_.c(),r=g(),c=h("button"),i=y("Play video"),u=g(),l=h("video"),a=g(),k&&k.c(),d=v(),b(c,"class","primary"),c.disabled=t[0],b(l,"width","0"),b(l,"height","0")},m(m,h,y){p(m,e,h),p(m,n,h),p(m,o,h),p(m,s,h),_&&_.m(m,h),p(m,r,h),p(m,c,h),f(c,i),p(m,u,h),p(m,l,h),t[7](l),p(m,a,h),k&&k.m(m,h),p(m,d,h),x=!0,y&&w(),w=$(c,"click",t[4])},p(t,e){(!x||1&e)&&(c.disabled=t[0]),t[0]?k?Q(k,1):(k=Ft(),k.c(),Q(k,1),k.m(d.parentNode,d)):k&&(G(),U(k,1,1,()=>{k=null}),K())},i(t){x||(Q(k),x=!0)},o(t){U(k),x=!1},d(i){i&&m(e),i&&m(n),i&&m(o),i&&m(s),_&&_.d(i),i&&m(r),i&&m(c),i&&m(u),i&&m(l),t[7](null),i&&m(a),k&&k.d(i),i&&m(d),w()}}}function Ft(t){let e,n,o;const s=new Tt({});return{c(){e=h("div"),tt(s.$$.fragment),b(e,"class","cover svelte-1mqhnzt")},m(t,n){p(t,e,n),et(s,e,null),o=!0},i(t){o||(Q(s.$$.fragment,t),L(()=>{n||(n=X(e,ct,{},!0)),n.run(1)}),o=!0)},o(t){U(s.$$.fragment,t),n||(n=X(e,ct,{},!1)),n.run(0),o=!1},d(t){t&&m(e),nt(s),t&&n&&n.end()}}}function Ot(t){let e,n,o=t[1]&&Nt(t);return{c(){o&&o.c(),e=v()},m(t,s){o&&o.m(t,s),p(t,e,s),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),Q(o,1)):(o=Nt(t),o.c(),Q(o,1),o.m(e.parentNode,e)):o&&(G(),U(o,1,1,()=>{o=null}),K())},i(t){n||(Q(o),n=!0)},o(t){U(o),n=!1},d(t){o&&o.d(t),t&&m(e)}}}function qt(t,e,n){let o,s,r=!1;const c=window.location.hash,i=navigator.userAgent.toLowerCase(),u=-1!=i.indexOf("safari")&&-1==i.indexOf("chrome");return c&&(o=c.substr(1)),[r,o,s,u,function(){var t;t=o,[it,ut]=t.split("+"),ut="magnet:?"+atob(ut),dt--,0==dt&&ft.forEach(ht),n(0,r=!0),s.play()},c,i,function(t){M[t?"unshift":"push"](()=>{n(2,s=t)})}]}return new class extends rt{constructor(t){super(),st(this,t,qt,Ot,c,{})}}({target:document.querySelector("#join .app")})}();
//# sourceMappingURL=bundle.js.map
