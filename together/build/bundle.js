var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const c="undefined"!=typeof window;let u=c?()=>window.performance.now():()=>Date.now(),l=c?t=>requestAnimationFrame(t):t;const a=new Set;function d(t){a.forEach(e=>{e.c(t)||(a.delete(e),e.f())}),0!==a.size&&l(d)}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function g(){return y(" ")}function v(){return y("")}function w(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.data!==e&&(t.data=e)}function _(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function x(t,e,n){t.classList[n?"add":"remove"](e)}const k=new Set;let C,E=0;function S(t,e,n,o,s,r,i,c=0){const u=16.666/o;let l="{\n";for(let t=0;t<=1;t+=u){const o=e+(n-e)*r(t);l+=100*t+`%{${i(o,1-o)}}\n`}const a=l+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${c}`,f=t.ownerDocument;k.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(h("style")).sheet),m=f.__svelte_rules||(f.__svelte_rules={});m[d]||(m[d]=!0,p.insertRule(`@keyframes ${d} ${a}`,p.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${d} ${o}ms linear ${s}ms 1 both`,E+=1,d}function N(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-o.length;s&&(t.style.animation=o.join(", "),E-=s,E||l(()=>{E||(k.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),k.clear())}))}function T(t){C=t}function F(t){(function(){if(!C)throw new Error("Function called outside component initialization");return C})().$$.on_mount.push(t)}const O=[],q=[],M=[],P=[],A=Promise.resolve();let J=!1;function j(t){M.push(t)}let L=!1;const z=new Set;function R(){if(!L){L=!0;do{for(let t=0;t<O.length;t+=1){const e=O[t];T(e),W(e.$$)}for(O.length=0;q.length;)q.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];z.has(e)||(z.add(e),e())}M.length=0}while(O.length);for(;P.length;)P.pop()();J=!1,L=!1,z.clear()}}function W(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}let D;function H(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const B=new Set;let I;function Y(){I={r:0,c:[],p:I}}function G(){I.r||s(I.c),I=I.p}function K(t,e){t&&t.i&&(B.delete(t),t.i(e))}function Q(t,e,n,o){if(t&&t.o){if(B.has(t))return;B.add(t),I.c.push(()=>{B.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const U={duration:0};function V(n,o,i,c){let f=o(n,i),p=c?0:1,m=null,h=null,y=null;function g(){y&&N(n,y)}function v(t,e){const n=t.b-p;return e*=Math.abs(n),{a:p,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function w(o){const{delay:r=0,duration:i=300,easing:c=e,tick:w=t,css:$}=f||U,b={start:u()+r,b:o};o||(b.group=I,I.r+=1),m?h=b:($&&(g(),y=S(n,p,o,i,r,c,$)),o&&w(0,1),m=v(b,i),j(()=>H(n,o,"start")),function(t){let e;0===a.size&&l(d),new Promise(n=>{a.add(e={c:t,f:n})})}(t=>{if(h&&t>h.start&&(m=v(h,i),h=null,H(n,m.b,"start"),$&&(g(),y=S(n,p,m.b,m.duration,0,c,f.css))),m)if(t>=m.end)w(p=m.b,1-p),H(n,m.b,"end"),h||(m.b?g():--m.group.r||s(m.group.c)),m=null;else if(t>=m.start){const e=t-m.start;p=m.a+m.d*c(e/m.duration),w(p,1-p)}return!(!m&&!h)}))}return{run(t){r(f)?(D||(D=Promise.resolve(),D.then(()=>{D=null})),D).then(()=>{f=f(),w(t)}):w(t)},end(){g(),m=h=null}}}const X="undefined"!=typeof window?window:global;function Z(t){t&&t.c()}function tt(t,e,o){const{fragment:i,on_mount:c,on_destroy:u,after_update:l}=t.$$;i&&i.m(e,o),j(()=>{const e=c.map(n).filter(r);u?u.push(...e):s(e),t.$$.on_mount=[]}),l.forEach(j)}function et(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nt(t,e){-1===t.$$.dirty[0]&&(O.push(t),J||(J=!0,A.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ot(e,n,r,i,c,u,l=[-1]){const a=C;T(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:o(),dirty:l};let p=!1;if(f.ctx=r?r(e,d,(t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&c(f.ctx[t],f.ctx[t]=s)&&(f.bound[t]&&f.bound[t](s),p&&nt(e,t)),n}):[],f.update(),p=!0,s(f.before_update),f.fragment=!!i&&i(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&K(e.$$.fragment),tt(e,n.target,n.anchor),R()}T(a)}class st{$destroy(){et(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function rt(t,{delay:n=0,duration:o=400,easing:s=e}){const r=+getComputedStyle(t).opacity;return{delay:n,duration:o,easing:s,css:t=>`opacity: ${t*r}`}}let it,ct;function ut(t){for(var e=0,n=0;e<t.length;e++)n=Math.imul(31,n)+t.charCodeAt(e)|0;return n}const lt=new WebSocket("wss://hkyr582gyb.execute-api.us-east-1.amazonaws.com/dev");let at=2,dt=[];lt.onopen=function(t){at--,0==at&&dt.forEach(mt)},lt.onerror=function(t){console.error("WebSocket error:",t)};let ft={};function pt(t,e){ft[t]=e}function mt(t,e){(e=e||{}).type=t,at>0?dt.push(e):(e=JSON.stringify(e),e=JSON.stringify({target:it,content:e,signature:ut(it+":"+ct+":"+e)}),lt.send(JSON.stringify({action:"fanout",message:btoa(e)})))}lt.onmessage=function(t){const e=JSON.parse(atob(t.data)),n=ut(it+":"+ct+":"+e.content);if(e.target==it&&e.signature==n){const t=JSON.parse(e.content);t.type in ft&&ft[t.type](t)}};const{isNaN:ht}=X;function yt(t){let e,n,o,r,i,c,u,l,a,d,v,k,C,E,S,N,T,F,O,q,M,P,A,J,j,L,z,R,W,D,H=t[4]?"play_arrow":"pause",B=$t(t[1])+"",I=$t(t[2])+"",U=t[7]?"fullscreen_exit":"fullscreen",V=t[8]&&gt(t),X=t[0]<1&&vt(t);return{c(){e=h("div"),n=h("div"),n.textContent="paused",o=g(),r=h("div"),i=h("div"),c=g(),V&&V.c(),u=g(),l=h("div"),a=h("button"),d=h("i"),v=y(H),C=g(),E=h("button"),E.innerHTML='<i class="material-icons">replay_10</i>',S=g(),N=h("button"),N.innerHTML='<i class="material-icons">sync</i>',T=g(),F=h("div"),O=y(B),q=y("/"),M=y(I),P=g(),X&&X.c(),A=g(),J=h("div"),j=g(),L=h("button"),z=h("i"),R=y(U),$(n,"class","pause svelte-w11gym"),_(i,"width",t[1]/t[2]*100+"%"),$(i,"class","svelte-w11gym"),$(r,"class","progress svelte-w11gym"),$(e,"class","overlay svelte-w11gym"),$(d,"class","material-icons"),$(a,"title",k=t[4]?"Play":"Pause"),$(a,"class","main svelte-w11gym"),$(E,"title","Jump back 10 seconds"),$(E,"class","svelte-w11gym"),$(N,"title","Force sync"),$(N,"class","svelte-w11gym"),$(F,"class","duration svelte-w11gym"),$(J,"class","spacer svelte-w11gym"),$(z,"class","material-icons"),$(L,"title","Fullscreen"),$(L,"class","svelte-w11gym"),$(l,"class","controls svelte-w11gym"),x(l,"visible",t[9])},m(m,h,y){p(m,e,h),f(e,n),f(e,o),f(e,r),f(r,i),p(m,c,h),V&&V.m(m,h),p(m,u,h),p(m,l,h),f(l,a),f(a,d),f(d,v),f(l,C),f(l,E),f(l,S),f(l,N),f(l,T),f(l,F),f(F,O),f(F,q),f(F,M),f(l,P),X&&X.m(l,null),f(l,A),f(l,J),f(l,j),f(l,L),f(L,z),f(z,R),W=!0,y&&s(D),D=[w(e,"click",t[11]),w(a,"click",t[11]),w(E,"click",t[12]),w(N,"click",t[10]),w(L,"click",t[13])]},p(t,e){(!W||6&e)&&_(i,"width",t[1]/t[2]*100+"%"),t[8]?V?V.p(t,e):(V=gt(t),V.c(),V.m(u.parentNode,u)):V&&(V.d(1),V=null),(!W||16&e)&&H!==(H=t[4]?"play_arrow":"pause")&&b(v,H),(!W||16&e&&k!==(k=t[4]?"Play":"Pause"))&&$(a,"title",k),(!W||2&e)&&B!==(B=$t(t[1])+"")&&b(O,B),(!W||4&e)&&I!==(I=$t(t[2])+"")&&b(M,I),t[0]<1?X?(X.p(t,e),K(X,1)):(X=vt(t),X.c(),K(X,1),X.m(l,A)):X&&(Y(),Q(X,1,1,()=>{X=null}),G()),(!W||128&e)&&U!==(U=t[7]?"fullscreen_exit":"fullscreen")&&b(R,U),512&e&&x(l,"visible",t[9])},i(t){W||(K(X),W=!0)},o(t){Q(X),W=!1},d(t){t&&m(e),t&&m(c),V&&V.d(t),t&&m(u),t&&m(l),X&&X.d(),s(D)}}}function gt(e){let n,o;return{c(){n=h("div"),n.textContent="Your browser seems to be having issues. Switch to Chrome or Firefox for a better experience.",$(n,"class","syncwarning svelte-w11gym")},m(t,s,r){p(t,n,s),r&&o(),o=w(n,"click",e[27])},p:t,d(t){t&&m(n),o()}}}function vt(t){let e,n,o,s,r,i=(100*t[0]).toFixed(2)+"";return{c(){e=h("div"),n=y(i),o=y("%"),$(e,"class","downloaded svelte-w11gym"),$(e,"title","Download progress")},m(t,s){p(t,e,s),f(e,n),f(e,o),r=!0},p(t,e){(!r||1&e)&&i!==(i=(100*t[0]).toFixed(2)+"")&&b(n,i)},i(t){r||(j(()=>{s||(s=V(e,rt,{},!0)),s.run(1)}),r=!0)},o(t){s||(s=V(e,rt,{},!1)),s.run(0),r=!1},d(t){t&&m(e),t&&s&&s.end()}}}function wt(t){let e,n,o,r,i,c,u,a,d=!1,y=!0;function v(){cancelAnimationFrame(o),n.paused||(o=l(v),d=!0),t[22].call(n)}let b=t[3]&&yt(t);return{c(){e=h("div"),n=h("video"),r=g(),i=h("button"),c=g(),b&&b.c(),n.autoplay="true",$(n,"class","svelte-w11gym"),void 0===t[2]&&j(()=>t[23].call(n)),$(i,"class","dummy svelte-w11gym"),$(e,"class","wrapper svelte-w11gym"),x(e,"paused",t[4]),x(e,"hidecursor",!t[9])},m(o,l,d){p(o,e,l),f(e,n),t[25](n),f(e,r),f(e,i),t[26](i),f(e,c),b&&b.m(e,null),t[28](e),u=!0,d&&s(a),a=[w(window,"keydown",t[15]),w(n,"timeupdate",v),w(n,"durationchange",t[23]),w(n,"play",t[24]),w(n,"pause",t[24]),w(e,"mousemove",t[14])]},p(t,[o]){!d&&2&o&&!ht(t[1])&&(n.currentTime=t[1]),d=!1,16&o&&y!==(y=t[4])&&n[y?"pause":"play"](),t[3]?b?(b.p(t,o),K(b,1)):(b=yt(t),b.c(),K(b,1),b.m(e,null)):b&&(Y(),Q(b,1,1,()=>{b=null}),G()),16&o&&x(e,"paused",t[4]),512&o&&x(e,"hidecursor",!t[9])},i(t){u||(K(b),u=!0)},o(t){Q(b),u=!1},d(n){n&&m(e),t[25](null),t[26](null),b&&b.d(),t[28](null),s(a)}}}function $t(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function bt(t,e,n){let o,s,r,i,c,u,{file:l}=e,{progress:a=0}=e,d=!1,f=!1,p=0,m=0,h=!1;function y(){u.focus()}function g(){mt("sync request"),y()}function v(){mt("set paused",{paused:!r.paused}),y()}function w(){n(7,d=document.fullscreenElement),d?document.exitFullscreen():c.requestFullscreen(),y()}F(()=>{l.renderTo(r,(t,e)=>{e.controls=!1,y(),setInterval(()=>{h||(o<=p?(m++,m>=2&&n(8,h=!0),mt("sync request")):m=0),p=o},1e3),mt("sync request"),setTimeout(g,5e3)}),r.play(),n(3,r.controls=!1,r)}),pt("sync request",()=>{mt("sync",{paused:r.paused,currentTime:o})}),pt("sync",t=>{r.paused!=t.paused&&(t.paused?r.pause():r.play());const e=t.currentTime;e-o<-2?mt("sync request"):Math.abs(o-e)>.2&&n(1,o=e),p=e-1,f=!0}),pt("set paused",t=>{t.paused?r.pause():r.play()}),pt("jump back",t=>{p=t.destTime-1,n(1,o=t.destTime)});let $,b=!0;return t.$set=t=>{"file"in t&&n(16,l=t.file),"progress"in t&&n(0,a=t.progress)},[a,o,s,r,i,c,u,d,h,b,g,v,function(){f&&(mt("jump back",{destTime:Math.max(0,o-10)}),y())},w,function(t){clearTimeout($),$=setTimeout(()=>n(9,b=!1),2500),n(9,b=!0)},function(t){70==t.keyCode?w():32==t.keyCode&&v()},l,f,p,m,$,y,function(){o=this.currentTime,n(1,o)},function(){s=this.duration,n(2,s)},function(){i=this.paused,n(4,i)},function(t){q[t?"unshift":"push"](()=>{n(3,r=t)})},function(t){q[t?"unshift":"push"](()=>{n(6,u=t)})},()=>{n(8,h=!1)},function(t){q[t?"unshift":"push"](()=>{n(5,c=t)})}]}class _t extends st{constructor(t){super(),ot(this,t,bt,wt,i,{file:16,progress:0})}}function xt(e){let n;return{c(){n=h("div"),$(n,"class","spinner svelte-5hc1l6")},m(t,e){p(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function kt(t){let e;const n=new _t({props:{file:t[0],progress:t[1]}});return{c(){Z(n.$$.fragment)},m(t,o){tt(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.file=t[0]),2&e&&(o.progress=t[1]),n.$set(o)},i(t){e||(K(n.$$.fragment,t),e=!0)},o(t){Q(n.$$.fragment,t),e=!1},d(t){et(n,t)}}}function Ct(t){let e,n,o,s;const r=[kt,xt],i=[];function c(t,e){return t[0]?0:1}return e=c(t),n=i[e]=r[e](t),{c(){n.c(),o=v()},m(t,n){i[e].m(t,n),p(t,o,n),s=!0},p(t,[s]){let u=e;e=c(t),e===u?i[e].p(t,s):(Y(),Q(i[u],1,1,()=>{i[u]=null}),G(),n=i[e],n||(n=i[e]=r[e](t),n.c()),K(n,1),n.m(o.parentNode,o))},i(t){s||(K(n),s=!0)},o(t){Q(n),s=!1},d(t){i[e].d(t),t&&m(o)}}}function Et(t,e,n){const o=new WebTorrent;let s,r=0,i=0,c=0;return o.add(ct,(function(t){function e(){r=t.uploadSpeed,i=t.downloadSpeed,n(1,c=t.progress)}n(0,s=t.files[0]),t.on("download",e),t.on("upload",e)})),[s,c]}class St extends st{constructor(t){super(),ot(this,t,Et,Ct,i,{})}}function Nt(t){let e,n,o,s,r,i,c,u,l,a,d,b,_,x=t[3]&&function(t){let e;return{c(){e=h("p"),e.textContent="Sadly the website does not support well in Safari. While playback works, syncing does not. Please use Chrome\n\t\t\tor Firefox for a better experience."},m(t,n){p(t,e,n)},d(t){t&&m(e)}}}(),k=t[0]&&Tt();return{c(){e=h("h2"),e.textContent="Join Existing",n=g(),o=h("p"),o.textContent="The video is not hosted by us and is shared directly by the participants. Make sure you trust this group.",s=g(),x&&x.c(),r=g(),i=h("button"),c=y("Play video"),u=g(),l=h("video"),a=g(),k&&k.c(),d=v(),$(i,"class","primary"),i.disabled=t[0],$(l,"width","0"),$(l,"height","0")},m(m,h,y){p(m,e,h),p(m,n,h),p(m,o,h),p(m,s,h),x&&x.m(m,h),p(m,r,h),p(m,i,h),f(i,c),p(m,u,h),p(m,l,h),t[7](l),p(m,a,h),k&&k.m(m,h),p(m,d,h),b=!0,y&&_(),_=w(i,"click",t[4])},p(t,e){(!b||1&e)&&(i.disabled=t[0]),t[0]?k?K(k,1):(k=Tt(),k.c(),K(k,1),k.m(d.parentNode,d)):k&&(Y(),Q(k,1,1,()=>{k=null}),G())},i(t){b||(K(k),b=!0)},o(t){Q(k),b=!1},d(c){c&&m(e),c&&m(n),c&&m(o),c&&m(s),x&&x.d(c),c&&m(r),c&&m(i),c&&m(u),c&&m(l),t[7](null),c&&m(a),k&&k.d(c),c&&m(d),_()}}}function Tt(t){let e,n,o;const s=new St({});return{c(){e=h("div"),Z(s.$$.fragment),$(e,"class","cover svelte-1mqhnzt")},m(t,n){p(t,e,n),tt(s,e,null),o=!0},i(t){o||(K(s.$$.fragment,t),j(()=>{n||(n=V(e,rt,{},!0)),n.run(1)}),o=!0)},o(t){Q(s.$$.fragment,t),n||(n=V(e,rt,{},!1)),n.run(0),o=!1},d(t){t&&m(e),et(s),t&&n&&n.end()}}}function Ft(t){let e,n,o=t[1]&&Nt(t);return{c(){o&&o.c(),e=v()},m(t,s){o&&o.m(t,s),p(t,e,s),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),K(o,1)):(o=Nt(t),o.c(),K(o,1),o.m(e.parentNode,e)):o&&(Y(),Q(o,1,1,()=>{o=null}),G())},i(t){n||(K(o),n=!0)},o(t){Q(o),n=!1},d(t){o&&o.d(t),t&&m(e)}}}function Ot(t,e,n){let o,s,r=!1;const i=window.location.hash,c=navigator.userAgent.toLowerCase(),u=-1!=c.indexOf("safari")&&-1==c.indexOf("chrome");return i&&(o=i.substr(1)),[r,o,s,u,function(){var t;t=o,[it,ct]=t.split("+"),ct="magnet:?"+atob(ct),at--,0==at&&dt.forEach(mt),n(0,r=!0),s.play()},i,c,function(t){q[t?"unshift":"push"](()=>{n(2,s=t)})}]}return new class extends st{constructor(t){super(),ot(this,t,Ot,Ft,i,{})}}({target:document.querySelector("#join .app")})}();
//# sourceMappingURL=bundle.js.map
