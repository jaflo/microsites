{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../App.svelte",
    "../../TogetherPlayer.svelte",
    "../../Video.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport { fade } from \"svelte/transition\";\n\timport { setupRoom, sendMessage, subscribe } from \"./connectivity.js\";\n\n\timport TogetherPlayer from \"./TogetherPlayer.svelte\";\n\n\tlet active = false,\n\t\tinitPayload,\n\t\tallowPlaybackControl;\n\n\tconst hashValue = window.location.hash;\n\tconst ua = navigator.userAgent.toLowerCase();\n\tconst isSafari = ua.indexOf(\"safari\") != -1 && ua.indexOf(\"chrome\") == -1;\n\n\tif (hashValue) {\n\t\tinitPayload = hashValue.substr(1);\n\t}\n\n\tfunction start() {\n\t\tsetupRoom(initPayload);\n\t\tactive = true;\n\t\tallowPlaybackControl.play();\n\t}\n</script>\n\n<style>\n\t.cover {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: black;\n\t\tz-index: 10;\n\t}\n</style>\n\n{#if initPayload}\n\t<h2>Join Existing</h2>\n\t<p>The video is not hosted by us and is shared directly by the participants. Make sure you trust this group.</p>\n\t{#if isSafari}\n\t\t<p>\n\t\t\tSadly the website does not support well in Safari. While playback works, syncing does not. Please use Chrome\n\t\t\tor Firefox for a better experience.\n\t\t</p>\n\t{/if}\n\t<button on:click={start} class=\"primary\" disabled={active}>Play video</button>\n\t<video bind:this={allowPlaybackControl} width=\"0\" height=\"0\" />\n\n\t{#if active}\n\t\t<div class=\"cover\" transition:fade>\n\t\t\t<TogetherPlayer />\n\t\t</div>\n\t{/if}\n{/if}\n",
    "<script>\n\timport { magnetLink } from \"./connectivity.js\";\n\n\timport Video from \"./Video.svelte\";\n\n\tconst client = new WebTorrent();\n\tlet file,\n\t\tupSpeed = 0,\n\t\tdownSpeed = 0,\n\t\tprogress = 0;\n\n\tclient.add(magnetLink, function(torrent) {\n\t\tfile = torrent.files[0];\n\n\t\tfunction update() {\n\t\t\tupSpeed = torrent.uploadSpeed;\n\t\t\tdownSpeed = torrent.downloadSpeed;\n\t\t\tprogress = torrent.progress;\n\t\t}\n\t\ttorrent.on(\"download\", update);\n\t\ttorrent.on(\"upload\", update);\n\t});\n</script>\n\n<style>\n\t.spinner {\n\t\tanimation: spin 0.5s infinite linear;\n\t\tborder: 3px solid #faf0ca;\n\t\tborder-top-color: transparent;\n\t\twidth: 2em;\n\t\theight: 2em;\n\t\tposition: absolute;\n\t\ttop: 50%;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -50%);\n\t\tborder-radius: 9em;\n\t}\n\n\t@keyframes spin {\n\t\tfrom {\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\tto {\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n</style>\n\n{#if file}\n\t<Video {file} {progress} />\n{:else}\n\t<div class=\"spinner\" />\n{/if}\n",
    "<script>\n\timport { onMount, createEventDispatcher } from \"svelte\";\n\timport { fade } from \"svelte/transition\";\n\timport { sendMessage, subscribe } from \"./connectivity.js\";\n\n\texport let file;\n\texport let progress = 0;\n\n\tlet currentTime, duration, video, paused, wrapper, dummy;\n\tlet isFullscreen = false,\n\t\tinitSyncHappened = false,\n\t\tlastTime = 0,\n\t\tlagCount = 0,\n\t\thasSyncIssues = false;\n\n\tfunction unfocus() {\n\t\tdummy.focus();\n\t}\n\n\tonMount(() => {\n\t\tfile.renderTo(video, (err, el) => {\n\t\t\tel.controls = false;\n\t\t\tunfocus();\n\t\t\tsetInterval(() => {\n\t\t\t\tif (!hasSyncIssues) {\n\t\t\t\t\tif (currentTime <= lastTime) {\n\t\t\t\t\t\tlagCount++;\n\t\t\t\t\t\tif (lagCount >= 2) {\n\t\t\t\t\t\t\thasSyncIssues = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsendMessage(\"sync request\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlagCount = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlastTime = currentTime;\n\t\t\t}, 1000);\n\t\t\tsendMessage(\"sync request\");\n\t\t\tsetTimeout(forceSync, 5000);\n\t\t});\n\t\tvideo.play();\n\t\tvideo.controls = false;\n\t});\n\tsubscribe(\"sync request\", () => {\n\t\tsendMessage(\"sync\", {\n\t\t\tpaused: video.paused,\n\t\t\tcurrentTime: currentTime\n\t\t});\n\t});\n\tsubscribe(\"sync\", message => {\n\t\tif (video.paused != message.paused) {\n\t\t\tmessage.paused ? video.pause() : video.play();\n\t\t}\n\t\tconst expectedTime = message.currentTime;\n\t\tif (expectedTime - currentTime < -2) {\n\t\t\t// someone else is way behind, resync them and ignore\n\t\t\tsendMessage(\"sync request\");\n\t\t} else if (Math.abs(currentTime - expectedTime) > 0.2) {\n\t\t\tcurrentTime = expectedTime;\n\t\t}\n\t\tlastTime = expectedTime - 1;\n\t\tinitSyncHappened = true;\n\t});\n\tfunction forceSync() {\n\t\tsendMessage(\"sync request\");\n\t\tunfocus();\n\t}\n\n\tfunction togglePlayback() {\n\t\tsendMessage(\"set paused\", { paused: !video.paused });\n\t\tunfocus();\n\t}\n\tsubscribe(\"set paused\", message => {\n\t\tmessage.paused ? video.pause() : video.play();\n\t});\n\n\tfunction jumpBack() {\n\t\tif (!initSyncHappened) return;\n\t\tsendMessage(\"jump back\", { destTime: Math.max(0, currentTime - 10) });\n\t\tunfocus();\n\t}\n\tsubscribe(\"jump back\", message => {\n\t\tlastTime = message.destTime - 1;\n\t\tcurrentTime = message.destTime;\n\t});\n\n\tfunction format(seconds) {\n\t\tif (isNaN(seconds)) return \"...\";\n\n\t\tconst minutes = Math.floor(seconds / 60);\n\t\tseconds = Math.floor(seconds % 60);\n\t\tif (seconds < 10) seconds = \"0\" + seconds;\n\n\t\treturn `${minutes}:${seconds}`;\n\t}\n\n\tfunction toggleFullscreen() {\n\t\tisFullscreen = document.fullscreenElement;\n\t\tif (!isFullscreen) {\n\t\t\twrapper.requestFullscreen();\n\t\t} else {\n\t\t\tdocument.exitFullscreen();\n\t\t}\n\t\tunfocus();\n\t}\n\n\tlet showControlsTimeout,\n\t\tshowControls = true;\n\tfunction handleMousemove(e) {\n\t\tclearTimeout(showControlsTimeout);\n\t\tshowControlsTimeout = setTimeout(() => (showControls = false), 2500);\n\t\tshowControls = true;\n\t}\n\n\tfunction handleKeydown(e) {\n\t\tif (e.keyCode == 70) {\n\t\t\t// F\n\t\t\ttoggleFullscreen();\n\t\t} else if (e.keyCode == 32) {\n\t\t\t// space\n\t\t\ttogglePlayback();\n\t\t}\n\t}\n</script>\n\n<style>\n\t.wrapper {\n\t\tcolor: #faf0ca;\n\t}\n\n\t.hidecursor {\n\t\tcursor: none;\n\t}\n\n\t.dummy {\n\t\topacity: 0;\n\t}\n\n\tvideo {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tpointer-events: none;\n\t}\n\n\t.controls,\n\t.overlay,\n\t.overlay .progress {\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t}\n\n\t.controls {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-bottom: 4px;\n\t\topacity: 0;\n\t\ttransition: opacity 0.3s ease-in-out;\n\t}\n\n\t.controls:before {\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: -10px;\n\t\theight: 100px;\n\t\tbackground: linear-gradient(0deg, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0) 100%);\n\t\tcontent: \"\";\n\t\tdisplay: block;\n\t}\n\n\t.controls.visible {\n\t\topacity: 1;\n\t}\n\n\tbutton {\n\t\tbackground: none;\n\t\tborder: 0;\n\t\tmargin: 0;\n\t\tpadding: 0.5em;\n\t\tline-height: 1;\n\t\tz-index: 2;\n\t}\n\n\tbutton.main {\n\t\tpadding: 0.5em 2em;\n\t}\n\n\t.controls div {\n\t\tmargin-left: 1em;\n\t\tfont-variant-numeric: tabular-nums lining-nums;\n\t\tcursor: default;\n\t\tz-index: 2;\n\t}\n\n\t.spacer {\n\t\tflex: 1;\n\t}\n\n\t.overlay {\n\t\ttop: 0;\n\t\topacity: 0;\n\t\tbackground: black;\n\t}\n\n\t.overlay .progress div {\n\t\tborder-bottom: 4px solid;\n\t}\n\n\t.overlay .pause {\n\t\tposition: absolute;\n\t\ttop: 50%;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -50%);\n\t\tfont-size: 2em;\n\t\tcursor: default;\n\t}\n\n\t.paused .overlay {\n\t\topacity: 0.6;\n\t}\n\n\t.syncwarning {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tpadding: 1em;\n\t\tbackground: #faf0ca;\n\t\tcolor: #0d3b66;\n\t\tbox-shadow: 0 0 10em black, 0 0 3em black;\n\t}\n</style>\n\n<svelte:window on:keydown={handleKeydown} />\n<div bind:this={wrapper} class=\"wrapper\" class:paused on:mousemove={handleMousemove} class:hidecursor={!showControls}>\n\t<video autoplay=\"true\" bind:currentTime bind:duration bind:paused bind:this={video} />\n\t<button class=\"dummy\" bind:this={dummy} />\n\n\t{#if video}\n\t\t<div class=\"overlay\" on:click={togglePlayback}>\n\t\t\t<div class=\"pause\">paused</div>\n\t\t\t<div class=\"progress\">\n\t\t\t\t<div style=\"width:{(currentTime / duration) * 100}%\" />\n\t\t\t</div>\n\t\t</div>\n\t\t{#if hasSyncIssues}\n\t\t\t<div\n\t\t\t\tclass=\"syncwarning\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\thasSyncIssues = false;\n\t\t\t\t}}>\n\t\t\t\tYour browser seems to be having issues. Switch to Chrome or Firefox for a better experience.\n\t\t\t</div>\n\t\t{/if}\n\t\t<div class=\"controls\" class:visible={showControls}>\n\t\t\t<button on:click={togglePlayback} title={paused ? 'Play' : 'Pause'} class=\"main\">\n\t\t\t\t<i class=\"material-icons\">{paused ? 'play_arrow' : 'pause'}</i>\n\t\t\t</button>\n\t\t\t<button on:click={jumpBack} title=\"Jump back 10 seconds\">\n\t\t\t\t<i class=\"material-icons\">replay_10</i>\n\t\t\t</button>\n\t\t\t<button on:click={forceSync} title=\"Force sync\">\n\t\t\t\t<i class=\"material-icons\">sync</i>\n\t\t\t</button>\n\n\t\t\t<div class=\"duration\">{format(currentTime)}/{format(duration)}</div>\n\t\t\t{#if progress < 1}\n\t\t\t\t<div class=\"downloaded\" title=\"Download progress\" transition:fade>{(progress * 100).toFixed(2)}%</div>\n\t\t\t{/if}\n\n\t\t\t<div class=\"spacer\" />\n\n\t\t\t<button on:click={toggleFullscreen} title=\"Fullscreen\">\n\t\t\t\t<i class=\"material-icons\">{isFullscreen ? 'fullscreen_exit' : 'fullscreen'}</i>\n\t\t\t</button>\n\t\t</div>\n\t{/if}\n</div>\n"
  ],
  "names": [],
  "mappings": "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"
}